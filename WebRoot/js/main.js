(function(){var prong_pos={t:'b',b:'t',l:'r',r:'l'};Fn.fW('Dialog',{Const:function(a,b){if(a.cache&&a.n&&Fn.Dialog._n[a.n]){var n=Fn.Dialog._n[a.n];if(a.magnet)n.snap(a.magnet,a.prong,a.magtype);n.show();return n}this.x=a;this.xml=b;this.id=Fn.Dialog.g_id();this.zIndex=$.g_z(a.z);this.bM={};if(!('moveable' in a))a.moveable=true;if(!('mul' in a))a.mul=false;if(!('collapse' in a))a.collapse=false;var r=$.canrec();a.wd=js.m(a.w)||b.wd;a.ht=js.m(a.h)||b.ht;if(typeof a.w==='string'&&a.w.charAt(a.w.length-1)==='%')a.wd=Math.ceil(r.width*a.wd/100);if(typeof a.h==='string'&&a.h.charAt(a.h.length-1)==='%')a.ht=Math.ceil(r.height*a.ht/100);else a.ht=a.h==null?'*':a.h;if(a.wd==-1)a.wd=null;if(a.ht==-1)a.ht=null;var iP=a.wd==null,iO=a.ht==null;if(iP||iO){this.iP=iP;this.iO=iO;}if(iO||a.wd>r.width)a.wd=r.width;if(iO||a.ht>r.height)a.ht=r.height;if(a.fromView){this.fromView=typeof a.fromView=='string'?VM(a.fromView):a.fromView;}if(!a.n)a.n=this.id;var c,d,e;if(b&&js.type(b)==='xml'){c=$.x(b,'descendant-or-self::fr[@id="dlg-src"]'),d=js.type(a.src);if(a.src){if(d==='string'){c.setAttribute('src',a.src);c.setAttribute('onload','DFish.g_dialog(this).onContentLoad()');}else{$.attr(c,'type','set','rows','*');e=c.getAttribute('id');if(!e){c.setAttribute('id',this.id);e=this.id;}}}else{c.setAttribute('type','html');c.text=a.cn;}if(a.independent)c.setAttribute('independent',1);c=$.x(b,'.//fr[@id="dlg-max"]');if(c)c.text='<div class=i-c onclick=DFish.g_dialog(this).max(this)><i class=va-i></i>'+$.htm.icg('.i-dlg-max')+'</div>';c=$.x(b,'.//fr[@id="dlg-x"]');if(c)c.text='<div class=i-c onclick=DFish.close(this)><i class=va-i></i>'+$.htm.icg('.i-dlg-x')+'</div>';c=$.x(b,'.//fr[@id="dlg-tt"]');if(c)c.text='<div id='+this.id+'-title class=dlg-t>'+a.t+'</div>';this.tmpl_clz=b.getAttribute('face')||'';if(Br.css3&&!a.hideshadow){this.tmpl_clz+=' shadow';}this.div=new Fn.DivSet('rows=*',a.wd,a.ht);this.div.dialogId=this.id;VM.prototype.frame2div.call(this,this.div,$.x(b,'fr'));if(d==='xml'){VM.xgo(this.bM[e].addfilm(),a.src,a.n&&VM(),a.n);}else if(d==='function')a.src.call(this,this.bM[e]);if(c&&(c=c.getAttribute('id')))this.bM[c].attr+=' onmousedown=Fn.Dialog.move(this,"'+this.id+'");return(!1)';}else if(typeof b==='object'){this.div=b;}else this.div=new Fn.Div(a.wd,a.ht).data(a.cn);a.top='top' in a?js.m(a.top):a.ht==='*'?r.height:Math.floor((r.height-a.ht)/2);a.left='left' in a?js.m(a.left):Math.floor((r.width-a.wd)/2);if(a.top<0)a.top=0;if(a.n){for(var k in Fn.Dialog._n){var c=Fn.Dialog._n[k];if(a.n==c.x.n)c.close(true);}Fn.Dialog._n[a.n]=this;}if(a.src){for(var k in Fn.Dialog._a){var c=Fn.Dialog._a[k];if(!c.x.mul&&a.src===c.x.src){c.close(true);}}}e=event&&event.type;if(Br.chm&&event&&(event.srcElement instanceof XMLHttpRequest))e=null;var poper=a.poper;if(!poper){if(e){poper=event.srcElement;if(Fn.Menu.cur&&Fn.Menu.cur.contains(poper)){poper=Fn.Menu.cur.owner||poper;if(poper.$)poper=poper.$();}}}this.poper=poper;var f=Fn.Dialog.get(this.poper||(this.fromView&&this.fromView.$()));if(f&&f.x.transit){if(f.fromView)this.fromView=f.fromView;this.poper=f.poper;f=f.parentNode;}if(f){if(f.x.relay){this.poper=f.poper;this.e_x=f.e_x;this.e_y=f.e_y;}if(!this.x.independent&&!f.x.independentChild){f.addNode(this);f.modal=true;}}if(e){this.e_x=event.clientX;this.e_y=event.clientY;}else{var f=Fn.Event.win(window);if(f){var g=$.bcr(f.frameElement);this.e_x=g.left+f.event.clientX;this.e_y=g.top+f.event.clientY;}else{d=Fn.Event.getev();this.e_x=d?d.x:($.canrec().width/2);this.e_y=d?d.y:($.canrec().height/2);}}if(a.magnet){if(a.ht==='*'){this.addEventOnce('render',f=function(){this.snap(a.magnet,a.prong,a.magtype)});if(d==='string')this.addEventOnce('contentload',f);}else{this.snap(a.magnet,a.prong,a.magtype);}}if((iP||iO)||(a.magnet&&a.magnet.nodeType)){VM().div.addEvent('resize',this.U=js.bind(this.on_window_resize,this));}if(a.onclose||a.on_close)this.addEvent('close',a.onclose||a.on_close,this);if(a.onrender||a.on_render)this.addEventOnce('render',a.onrender||a.on_render,this);Fn.Dialog._a[this.id]=this;},Helper:{_a:{},_n:{},idc:0,g_id:function(){return 'fndg-'+(this.idc++)},get:function(a){if(!a)return;if(typeof a==='string')return this._a[a]||this._n[a];if(a.id){var b=a.id.match(/^fndg-\w+/);if(b)return Fn.Dialog._a[b];else if(!a.nodeType&&$(a.id))a=$(a.id);}var b=a,c;while(!c&&b&&b.nodeType==1){c=b.getAttribute('fndgid');b=b.parentNode;}return c?this._a[c]:null;},drag:function(o){this.down(o,Fn.Dialog.get(o).id);},move:function(a,b){var c=Fn.Dialog.get(b||a);c.maxz();if(!c.x.moveable)return;c.moving=true;var d=c.$(),dnX=event.clientX,dnY=event.clientY,dnLeft=d.style.posLeft,dnTop=d.style.posTop,o;if(!Br.css3){document.onselectstart=function(){return false}}$.e_moveup(a,function(){var x=event.clientX,y=event.clientY,t=Math.max(dnTop+y-dnY,0),l=dnLeft+x-dnX;if(o){o.style.posTop=t;o.style.posLeft=l;}else if(dnX!=x||dnY!=y){o=$.db('<div style="position:absolute;width:'+(d.offsetWidth-4)+'px;height:'+(d.offsetHeight-4)+'px;z-index:'+(c.zIndex+1)+';top:'+t+'px;left:'+l+'px;border:2px solid #ccc"></div>');}},function(){if(o){if(o.style.left&&o.style.top)c.moveTo(o.style.posLeft,o.style.posTop);$.rm(o);}c.fireEvent('dragend');c.moving=false;if(!Br.css3){document.onselectstart=null;}});},dbl:function(a,b){if(Fn.Dialog._a[b])Fn.Dialog._a[b].dblclick();},cover:function(a){if(!$('fndg-cont')){$.db('<div id=fndg-cont></div>');}var b=$.append($('fndg-cont'),'<div style="position:absolute;width:'+screen.availWidth+'px;height:'+screen.availHeight+'px;left:0;top:0;display:none;z-index:'+a.zIndex+';'+(a.x.cvr_style||'')+'"></div>');b.className='bg-lowest alpha';b.style.display='';return b;},addclosex:function(a,fFloat,bMouseStop){var bNoBorder=a.border=='none';var o=a.$();if(bNoBorder)$.append(o,'<div id='+a.id+'-closex style="display:none;position:absolute;top:3px;left:'+(a.i_wd-16)+'px;" align=right><img src=/img/p/close.gif class=hand onclick=Fn.Dialog._a["'+a.id+'"].close()></div>');if(bMouseStop){var dv=a.div.$();dv.onmouseover=function(){if(fFloat){clearTimeout(fFloat.timer);fFloat.timer=null;}if(bNoBorder){a.$('closex').style.display='';}};o.onmouseout=function(){if(!this.contains(event.toElement)){if(fFloat&&!fFloat.timer)fFloat();if(bNoBorder)a.$('closex').style.display='none';}}}},s_rec:function(s,z){var a=210,b=160,c=0,d=(s||'').split('\n');for(var i=0,e;i<d.length;i++){e=js.s_wd(d[i],1);c=Math.max(c,e);b+=Math.floor(e/90)*24;}return[js.m_rng(a+c*6,a,660),Math.min(b+(i*24),490)];}},Extend:[Fn.EventNode],Prototype:{vis:false,eD:false,fe:false,C:true,maxz:function(){this.css('zIndex',this.zIndex=$.g_z());js.each(this,'v.maxz()');},snap:function(a,b,c){if(!a)a=this.x.magnet;if(!b)b=this.x.prong;if(!c){c=this.x.magtype;}var o=a;a=typeof a==='string'?$(a):('$' in a?a.$():a);if(a.nodeType)a=$.bcr(a);else if('clientX' in a)a={top:a.clientY,bottom:a.clientY,left:a.clientX+(b?6:0),right:a.clientX+(b?6:0)};if(b){c=c||'tb,bt,rl,lr';}var w=js.m(this.x.wd),h=this.g_ht();if(!h){h=this.$().offsetHeight;}var d=$.snapbcr(w+(b?8:0),h+(b?8:0),a,c),l=d.left,t=d.top;if(b){var r=$.canrec(),e;this.x.prongPos=prong_pos[d.pos];if((d.pos==='t'||d.pos==='b')&&this.x.prongLeft==null){if(d.pos==='b')t+=8;if(e=w+l>r.width?w+l-r.width:l<0?l:0){l-=e;}this.x.prongLeft=a.left-l+(a.width/2)-8;}if((d.pos==='l'||d.pos==='r')&&this.x.prongTop==null){if(d.pos==='r')l-=8;if(e=h+t>r.height?h+t-r.height:t<0?t:0){t-=e;}this.x.prongTop=a.top-t+(a.height/2)-8;}if(typeof o.clz==='function'){o.clz('z-ctx');this.addEventOnce('close',function(){o.clz('z-ctx',true)});}}this.x.left=l;this.x.top=t;if(this.vis){this.moveTo(l,t);if(this.x.prongPos)this.jv();}return this;},$:function(a){return $(this.id+(a?'-'+a:''));},vm:function(){return VM('/'+this.x.n);},css:function(a,b){$.css(this.id,a,b);if(this._ie6fr)$.css(this.id+'-ie6fr',a,b);$.css(this.id+'-shadow',a,b);},rect:function(){return{top:this.x.top,left:this.x.left,width:this.x.wd,height:this.x.ht};},setTitle:function(a){this.title=a;if(this.vis&&a&&this.$('title'))this.$('title').innerHTML=a;},getSrc:function(a){return a?js.url_get(this.x.src,a):this.x.src;},moveTo:function(x,y){if(this._disposed){return;}if(typeof x==='number'){if(this.vis)this.css('left',x);this.x.left=x;}if(typeof y==='number'){if(this.vis)this.css('top',y);this.x.top=y;}var f=this.x.onmove||this.x.on_move;if(typeof f==='function')f.call(this);else Function(f).call(this);this.fireEvent('move');return this;},resizeTo:function(w,h){if(w==-1)w=$.canrec().width;if(w&&w!=this.x.wd){this.x.wd=w;this.css('width',w);}if(h==-1)h=$.canrec().height;if(h&&h!=this.x.ht){this.x.ht=h;this.css('height',h);}this.div.resize(w||null,h||null);var f=this.x.onresize||this.x.on_resize;if(typeof f=='function')f.call(this);else Function(f).call(this);this.fireEvent('resize');return this;},on_window_resize:function(){if(this.iP||this.iO){this.resizeTo(this.iP?-1:null,this.iO?-1:null);}var o=this.x.magnet;if(o&&o.nodeType){this.snap(this.x.magnet,this.x.prong,this.x.magtype);}},max:function(a){if(!this._max_ft){this._max_ft={w:this.x.wd,h:this.x.ht,t:this.x.top,l:this.x.left};}var b=$.get('.i-c-g',a);if(b.className.indexOf('i-dlg-max')>-1){this.resizeTo(-1,-1);this.moveTo(0,0);b.className='i-c-g i-dlg-ori';this.iB=true;}else{this.resizeTo(this._max_ft.w,this._max_ft.h);this.moveTo(this._max_ft.l,this._max_ft.t);b.className='i-c-g i-dlg-max';this.iB=false;}},isMax:function(){return this.iB;},width:function(){return this.x.wd;},height:function(){return this.x.ht;},reload:function(a){if(this.x.src&&this.x.src.reload)this.x.src.reload(a);},onContentLoad:function(){if(this.x.on_contentload){(typeof this.x.on_contentload==='function'?this.x.on_contentload:Function(this.x.on_contentload)).call(this);}if(!this.x.hideshadow&&!Br.css3){this.$('shadow').className='shadow';}this.fireEvent('contentload');},g_ht:function(){return this.x.ht==='*'?this.$().offsetHeight:this.x.ht},showAtCorner:function(posCode){var sw=this.x.wd;var sh=this.g_ht();var dr=/[1256tb]/.test(posCode)?'y':'x';var ofx=this.x.magnet?0:/[1678]/.test(posCode)?3:-4;var ofy=this.x.magnet?0:/[1238]/.test(posCode)?3:-4;var a1,a2;switch(String(posCode)){case '1':a1=14;a2=11;break;case '2':a1=23;a2=22;break;case '3':a1=21;a2=22;break;case '4':a1=34;a2=33;break;case '5':a1=32;a2=33;break;case '6':a1=41;a2=44;break;case '7':a1=43;a2=44;break;case '8':a1=12;a2=11;break;case 't':a1='tb';a2='tt';break;case 'b':a1='lr';a2='rr';break;case 'b':a1='bt';a2='bb';break;case 'l':a1='rl';a2='ll';break;}var r1=$.snaprec(sw,sh,this.x.magnet||$.canvas(),a1),r2=$.snaprec(sw,sh,this.x.magnet||$.canvas(),a2),prop=dr==='x'?'left':'top',sr=isNaN(posCode)||posCode>0?r1:r2,er=isNaN(posCode)||posCode>0?r2:r1;this.moveTo(sr.left+ofx,sr.top+ofy);var ioff=eval('of'+dr),startPos=sr[prop],endPos=er[prop];if(posCode>0)endPos+=ioff;else startPos+=ioff;if(!this.x.magtype)this.x.magtype=er.type;var o=this,t=js.fps_timer(function(p){if(o._disposed){clearInterval(t);}else{if(p===1)o.moveTo(dr==='x'&&endPos,dr==='y'&&Math.max(0,endPos));else o.$().style[prop]=(startPos+(endPos-startPos)*p)+'px';}});},render:function(){if(this.vis||this._disposed)return this;var a=this.id,b=this.x.slide,w=this.x.wd,h=this.x.ht,x=this.x.left,y=this.x.top,s='position:'+(Cfg.plus?'fixed':'absolute')+';width:'+w+'px;height:'+(h==='*'?'auto':h+'px')+';top:'+y+'px;left:'+x+'px;z-index:'+this.zIndex+';';if(this.x.cvr&&this.x.cvr!=='0')this.bu=Fn.Dialog.cover(this);if(Br._ie6){this._ie6fr=true;if(!this._ie6fr){for(var j=frames.length-1;j>-1;j--){try{if(typeof frames[j]==='object'&&$.tags('select',frames[j].document.body).length){this._ie6fr=1;break;}}catch(e){}}}}if(!$('fndg-cont'))$.db('<div id=fndg-cont></div>');$.append($('fndg-cont'),'<div id='+this.id+'-shadow style="'+s+'" class="'+(typeof this.x.src==='string'?'':(Br.css3?'':'shadow'))+'"></div>'+(this._ie6fr?$.htm.ie6fr(w,h,'',this.id+'-ie6fr',s):'')+'<div id='+a+' fndgid='+a+' style="'+s+'" class="'+this.tmpl_clz+(b?' opc0':'')+'"></div>');this.ga();if(b)$.fadeIn($(a));return this;},ga:function(){this.div.render(this.$());this.vis=true;if(this.fromView&&!this.x.independent){this.fromView.addEventOnce('remove',this.onOpenerUnload,this);}if(this.x.pophide)this.aB('pophide',1);var p=this.x.pos;if(this.x.ht==='*'){var ch=$.canrec().height,ht=Math.min(this.$().offsetHeight,ch-4);this.$().style.maxHeight=$.canrec().height;if(!p||p=='0'){this.moveTo(this.x.left,this.x.top!=null?this.x.top:(ch-ht)/2);}}if(this.x.pos&&this.x.pos!='0'){this.showAtCorner(this.x.pos);}if(this.x.tm)setTimeout('try{Fn.Dialog.get("'+this.id+'").close()}catch(e){}',this.x.tm*1000);if(this.x.prong&&this.x.ht!=='*'){this.jv();}this.fireEvent('render');return this;},jv:function(){var p=this.x.prongPos;$.append($(this.id),'<div id='+this.id+'-prong class=d-prong-'+p+' style="'+(p=='t'||p=='b'?'left:'+this.x.prongLeft:'top:'+this.x.prongTop)+'px;">'+$.htm.arw(p+4)+$.htm.arw(p+3)+'</div>');},attr:function(a,b){if(typeof a=='object'){for(var i in a){this.aB(i,a[i]);}}else{if(arguments.length==2){this.aB(a,b);}else return this.x[a];}},aB:function(a,b){if(a=='pophide'){if(b){var d=this.id;this.fE=this.fE||function(){var e=Fn.Dialog._a[d],f=event.srcElement,g=e.poper,h;if(g){if(g.nodeType==1)h=g.contains(f);else{}}if(!h&&!e.contains(f))e.close();};$.e_add(VM().$(),'mousedown mousewheel',this.fE);$.e_add($('fndg-cont'),'mousedown mousewheel',this.fE);}else{if(this.fE){$.e_remove(VM().$(),'mousedown mousewheel',this.fE);$.e_remove($('fndg-cont'),'mousedown mousewheel',this.fE);}}}else if(a=='hideshadow'){if(Br.css3){$.class_add($(this.id),'shadow',b);}else $(this.id+'-shadow').className=b?'':'shadow';}this.x[a]=b;},toggle:function(){var a=!this.eD,b=this.$('ex-icon').src.indexOf('ulfff')>-1?'fff':'';this.$('shadow').style.posHeight=this.x.ht-(a?this.div.i_ht:0);this.$('src').style.posHeight=a?0:this.div.i_ht;this.$('ex-icon').src='/img/p/ul'+b+(a?'expand':'collapse')+'.gif';this.eD=a;this.maxz();this.fireEvent('toggle');},show:function(){var self=this;if(this.x.slide)$.fadeIn(this.$(),function(){self.$().style.display=self.$('shadow').style.display=''});else this.$('shadow').style.display='';this.$().style.display='';if(this.bu)this.bu.style.display='';this.C=true;this.fireEvent('show');},hide:function(){var self=this;if(this.x.slide)$.fadeOut(this.$(),false,function(){self.$().style.display=self.$('shadow').style.display='none'});else this.$().style.display='none';this.$('shadow').style.display='none';if(this.bu)this.bu.style.display='none';this.C=false;},isShow:function(){return this.C},getDialogArguments:function(){return this.x.args;},args:function(a){if(arguments.length)this.x.args=a;return this.x.args;},contains:function(a){if(this.$().contains(a))return true;for(var i=0;i<this.length;i++)if(this[i].contains(a))return true;return false;},close:function(a){if(!this._disposed){this.fireEvent('close');if(!this._disposed){if(this.x.cache){if(this.C){this.hide();for(var i=this.length-1;i>=0;i--)this[i].close();}}else this.doClose(a);}}},doClose:function(a){if(this._disposed)return;if(this.$().contains(document.activeElement))document.activeElement.blur();for(var i=this.length-1;i>=0;i--)this[i].doClose();var d=this.id,i=0,b=$.tags('iframe',$(d));try{while(b[i])$.wr(b[i++].contentWindow);}catch(e){}$.rm(this.id+'-shadow');if(!a&&this.x.slide&&this.x.pophide!=1){var w=this.$().offsetWidth,h=this.$().offsetHeight;$.append(this.$(),'<img class="ps-abs" src='+$.htm.dot+' style="width:'+w+'px;height:'+h+'px;top:0;left:0;z-index:999">');$.fadeOut($(d),true,function(){if(Fn.Dialog._a[d])Fn.Dialog._a[d].fY()});}else this.fY();},fY:function(){try{this.div.remove();}catch(e){}$.rm(this.id);if(this._ie6fr)$.rm(this.id+'-ie6fr');this.dispose();},dispose:function(){if(this._disposed)return;if(this.fromView)this.fromView.removeEvent('remove',this.onOpenerUnload,this);if(this.fE&&!this.fe)this.aB('pophide',0);if(this.moving&&this.dN)this.dN();if(this.bu)$.rm(this.bu);delete Fn.Dialog._a[this.id];if(this.x.n)delete Fn.Dialog._n[this.x.n];if(this.U){VM().div.removeEvent('resize',this.U);delete this.U;}js.dps(this.x,'fromView','args','cn');js.dps(this,'fromView','fE','poper','dN','bu','x','parent','_floatArgs','div','bM');if(this.parentNode&&this.parentNode.modal)this.parentNode.modal=null;this.removeNode();},onOpenerUnload:function(){if(this._disposed)return;this.fe=true;if(!this.x.independent)this.doClose(true);}}});Fn.fW('Tip',{Const:function(x){this.x=x;this.ww=window;this.id=Fn.Tip.g_id();var ev=this.ww.event;this.ex=ev&&ev.clientX;this.ey=ev&&ev.clientY;Fn.Tip._a[this.id]=this;var c=this.$t();if(c)$.e_add(c,'mouseout contextmenu'+((ev&&ev.type!=='click')?' click':''),this.fi=Function('Fn.Tip.out_target("'+this.id+'")'));if(('showDelay' in this.x)&&this.x.showDelay<=0)Fn.Tip.show(this.id);else this.hz=setTimeout('Fn.Tip.show("'+this.id+'")',(this.x.showDelay||.6)*1000);},Helper:{inst:null,_a:{},idp:'fntip-',idc:0,g_id:function(){return this.idp+this.idc++;},Cnt:0,get:function(a){return Fn.Tip._a[Q(a).closest('[fn-type=tip]').attr('id')];},create:function(x){if(x.multiple){var i,k;for(var i in this._a){if(this._a[i].x.target===x.target){this._a[i].show();k=i;}}if(!k)new Fn.Tip(x);}else{if(this.inst){if(this.inst.x.target==x.target){if(this.inst.el)this.inst.show(this.inst.x.hideDelay);}else{this.inst.remove();this.inst=new Fn.Tip(x);}}else{this.inst=new Fn.Tip(x);}}},show:function(a){if(this._a[a])this._a[a].show(this._a[a].x.hideDelay);},over:function(a){if(this._a[a]){clearTimeout(this._a[a].hz);}},out:function(a){var b=this._a[a];if(b&&!b.x.alwaysShow&&(!b.w().event||!b.el.contains(b.w().event.toElement)))b.remove();},out_target:function(a){var b=this._a[a];if(b&&!b.x.alwaysShow){if(b.el&&b.w().event){if(!b.$t().contains(b.w().event.toElement))b.show(.1);}else{b.remove();}}},remove:function(a){if(a){if(this._a[a])this._a[a].remove();}else{if(this.inst)this.inst.remove();}}},Prototype:{hz:null,w:function(a){return a?this.ww.document.getElementById(a):this.ww;},show:function(a){this.gJ();clearTimeout(this.hz);if(a>0)this.hz=setTimeout('Fn.Tip.remove("'+this.id+'")',a*1000);},gJ:function(){if(this.w.event){this.ex=this.w.event.clientX;this.ey=this.w.event.clientY;}var x=this.ex+this.ww.document.body.scrollLeft+10,y=this.ey+this.ww.document.body.scrollTop+10,a=this.el,b=this.id,c=this.x.target;if(!a){var s=['<div id='+b+' fn-type="tip" onmouseover=Fn.Tip.over("'+b+'") onmouseout=Fn.Tip.out("'+b+'") class=f-tip style="z-index:'+$.g_z()+';'+(this.x.width?'width:'+this.x.width+'px':'')+'">'];s.push('<div class="tip-c clearfix" id='+b+'-c>');if(!this.x.src){s.push(this.x.html?(this.x.encode?js.url_unesc(this.x.html):this.x.html):'&nbsp;');}if(this.x.closable)s.push($.htm.sic('.i-x-tip','','tip-x hand','Fn.Tip.remove("'+this.id+'")'));s.push('</div></div>');var range;if(this.x.range){range=typeof this.x.range.$==='function'?this.x.range.$():this.x.range;}a=$.append(range||this.ww.document.body,s.join(''));if(this.x.src)VM.load(this.x.src,this.w(b),this.x.width||210,null);}if(!this.el||this.x.trackMouse){if(this.x.width){if(Br._ie6)$(b).style.width=(this.x.width-14)+'px';}var c=this.x.target,d=$.canrec(this.ww),p='b';if(c&&'$' in c)c=c.$();var w=a.offsetWidth,h=a.offsetHeight,r=$.bcr(c,range);if(this.x.snap||!c.nodeType){c=$.snaprec(w,h,r,this.x.snap,range);d=c.type;a.style.left=c.left+'px';a.style.top=(c.top-(d==21||d==12?3:0))+'px';p=c.pos;}else{c=r||$.bcr(event.srcElement);if(x>c.right-30)x=c.right-30;if(y<c.bottom+5)y=c.bottom+5;if(y+a.offsetHeight>d.height){y=c.top-a.offsetHeight-3;p='t';}if(x+w>d.width)x-=x+w-d.width;a.style.left=x+'px';a.style.top=y+'px';}var s=prong_pos[p],e=$(this.id+'-pr')||$.append($(this.id),'<div id='+this.id+'-pr class=d-prong-'+s+'><em class=f-arw-'+s+'4></em><em class=f-arw-'+s+'3></em></div>'),f=$.bcr(a,range),g=$.bcr(e,range);if(p==='t'||p==='b'){var m=js.m_rng((r.left+r.right)/2,f.left+25,f.right-17);e.style.marginLeft=(m-g.left-9)+'px';}else if(p==='l'||p==='r'){var m=js.m_rng((r.top+r.bottom)/2,f.top+5,f.bottom-5);e.style.marginTop=(m-g.top-8)+'px';}if(!this.el)this.el=a;if(this.x.ready){js.call(this.x.ready,this);}}},$t:function(){return('$' in this.x.target)?this.x.target.$():this.x.target;},remove:function(){clearTimeout(this.hz);if(this.fi){if(this.$t())$.e_remove(this.$t(),'mouseout click contextmenu',this.fi);this.fi=null;}$.rm(this.el);this.x.target=Fn.Tip.inst=this.el=this.x=this.hz=null;delete Fn.Tip._a[this.id];}}});})();﻿Fn.fW('MenuItem',{Const:function(){this.id=Fn.Menu.g_id();Fn.Menu._a[this.id]=this;},Extend:[Fn.EventNode],Prototype:{vis:false,aE:false,ed:true,fF:null,add:function(x){return this.addNode(new Fn.MenuRow(x));},addsplit:function(){return this.addNode(new Fn.MenuSplit());},show:function(){if(!this.length)return;if(!this.vis)this.render();var p=this.parentNode.parentNode,n=this.parentNode.nodeIndex,r=$.canrec(),lf,tp;if(p.ed){lf=p.ei+p.hY-4;if(lf+this.hY>r.width&&r.width-(p.ei+p.hY)<p.ei){lf=p.ei-this.hY+4;this.ed=false;}}else{lf=p.ei-this.hY;if(lf<0&&p.ei<r.width-(p.ei+p.hY)){lf=p.ei+p.hY;this.ed=true;}}var a=$.bcr($(this.parentNode.id));tp=a.top;if(tp+this.dL>r.height)tp=r.height-this.dL-5;if(lf<0)lf=0;if(lf+this.hY>r.width)lf=r.width-this.hY;this.ei=lf;this.hE=tp;$.css($(this.id),'left',lf,'top',tp,'visibility','visible');$.class_add($(this.parentNode.id),'hv');this.aE=true;},hide:function(){if(this.vis){if(this.parentNode){$(this.id).style.visibility='hidden';$.class_del($(this.parentNode.id),'hv');}else this.fF.hide();for(var i=this.length-1;i>=0;i--)if(this[i].length&&this[i][0].aE)this[i][0].hide();this.aE=false;}},g_ht:function(a){if(a==null)a=this.length;for(var i=0,b=0;i<a;i++)b+=this[i].dL;return b+4;},contains:function(a){if(this.vis){if($(this.id).contains(a))return 1;for(var i=0;i<this.length;i++)if(this[i].contains(a))return 1;}},struct:function(){},render:function(a,b){this.fF=$.db(this.html(a,b));var c=Math.floor($.canrec().width/2),w=$(this.id).offsetWidth+1,h=$(this.id).offsetHeight;$(this.id).style.width=Math.min(c,w)+'px';if(w>c){w=c;$.class_add($(this.id),'c-lmt');if(Br._ie6){Q('.om-tt',$(this.id)).css('width',c-70);}}this.hY=w;this.dL=h;this.vis=true;},html:function(a,b,trc){var h=$.canrec().height;if(a&&a.top!=null&&a.bottom!=null&&b&&b.snaptype===$.snaptype.v){h=Math.max(a.top,h-a.bottom);}var d=Math.floor((h-24)/30),m=Math.min(this.length,d),i=0,l=m,e=[];if(b&&b.index){i=Math.floor((b.index-1)/d)*d;if(this.length-i<d)i=this.length-d;i=Math.max(0,i);l=Math.min(i+m,this.length);}this.Y=d;this.X=i;this.Z=Math.ceil(this.length/m);for(;i<l;i++){e.push(this[i].html());}var g=this.Z>1,c=b&&b.minWidth,s=(Br.ie_7?'<table cellspacing=0 cellpadding=0':'<div')+' class="o-menu'+(g?' o-menu-scr':'')+(b&&b.face?' '+b.face+(/-menu$/.test(b.face)?'':'-menu'):'')+'" style=z-index:'+$.g_z()+' id='+this.id,t=c?'min-width:'+(c+12)+'px;':'';if(g)t+='height:'+(d*30)+'px;';this.aG=js.any(this,'v.x.rdo!=null||v.x.cbx!=null');this.eZ=js.any(this,'!!v.x.xclk');if(Br.ie_7)s+='><tr><td';s+=' onmousewheel="Fn.Menu.wheel(this)">';if(!this.parentNode&&c){s+='<div class="om-pad" style="width:'+(c-2)+'px"></div>';}return s+'<div class=om-tl><div class=om-tr><div id='+this.id+'-t class=om-tc>'+(g?'<div class=o-scr onmousedown=Fn.Menu.scr(this,-1)>'+$.htm.arw('t2')+'</div>':'')+'</div></div></div><div class=om-mc id='+this.id+'-m'+(t?' style="'+t+'"':'')+'><dl class=o-wrap id='+this.id+'-w>'+e.join('')+'</dl></div><div class=om-bl><div class=om-br><div id='+this.id+'-b class=om-bc>'+(g?'<div class=o-scr onmousedown=Fn.Menu.scr(this,1)>'+$.htm.arw('b2')+'</div>':'')+'</div></div></div>'+(Br.ie_7?'</table>':'</div>')},dispose:function(){if(this._disposed)return;for(var i=this.length-1;i>=0;i--)this[i].dispose();if(this.fF)this.fF.removeNode(true);delete Fn.Menu._a[this.id];this.fF=this.id=null;this.removeNode();}}});Fn.fW('Menu',{Const:function(a,b,c){this.owner=a||null;if(b)this.args=b;if(c)this.xml=c;Fn.MenuItem.call(this);},Extend:[Fn.MenuItem],Helper:{_a:{},idc:0,g_id:function(){return 'menu-'+(this.idc++)},closeinterval:function(a){var b=this._a[a];if(b&&!b._disposed)b.aX();},over:function(a){var c=this._a[a.id];if(c&&!c.x.ds&&!c.x.rdn){$.class_add(a,'hv');if(c.length){c[0].show();}else if(c.x.src){$.class_add($(c.id+'-m'),'z-loading');if(!c.loading)Ajax.sendx(c.x.src,function(x){if(x!==false&&c.parentNode){Fn.Oper.mapToMenu(c,$.x_json(x).nodes);if(c.length&&$.class_any(a,'hv'))c[0].show();$.class_del($(c.id+'-m'),'z-loading');c.loading=false;}});c.loading=true;}for(var p=c.parentNode,i=p.length-1;i>=0;i--)if(p[i]!=c&&p[i].length)p[i][0].hide();}},out:function(a){var c=this._a[a.id];if(c&&!c.x.ds&&!c.x.rdn){$.class_del(a,'hv');if(c.length){c[0].show();}else if(c.x.src){$.class_del($(c.id+'-m'),'z-loading');}}},clk:function(a,b){var c=Fn.Menu._a[a.id];if(c._disposed||c.x.ds||!c.x.clk)return;var d=c.rootNode;if(d==c.parentNode)Fn.Event.setev(d.ei+b.clientX,d.hE+b.clientY);(typeof c.x.clk==='string'?Function(c.x.clk):c.x.clk).call(c);d.dispose();},xclk:function(a,b){var c=Fn.Menu._a[a];if(c._disposed||c.x.ds||!c.x.xclk)return;var d=c.rootNode,f=(typeof c.x.xclk==='string'?Function(c.x.xclk):c.x.xclk).call(c);$.e_stop(b);if(f!==false)d.dispose();},scr_timer:{},scr:function(a,b){var id=Fn.Menu.cur.id,g=this;clearTimeout(g.scr_timer[id]);function doScr(){var d=Fn.Menu._a[id],c=d.X,s=d.Z,r=d.Y;if(d.length<=r)return;var p=js.m_rng(c+(r*b),0,d.length-r),l=Math.min(p+r,d.length),e=[];if(i!==c){d.X=p;for(var i=p;i<l;i++){if(!d[i].vis)e.push(d[i].html());}$.append($(id+'-w'),e.join(''),b===1?'beforeend':'afterbegin');$(id+'-m').scrollTop+=$(id+'-m').offsetHeight*b;}};doScr();if(event.type!=='mousewheel'){g.scr_timer[id]=setTimeout(function(){doScr();g.scr_timer[id]=setTimeout(arguments.callee,50)},300);$.e_attach(a,'mouseup',function(){clearTimeout(g.scr_timer[id]);$.e_detach(a,'mouseup',arguments.callee,true);},true);}},wheel:function(a){Fn.Menu.scr(a,event.wheelDelta>0?-1:1)}},Prototype:{$:function(){return $(this.id)},show:function(a,b){if(!this.length)return false;var h=a&&js.type(a)=='html',e=a&&a.srcElement,o=a&&!e,w=h?$.win(a):(e?$.win(e):window),c=$.canvas(),d,iLeft,iTop;this.ww=w;if(!this.vis)this.render(a,b);if(Fn.Menu.cur&&Fn.Menu.cur!=this)Fn.Menu.cur.dispose();Fn.Menu.cur=this;if(a==null&&w.event)a=w.event.type=='contextmenu'?w.event:w.event.srcElement;var r=w==window?null:$.bcr(w.frameElement),f=$.canvas(w);if(h||o){d=$[h?'snaprec':'snapbcr'](this.hY,this.dL,a,(b&&b.snaptype)||$.snaptype.v);iLeft=(r?r.left:0)+d.left-f.scrollLeft;iTop=(r?r.top:0)+d.top-f.scrollTop;if(a&&b){this._rc=d;$.class_add($(this.id),'rc'+d.type);if(this.owner.$){$.class_add(this.owner.$(),'rc'+d.type);$.css(this.owner.$(),'zIndex',$.g_z());}if(d.pos==='r'||d.pos==='l'){if(iTop+this.dL>c.clientHeight){iTop=Math.max(f.scrollTop,c.clientHeight-this.dL);}}}}else{iLeft=a&&(Br.ie||a.constructor!=w.XMLHttpRequest)?w.event.clientX+(r?r.left:0):Fn.Event.getev().x;iTop=a&&(Br.ie||a.constructor!=w.XMLHttpRequest)?w.event.clientY+(r?r.top:0):Fn.Event.getev().y;}if(iLeft+this.hY>c.clientWidth)iLeft=c.clientWidth-this.hY;if(iTop+this.dL>c.clientHeight){iTop=c.clientHeight-this.dL;if(b&&b.pos==='b'){iTop=b.top}}$.css(this.id,{left:iLeft,top:iTop});this.ei=iLeft;this.hE=iTop;f=this.id;this.be=function(){var a=w.event.srcElement;if(!a||!Fn.Menu._a[f].contains(a))setTimeout('Fn.Menu._a["'+f+'"]&&Fn.Menu._a["'+f+'"].dispose()',100);};$.e_add(w.document,'mouseup mousewheel',this.be);if(w.event&&w.event.type==='contextmenu')$.e_stop(w.event);var d=this.owner;if(d){if(d.$)d=d.$();if(d&&d.nodeType===1)$.class_add(d,'z-menu');}return this.aE=true;},render:function(a,b){Fn.MenuItem.prototype.render.call(this,a,b);this.vis=true;},delayHide:function(){var self=this;Q([this.$(),this.owner.$()]).hover(function(){clearTimeout(self.hide_timer);},function(){self.hide_timer=setTimeout(function(){self.dispose()},500);});},dispose:function(){if(this._disposed)return;this.fireEvent('close');var d=this.owner;if(d){if(d.$)d=d.$();if(d&&d.nodeType===1)$.class_del(d,'z-menu');if(d&&this._rc){$.class_del(d,'rc'+this._rc.type);$.css(d,'zIndex','');delete this._rc;}}for(var i=this.length-1;i>=0;i--)this[i].dispose();if(this.fF){$.rm(this.fF);$.e_remove(this.ww.document,'mouseup mousewheel',this.be);}if(this.hide_timer){clearTimeout(this.hide_timer);delete this.hide_timer;}delete Fn.Menu._a[this.id];delete Fn.Menu.cur;js.dps(this,'fF','owner','_close_timer','ei','hE','id','be','ww','xml','args');this.removeNode();},aX:function(){if(this.fF==null||!this.fF.isOpen)this.dispose();}}});Fn.fW('MenuSplit',{Const:function(){this.x={split:true};},Extend:[Fn.Node],Prototype:{dL:12,contains:function(a){},html:function(){return '<dt class=o-p>'+(Br.cmp?'<div class=o-hr></div>':'<table class=o-hr width=100%><tr><td></table>')+'</dt>';},dispose:function(){this.removeNode();}}});Fn.fW('MenuRow',{Const:function(x){this.x=x;Fn.MenuItem.call(this);},Extend:[Fn.Node],Prototype:{dL:30,attr:function(a,b){return Fn.OperOffice.prototype.attr.call(this,a,b);},add:function(a,b,c,d,e,f){return(this.length?this[0]:this.addNode(new Fn.MenuItem())).add(a,b,c,d,e,f);},addsplit:function(){return(this.length?this[0]:this.addNode(new Fn.MenuItem())).addsplit();},getOwner:function(){return this.rootNode.owner;},args:function(a){return a==null?this.rootNode.args:this.args()[a];},xml:function(a){var c=this,d=[];do{d.unshift('b['+(c.nodeIndex+1)+']');}while(c=c.parentNode.parentNode);var b=this.getOwner(),c=(b&&b.eG)||this.rootNode.xml;if(c)return $.x(c,d.join('/'));},contains:function(a){for(var i=0;i<this.length;i++)if(this[i].contains(a))return true;},focus:function(a){if(a==null)a=true;var o=$.get('.om-tt',$(this.id));o.style.width=($(this.id).offsetWidth-94)+'px';$.class_add(o,'bold',!a);},html:function(){var x=this.x,s='<dt class="o-l clearfix'+(x.ds?' f-ds':'')+(x.focus?' on':'')+'" id='+this.id+(this.parentNode.parentNode?' onmousedown':' onclick')+'=Fn.Menu.clk(this,event) onmouseover=Fn.Menu.over(this) onmouseout=Fn.Menu.out(this)><span class=o-b><div class="om-c clearfix">';if(this.parentNode.aG){s+=$.htm.ico(x.rdo?'.i-menu-rdo':x.cbx?'.i-menu-cbx':x.cbx==0?'.i-menu-cbx-checked':'.dot',{clz:"om-bx"});}s+=$.htm.ico(x.ic||'.dot',{clz:"om-ic"});if(x.t)s+='<div class="om-tt fix'+(x.bold?' bold':'')+'">'+x.t.replace(/ /g,'&nbsp;')+'</div>';s+='<div class=om-r>';if(x.xclk){s+=$.htm.ico('.i-x',{clz:"om-x",clk:'Fn.Menu.xclk("'+this.id+'",event)'});}s+='<div id='+this.id+'-m class=om-m><i class=va-i></i>'+(this.length||x.src?$.htm.arw('r1'):'')+'</div>';s+='</div></div>';this.vis=true;return s+'</span></dt>';},remove:function(){$.rm(this.id);this.dispose();},dispose:function(){if(this._disposed)return;if(this.length)this[0].dispose();delete Fn.Menu._a[this.id];delete this.x;this.removeNode();}}}); ﻿Fn.fW('DivItem',{Const:function(a,b,c,d,e,f,g){this.wd=a==null||a<0?null:Math.max(a,e||0);this.ht=b==null||b<0?null:Math.max(b,f||0);this.attr=c||'';this.css=d||'';this.pad_hrz=e||0;this.pad_vrt=f||0;this.i_wd=this.wd!=null?this.wd-this.pad_hrz:null;this.i_ht=this.ht!=null?this.ht-this.pad_vrt:null;if(g){this.gx=g;this.ay=g&&g!=='hidden'&&g!=='miniscroll';if(this.ay&&this.i_wd!=null)this.i_wd-=Br[g];}this.id=Fn.Div.g_id();Fn.Div._a[this.id]=this;}});Fn.fW('Div',{Const:function(){Fn.DivItem.apply(this,arguments);this.type_dat=true;},Extend:[Fn.EventNode],Helper:{idc:0,_a:{},hv:['','\t','\t\t','\t\t\t','\t\t\t\t','\t\t\t\t\t','\t\t\t\t\t\t','\t\t\t\t\t\t\t','\t\t\t\t\t\t\t\t'],tabpad:function(a){if(typeof a=='object')a=a.level;if(a>0){if(a<9)return this.hv[a];var b=a%8,c=this.hv[b];for(var i=0;i<b;i+=8)c+=this.hv[8];return c;}return '';},g_id:function(){return 'fndiv-'+(this.idc++)},get:function(a){if(typeof a==='string'){return this._a[a];}else{var b=a;while(b){if(b.tagName==='DIV'&&b.id.indexOf('fndiv-')===0&&(a=this._a[b.id]))return a;b=b.parentNode;}}return null;},addClass:function(a,b){return a.indexOf('class=')<0?'class="'+b+'" '+a:a.replace(/(\bclass=)(?:['"]([^'"]*)['"]|([^'" ]*))/,'\$1"'+b+' \$2\$3"')},set_valve:function(a,b,c,d,e){var f=/^(\d+),(\d+)(?:,(\w+))?/,g;if(b){a.a_wd=(g=b.match(f))?[parseFloat(g[1]),parseFloat(g[2])]:eval(b+'(this,0)');if(g&&g[3])a.a_target=g[3];}if(c){a.a_ht=(g=c.match(f))?[parseFloat(g[1]),parseFloat(g[2])]:eval(c+'(this,1)');if(g&&g[3])a.a_target=g[3];}if(b||c){if(d)a.hV=typeof d==='function'?d:eval(d);if(e)a.hW=typeof e==='function'?e:eval(e);a.aA=true;}if(a.vis&&a.aA){$.css(a.$(),'cursor',(a.a_wd&&a.a_ht?(a.parentNode.bcol?'col':'row'):(a.a_wd?'col':'row'))+'-resize');a.$().onmousedown=Function('Fn.Div.valve(this)');}return a;},rm_valve:function(a){a.aA=false;$.css(a.$(),'cursor','');},valve_target:function(a){var b=$.bcr(a.$()),c=$.db('<div class="absolute bd-gray bd-dashed" style="top:'+b.top+'px;left:'+b.left+'px;width:'+(b.width-2)+'px;height:'+(b.height-2)+'px;"></div>'),x=event.clientX,y=event.clientY;$.e_moveup(c,function(){if(a.a_wd)c.style.left=(b.left+event.clientX-x)+'px';else c.style.top=(b.top+event.clientY-y)+'px';},function(){DFish.collapseParent(a,'+='+(a.a_wd?event.clientX-x:event.clientY-y));$.rm(c);c=null;});},valve:function(a){a=Fn.Div._a[a.id];if(!a.aA)return;if(a.a_target){return Fn.Div.valve_target(a);}var b=a.parentNode,c=a.nodeIndex,d=a.$(),e=$.canvas(),cv=a.a_wd&&a.a_ht&&b.length==3&&b[1]==a&&40,pr=$.bcr(b[c-1].$()),nr=$.bcr(b[c+1].$()),col,rc,ps,n,on,scr,np,xp,cur,ori,off,st,ost,mv;function init(bCol){col=bCol;rc=$.bcr(mv||d);ps=col?'left':'top';n=col?'clientX':'clientY';on=col?'clientY':'clientX';scr=col?'scrollLeft':'scrollTop';oscr=col?'scrollTop':'scrollLeft';np=pr[ps]+a[col?'a_wd':'a_ht'][0];xp=nr[col?'right':'bottom']-a[col?'a_wd':'a_ht'][1]-b.scales[c];cur=ori=rc[ps];scr=e[scr];st=event[n];ost=event[on];off=st-cur;};function convert(){$.css(mv,'left',col?pr.left:event[on]-off+e[oscr],'top',col?event[on]-off+e[oscr]:pr.top,'width',col?b.wd:b.scales[c],'height',col?b.scales[c]:b.ht,'cursor',col?'col-resize':'row-resize');init(!col);};init(b.bcol);if(Br.ie){$.e_attach(document,'selectstart',js.rt_false);}$.e_moveup(d,function(){if(!mv&&Math.abs(event[n]-st)>1){mv=$.db('<div style="position:absolute;z-index:'+$.g_z()+';cursor:'+(d.currentStyle?d.currentStyle.cursor:'default')+';left:'+rc.left+'px;top:'+rc.top+'px;width:'+d.offsetWidth+'px;height:'+d.offsetHeight+'px;border:1px dashed gray;overflow:hidden;"></div>');}if(mv){if(cv&&Math.abs(event[on]-ost)>cv)convert();cur=event[n]-off+scr;if(a.hV){if(cur<=xp&&cur>=np){var _p=event[n]-off-ori;a.hV(pr[col?'width':'height']-_p,nr[col?'width':'height']-_p);}}$.css(mv,ps,cur=js.m_rng(cur,np,xp));}},function(){if(mv){$.rm(mv);var l=b[col?'i_wd':'i_ht']-b.scales[c],u=b.scales.concat();u[c-1]=cur-pr[ps];u[c+1]='*';b.resize(null,null,(col?'cols':'rows')+'='+u);d.style.cursor=col?'col-resize':'row-resize';if(a.hW)a.hW(event[n]-off-ori);a.fireEvent('valve');a.fireEvent('drag');}a=b=c=d=e=pr=nr=rc=mv=null;if(Br.ie){$.e_detach(document,'selectstart',js.rt_false);}});$.e_stop();},addOnRender:function(a,b,c,d){if(!a.parentNode){a.addEventOnce('render',b,c,d);}else{var e=a;while(e&&e.parentNode&&!e.parentNode.$())e=e.parentNode;(e||a).addEventOnce('render',b,c,d);}return a;},resizeTo:function(a,w,h){var z=w==null;if(z&&h==null)return;if(!z&&h!=null){this.resizeTo(a,w);this.resizeTo(a,null,h);return;}var b=a.parentNode,c=z?'rows':'cols';while(b&&(!(b.type_set)||b.type!=c||b.ssca=='*')){a=b;b=a.parentNode;}if(b){var d=b.ssca.split(',');d[a.nodeIndex]=b.scales[a.nodeIndex]+(z?h-a.ht:w-a.wd);b.resize(null,null,c+'='+d);}else{a.resize(w,h);}},p_tag:function(a,b,c){if(!a.hn)a.hn={head:'',foot:''};a.hn.head+=b;a.hn.foot+=c;return a;},scrover:function(a,o){var b=a.id,c=Fn.Div._a[b],d;if(!c){return;}if(c.ht!=null){d=$(b+':cont')&&$(b+':cont').scrollHeight+c.ht-c.i_ht;if(c.eE)clearTimeout(c.eE);if(d){d=c.ht/d;if(d<1){var h=Math.max(16,Math.floor(c.ht*d));if($(b+':y')){if(c.jf!=h){$(b+':y').style.height=c.ht+'px';$(b+':ytr').style.height=(h-4)+'px';c.jf=h;c.S(true);o=false;}if(!o){$(b+':ytr').style.visibility='';}}else{$.append(a,'<div id="'+b+':y" class=s-'+c.gx+' style="height:'+c.i_ht+'px;" onselectstart=return(false)><div class=s-track id="'+b+':ytr" onmousedown=Fn.Div.scrY(this,"'+b+'") style="height:'+(h-4)+'px;"></div></div>');c.S(true);}}else{c.jf=null;if($(b+':ytr')){$(b+':ytr').style.visibility='hidden';}}}}if(c.wd!=null){d=$(b+':cont')&&$(b+':cont').scrollWidth+c.wd-c.i_wd;if(d){d=c.wd/d;if(d<1){var h=Math.max(16,Math.floor(c.wd*d));if($(b+':x')){if(c.fZ!=h){$(b+':x').style.width=c.wd+'px';$(b+':xtr').style.width=(h-4)+'px';c.fZ=h;c.aO(true);o=false;}if(!o){$(b+':xtr').style.visibility='';}}else{$.append(a,'<div id="'+b+':x" class=s-'+c.gx+'-x style="width:'+c.i_wd+'px;" onselectstart=return(false)><div class=s-track id="'+b+':xtr" onmousedown=Fn.Div.scrX(this,"'+b+'") style="width:'+(h-4)+'px;"></div></div>');c.aO(true);}}else{c.fZ=null;if($(b+':xtr'))$(b+':xtr').style.visibility='hidden';}}}c.eE=setTimeout(function(){Fn.Div.scrover(a,true)},900);},scrout:function(a,e){var b=a.id,c=Fn.Div._a[b];if(c.ht!=null&&!(e&&a.contains(e.toElement))){if($(b+':y')){if(c.gx!=='scroll')$(b+':ytr').style.visibility='hidden';}}if(c.wd!=null&&!(e&&a.contains(e.toElement))){if($(b+':x')){if(c.gx!=='scroll')$(b+':xtr').style.visibility='hidden';}}},scrY:function(a,b){var c=Fn.Div._a[b],d=$(c.id+':cont').scrollHeight+c.ht-c.i_ht,e=c.ht/d,f=c.ht-Math.max(16,Math.floor(c.ht*e)),t=js.m(a.style.top),g=d-c.ht,y=event.clientY;$.class_add($(c.id+':y'),'z-hv');$.e_moveup(a,function(){var h=Math.max(0,Math.min(t+event.clientY-y,f)),k=Math.max(0,Math.min(Math.ceil(h*g/f),g));a.style.top=h+'px';$(c.id+':cont').scrollTop=c.ju=k;},function(){if(!$(c.id).contains(event.srcElement))Fn.Div.scrout($(c.id),event);$.class_del($(c.id+':y'),'z-hv');});},scrX:function(a,b){var c=Fn.Div._a[b],d=$(c.id+':cont').scrollWidth+c.wd-c.i_wd,e=c.wd/d,f=c.wd-Math.max(16,Math.floor(c.wd*e)),t=js.m(a.style.left),g=d-c.wd,x=event.clientX;$.class_add($(c.id+':x'),'z-hv');$.e_moveup(a,function(){h=Math.max(0,Math.min(t+event.clientX-x,f)),k=Math.max(0,Math.min(Math.ceil(h*g/f),g));a.style.left=h+'px';$(c.id+':cont').scrollLeft=c.gi=k;},function(){if(!$(c.id).contains(event.srcElement))Fn.Div.scrout($(c.id),event);$.class_del($(c.id+':x'),'z-hv');});},scrwheel:function(a,e,c){var b=Fn.Div._a[a.id];if(b.ht!=null&&$(a.id+':y')){var d=$(b.id+':cont').scrollHeight+b.ht-b.i_ht,k=$(b.id+':cont').scrollTop+Math.floor(60*Math.log(Math.max(2.8,2*d/b.ht)))*(c>0?-1:1);b.fireEvent('wheel');b.S(k);$.e_cancel(e);}},scrresize:function(a){$.rm(a.id+':y');$.rm(a.id+':x');Fn.Div.scrover($(a.id));},scrdispose:function(a){clearTimeout(a.eE)},onscroll:function(a){if(a=Fn.Div._a[a]){if(Br.android){var t=$(a.id+':cont').scrollTop;a.S(t,true);if(a.jm)clearTimeout(a.jm);a.jm=setTimeout(function(){Fn.Div.scrout($(a.id))},700)}a.fireEvent('scroll');}},ontouchmove:function(a){if(a=Fn.Div._a[a]){if(a.jm)clearTimeout(a.jm);Fn.Div.scrover($(a.id));}},bindScroll:function(a,b){var p=a;while(p&&!(p.ht!=null&&p.gx&&p.gx!=='hidden'))p=p.parentNode;if(p){p.addEvent('scroll',b);p.addEvent('wheel',b);var c=p,d;while(c=c.parentNode){if(d=c.dialogId){Fn.Dialog.get(d).addEvent('move',b,p);break;}}a.addEvent('remove',function(){this.removeEvent('scroll',b);this.removeEvent('wheel',b);if(d)Fn.Dialog.get(d).removeEvent('move',b,this);},p);}},resumeScroll:function(a){if($.class_any(a.$(),'s-area')){Fn.Div._a[a.id].S(true);}else{var b=$.query('.s-area',a.$()),i=b.length;while(i--)Fn.Div._a[b[i].id].S(true);}if(!Br.cmp){var b=Q('.ps-fix',a.$());b.addClass('none');setTimeout(function(){b.removeClass('none');});}},scrollLock:function(a){var b,c,d,n,m,e,f=false;Fn.Div.bindScroll(a,function(){if(b===undefined)b=js.m(a.$().currentStyle.marginTop);if(c===undefined)c=a.$().style.height;n=f&&d?$.bcr(d):$.bcr(a.$());m=$.bcr(this.$());e=n.height-this.ht;f=e>0?n.bottom<m.bottom:n.top<m.top;if(f){if(!d){d=a.$().cloneNode(false);d.style.height=a.$().offsetHeight+'px';d.style.position='';d.style.visibility='hidden';d.id=a.id+':pad';$.before(a.$(),d);}}else{if(d)$.rm(d),d=null;}a.$().style.top=f?(m.top-b)+'px':'';a.$().style.left=f?n.left+'px':'';a.$().style.position=f?'fixed':'';if(e>0){a.$().style.height=f?m.height+'px':c;a.$().scrollTop=f?e:0;}});}},Prototype:{level:0,vis:false,bA:'',ib:false,$:function(a){return this.ww?this.ww.document.getElementById(this.id+(a?':'+a:'')):$(this.id+(a?':'+a:''))},data:function(a,b){if(arguments.length==0)return this.vis?this.innerHTML:this.bA;if(this.vis){$.html($(this.id+':cont')||$(this.id),this.hn?this.hn.head+a+this.hn.foot:a,b);}else{if(b!=null){b=b.toLowerCase();if(b.indexOf('end')>0)this.bA+=a;else this.bA=a+this.bA;}else this.bA=a;}return this;},resize:function(a,b){if((a==null&&b==null)||(a===this.wd&&b===this.ht)){}else{var c,d;if(a!=null){c=a;if(a<0){this.wd=this.i_wd=null;}else{this.i_wd=a-this.pad_hrz;this.last_wd=this.wd;this.wd=a;}}if(b!=null){d=b;if(b<0){this.ht=this.i_ht=null;}else{this.i_ht=b-this.pad_vrt;this.last_ht=this.ht;this.ht=b;}}if(!this.vis||(c==null&&d==null))return;var r=this.ay||this.gx==='miniscroll';if(c!=null){c=c<0?'auto':Math.max(0,a-(this.pad_hrz-(this.ay?Br[this.gx]:0)))+'px';$(this.id).style.width=c;if(r)$(this.id+':cont').style.width=c;if(this.a_ht&&$(this.id+':valve'))$(this.id+':valve').style.width=c;}if(d!=null){d=d<0?'auto':Math.max(0,b-this.pad_vrt)+'px';$(this.id).style.height=d;if(r)$(this.id+':cont').style.height=d;if(this.a_wd&&$(this.id+':valve'))$(this.id+':valve').style.height=d;}if(!this.aA){if(a===0||b===0){this.H=true;this.$().style.visibility='hidden';}else{if(this.H){this.H=null;this.$().style.visibility='';}}}}if(!this.length){this.fireEvent('resize');if(Br.chm&&this.parentNode&&this.nodeIndex===this.parentNode.length-1){Q('.ps-fix').addClass('none');setTimeout(function(){Q('.ps-fix').removeClass('none');});}}},set_prop:function(a,b,c,d){var e=this.$();if(e){if(a)for(var i in a)e[i]=a[i];if(b)for(var i in b)e.style[i]=b[i];}else{this.attr=a;this.css=b;}if(c!=null&&this.ht!=null){this.i_ht=this.ht-c;if(e)e.style.posHeight=this.i_ht;}if(d!=null&&this.wd!=null){this.i_wd=this.wd-d;if(e)e.style.posWidth=this.i_wd;}},opt:function(a){if(this.ib)js.clone(this.ib,a);else this.ib=a;},html:function(){var w=this.i_wd+(this.ay?Br[this.gx]:0),a=this.wd!=null?'width:'+w+'px;':'',d=this.attr,p=this.parentNode,r=this.ay||this.gx==='miniscroll',s='';if(this.ht!=null)a+='height:'+this.i_ht+'px;';if(r){var e=this.wd!=null?'width:'+this.i_wd+'px;':'';if(this.ht!=null)e+='height:'+this.i_ht+'px;';d=Fn.Div.addClass(d,'s-area');s='<div id="'+this.id+':cont" onscroll=Fn.Div.onscroll("'+this.id+'")'+(Br.android?' ontouchmove=Fn.Div.ontouchmove("'+this.id+'")':'')+' class="relative clearfix" style="'+(Br.mobile?'overflow:auto;-webkit-overflow-scrolling:touch;height:'+this.i_ht+'px;':e+'overflow:hidden;')+'">';}else{a+='overflow:hidden;';}if(p){if(p.bcol){if((!Cfg.plus&&Br.css3)||p.type_flow)d=Fn.Div.addClass(d,'ln-top');else a+='float:left;';}if('fw' in p){if(this.nodeIndex!=p.gz)a+='display:none;';}}if(this.jx)d+=' align='+this.jx;if((this.i_ht===0||this.i_wd===0)&&!this.aA){a+='visibility:hidden;';this.H=true;}if(this.aA){var u='cursor:'+(this.a_wd&&this.a_ht?(p.bcol?'col':'row'):(this.a_wd?'col':'row'))+'-resize;';s+='<div id='+this.id+':valve class=absolute style="margin-left:-1px;z-index:1;width:'+Math.max(w,4)+'px;'+(this.ht!=null?'height:'+this.i_ht+'px;':'')+u+'">';a+='overflow:visible;'+u;d+=' onmousedown=Fn.Div.valve(this)';}if(this.gx&&this.gx!=='hidden'){d+=' onmousewheel=Fn.Div.scrwheel(this,event,event.wheelDelta) onmouseover=Fn.Div.scrover(this) onmouseout=Fn.Div.scrout(this,event)';if(Br.fox){var self=this;Fn.Div.addOnRender(this,function(){self.$().addEventListener('DOMMouseScroll',function(e){Fn.Div.scrwheel(self,event,-e.detail);},false);});}this.addEvent('resize','Fn.Div.scrresize(this)');this.addEvent('remove','Fn.Div.scrdispose(this)');if(this.gx==='scroll')Fn.Div.addOnRender(this,'Fn.Div.scrover($("'+this.id+'"))');}this.vis=true;var b=['<div id="'+this.id+'" style="'+a+this.css+'" '+d+'>'+(this.hn?this.hn.head:'')];if(s)b.push(s);for(var i=0;i<this.length;i++){if(!this[i].vis)b.push(this[i].html());}if(i===0&&!Br.css3&&p&&p.bcol&&this.ht==null&&!this.bA){b.push('&nbsp;');}b=b.join('')+(this.bA||'')+(this.hn?this.hn.foot:'');if(r)b+='</div>';if(this.aA)b+='</div>';b+='</div>';return this.ib.wrap?this.ib.wrap(b):b;},render:function(a,b,c){if(c){this.vis=false;$.rm(this.$());}if(this.vis)return this;if(a){$.html(a,this.html(),b);}else{var c=this.parentNode,d=c&&this.nodeIndex===c.length-1;if(!c)return this.render(this.ww?this.ww.document.body:$.db());if(c.vis)$.html(d?($(c.id+':cont')||$(c.id)):c[this.nodeIndex+1].$(),this.html(),d?'beforeEnd':'beforeBegin');else c.render();c=null;}this.fireEvent('render');return this;},scrollTop:function(a,b){if(!$(this.id+':cont'))return;if(a==null)return $(this.id+':cont').scrollTop;if(this.ht==null)return;if(!self._disposed)this.S(a,b);},S:function(a,b){var c=$(this.id+':cont').scrollHeight;if(c===0){if(a!==true)this.ju=a;return;}if(a===true){a=this.ju;if(a===undefined)a=$(this.id+':cont').scrollTop;}if(a===false)a=c;if(typeof a==='string'){if(a.charAt(0)==='+')a=$(this.id+':cont').scrollTop+parseFloat(a.slice(2));else if(a.charAt(0)==='-')a=$(this.id+':cont').scrollTop-parseFloat(a.slice(2));else a=js.m(a);}this.fixScrollY(a,c,b);},fixScrollY:function(a,c,b){a=a==null?$(this.id+':cont').scrollTop:a;c=c==null?$(this.id+':cont').scrollHeight:c;var d=c+this.ht-this.i_ht,e=this.ht/d,f=this.ht-Math.max(16,Math.floor(this.ht*e)),g=js.m_rng(a,0,d-this.ht);if(e<1&&$(this.id+':y')){$(this.id+':ytr').style.top=t=Math.max(0,Math.min(g*f/(d-this.ht),f))+'px';}if(!b)$(this.id+':cont').scrollTop=this.ju=g},scrollLeft:function(a,b){if(!$(this.id+':cont'))return;if(a==null)return $(this.id+':cont').scrollLeft;if(this.wd==null)return;if(!self._disposed)this.aO(a,b);},aO:function(a,b){var c=$(this.id+':cont').scrollWidth;if(c===0){if(a!==true)this.gi=a;return;}if(a===true){a=this.gi;if(a===undefined)a=$(this.id+':cont').scrollLeft;}if(a===false)a=c;if(typeof a==='string'){if(a.charAt(0)==='+')a=$(this.id+':cont').scrollLeft+parseFloat(a.slice(2));else if(a.charAt(0)==='-')a=$(this.id+':cont').scrollLeft-parseFloat(a.slice(2));else a=js.m(a);}this.fixScrollX(a,c,b);},fixScrollX:function(a,c,b){a=a==null?$(this.id+':cont').scrollLeft:a;c=c==null?$(this.id+':cont').scrollWidth:c;var d=c+this.wd-this.i_wd,e=this.wd/d,f=this.wd-Math.max(16,Math.floor(this.wd*e)),g=js.m_rng(a,0,d-this.wd);if(e<1&&$(this.id+':x')){$(this.id+':xtr').style.left=t=Math.max(0,Math.min(g*f/(d-this.wd),f))+'px';}if(!b)$(this.id+':cont').scrollLeft=this.gi=g},scrollIntoView:function(a){if($(this.id+':cont')){var b=$.bcr(this.$()),c=$.bcr(a),d=c.bottom>b.bottom?c.bottom-b.bottom+b.height/2:c.top<b.top?c.top-b.top-b.height/2:0;this.scrollTop($(this.id+':cont').scrollTop+d);}else{var p=this;while(p=p.parentNode){if($(p.id+':cont')){p.scrollIntoView(a);break;}}}},remove:function(a){if(this._disposed)return;if(this.isGlobal){var d=Fn.Div.jw||(Fn.Div.jw=$.db('<div class=hide></div>'));d.appendChild(this.$());this.popNode();return;}this.fireEvent('remove');for(var i=this.length-1;i>-1;i--)this[i].remove(true);var r;if(!a){var c=this.parentNode;if(c&&c.type_set){var d=this.nodeIndex,e=d==c.length-1?d-1:d+1,f=c.ssca.split(',');if(f.length>2&&f[e]){f[e]=c.scales[d]+c.scales[e];f.splice(d,1);r=f.join();}else r='*';}if(this.parentNode&&this.parentNode.pop)return this.parentNode.pop(this);if(this.$())this.$().parentNode.removeChild(this.$());}this.dispose();return r;},dispose:function(){if(this._disposed)return;if(this.eE)clearTimeout(this.eE);delete Fn.Div._a[this.id];this.removeNode();}}});Fn.fW('DivSet',{Const:function(a,b,c,d,e,f,g){Fn.DivItem.call(this,b,c,d,e,f,g);this.type=js.s_to(a,'=');this.ssca=js.s_fr(a,'=');this.bcol=this.type==='cols';this.scales=js.m_scale(this.bcol?this.i_wd:this.i_ht,this.ssca);this.type_set=true;},Extend:[Fn.Div],Helper:{resep:function(a,b,c,d){if(b){if(a){a.resize(null,null,a.type+'='+(b||a.ssca),d);if(Fn.Tree)Fn.Tree.Drag.reset();}}}},Prototype:{addNode:function(a,b,c,d){var e=b!=null&&d&&this[b],o=js.hu.call(this,a,b);if(this.ww)o.ww=this.ww;o.level=this.level+1;if(c){if(a.vis){$.append(this.$(),a.$(),b);if(e)e.remove();a.resize(this.aV(a.nodeIndex),this.aU(a.nodeIndex));}else{if(e)e.remove();a.render();}}else{if(e)e.remove();}return o;},aV:function(a){return this.type_set?(this.bcol?this.scales[a]:this.i_wd):(this.type_flow?(this.bcol?null:this.i_wd):this.i_wd);},aU:function(a){return this.type_set?(this.bcol?this.i_ht:this.scales[a]):(this.type_flow?(this.bcol?this.i_ht:null):this.i_ht);},add:function(a,b,c,d,e,f){if(f==null)f=this.length;return this.addNode(new Fn.Div(this.aV(f),this.aU(f),a,b,c,d,e),f);},addset:function(a,b,c,d,e,f){if(f==null)f=this.length;return this.addNode(new Fn.DivSet(a,this.aV(f),this.aU(f),b,c,d,e),f);},addfilm:function(a,b,c,d,e){if(e==null)e=this.length;return this.addNode(new Fn.DivFilm(this.aV(e),this.aU(e),a,b,c,d),e);},addflow:function(a,b,c,d,e,f,g,h){if(h==null)h=this.length;return this.addNode(new Fn.DivFlow(a,this.aV(h),this.aU(h),b,c,d,e,f,g),h);},addmod:function(a,b,c,d,e,f,g,h,i){if(h==null)h=this.length;var o=this.addNode(new Fn.DivMod(a,b,d,this.bcol?null:this.i_wd,c,e,f,g,h),i);if(!d)Fn.Div.addOnRender(o,o.render,o);return o;},additem:function(a,b){if(b==null)b=this.length;if(a.$()){if(this.vis){if(this[b]){(this.$('cont')||this.$()).insertBefore(a.$(),this[b].$());}else(this.$('cont')||this.$()).appendChild(a.$());a.resize(this.aV(b),this.aU(b));}else{Fn.Div.addOnRender(this,function(){if(this[b+1]){(this.$('cont')||this.$()).insertBefore(a.$(),this[b+1].$());}else(this.$('cont')||this.$()).appendChild(a.$());a.resize(this.aV(b),this.aU(b));},this);}}this.addNode(a,b);},resize:function(a,b,c,d){if(c){var t=this.type;this.type=js.s_to(c,'=');this.ssca=js.s_fr(c,'=');this.bcol=this.type==='cols';if(!d&&t!==this.type){for(var i=0;i<this.length;i++)$.css(this[i].$(),'float',this.bcol?'left':'');}}if(!c&&((a==null&&b==null)||(a===this.wd&&b===this.ht))){}else{var d=this.rsz_dr,e=this.scales,f=this.bcol?a-this.wd:b-this.ht;if(d&&e.length>1){if((d.indexOf('l')>-1&&this.bcol)||(d.indexOf('t')>-1&&!this.bcol)){for(var i=0;i<e.length;i++){e[i]+=f;if(e[i]==null){f=0-e[i];e[i]=0;}else break;}if(this[0])this[0].rsz_dr=d;e[e.length-1]='*';}if((d.indexOf('r')>-1&&this.bcol)||(d.indexOf('b')>-1&&!this.bcol)){for(var i=e.length-1;i>-1;i--){e[i]+=f;if(e[i]==null){f=0-e[i];e[i]=0;}else break;}e[0]='*';if(this[e.length-1])this[e.length-1].rsz_dr=d;}this.ssca=e.join();}Fn.Div.prototype.resize.call(this,a,b);e=js.m_scale(this.bcol?this.i_wd:this.i_ht,this.ssca);if(this.scales.length>e.length){for(var i=this.scales.length-1;i>=e.length;i--)if(this[i])this[i].remove();}this.scales=e;for(var i=0,l=this.length;i<l;i++){if(this.bcol)this[i].resize(this.scales[i],this.i_ht);else{this[i].resize(this.i_wd,this.scales[i]);}}}this.fireEvent('resize');if(this.rsz_dr)this.rsz_dr=null;},set_prop:function(a,b,c,d,e){if(a!=null||b!=null||c!=null||d!=null)Fn.Div.prototype.set_prop.apply(this,arguments);if(e)this.ssca=e;this.scales=js.m_scale(this.bcol?this.i_wd:this.i_ht,this.ssca);}}});Fn.fW('DivFlow',{Const:function(a,b,c,d,e,f,g,h,i){Fn.DivItem.call(this,b,c,d,e,f,g,h);if(a)this.bcol=a;if(i)this.jx=i;this.type_flow=true;},Extend:[Fn.DivSet],Prototype:{resize:function(a,b){if((a==null&&b==null)||(a===this.wd&&b===this.ht)){}else{Fn.Div.prototype.resize.call(this,a,b);for(var i=0;i<this.length;i++)this[i].resize(this.bcol?null:this.i_wd,this.bcol?this.i_ht:null);}this.fireEvent('resize');}}});Fn.fW('DivFilm',{Const:function(a,b,c,d,e,f){Fn.DivItem.call(this,a,b,c,d,e,f);this.fw={};this.type_film=true;},Extend:[Fn.DivSet],Helper:{closest:function(a,b){do{if(a.parentNode&&a.parentNode.type_film){if(b===false){if(a.parentNode.gz!==a.nodeIndex)return a}else if(b===true){if(a.parentNode.gz===a.nodeIndex)return a}else return a}}while(a=a.parentNode)}},Prototype:{gz:null,addNode:function(a,b,c){var p=a.parentNode,e,o;if(p&&p.type_film&&p!==this){for(var i in p.fw)if(p.fw[i]===a){delete p.fw[i];e=i;break;}}o=Fn.DivSet.prototype.addNode.call(this,a,b,c);if(e)this.setpk(o,e);return o;},setdefault:function(a){if(this.bF!=null){this[this.bF].remove();if(this.gz==this.bF)this.gz=null;this.bF=0;}return this.gz=this.bF=typeof a==='object'?a.nodeIndex:a;},setpk:function(a,b){if(b==null)b=a.nodeIndex;if(this.fw[b]){return this.pop(this.fw[b],a);}return this.fw[b]=a;},get:function(a){if(typeof a==='number'){var b=this.hZ;b=this.fw[b];return this[b&&a>=b.nodeIndex?a+1:a];}return this.fw[a];},resize:function(a,b){if((a==null&&b==null)||(a===this.wd&&b===this.ht)){}else{Fn.Div.prototype.resize.call(this,a,b);var c=this[this.gz||0];for(var i=0;i<this.length;i++){if(c==this[i]){c.resize(this.i_wd,this.i_ht);this.view(c);}else{this[i].cq=true;}}}this.fireEvent('resize');},view:function(a){if(typeof a!=='object')a=this.get(a);if(a.cq){a.resize(this.i_wd,this.i_ht);delete a.cq;}a.fireEvent('beforeview');this.fireEvent('beforeview');if(this.vis){for(var i=0,d=a.nodeIndex,l=this.length;i<l;i++){if(this[i].$())this[i].$().style.display=i==d?'':'none';}}this.gz=a.nodeIndex;if(!a.vis)a.render();Fn.Div.resumeScroll(a);a.fireEvent('view');this.fireEvent('view');return this[this.gz];},viewdefault:function(a){if(this.bF!=null&&this.gz!=this.bF)this.view(this.bF);},pop:function(a,b){if(typeof a=='number')a=this[a];a.remove(true);a.$().removeNode(true);for(var k in this.fw){if(this.fw[k]==a){if(b)this.fw[k]=b;else delete this.fw[k];break;}}if(!this.length)this.gz=null;if(b){if(this.gz!=b.nodeIndex)this.gz=b.nodeIndex;return this.addNode(b);}}}});Fn.fW('DivMod',{Const:function(a,b,c,d,e,f,g,h,i){Fn.DivItem.call(this,d,e,f,g,h,i);this.head=a;this.foot=b;this.fh=c;this.fw={};this.id=Fn.Div.g_id();Fn.Div._a[this.id]=this;this.type_mod=true;},Helper:{},Extend:[Fn.DivSet],Prototype:{gz:0,addset:function(){var a=Fn.DivFilm.prototype.addset.apply(this,arguments);a.level++;return a;},html:function(){if(this.fh){this.vis=true;var s=['<div id="'+this.id+'"'+(this.attr?' '+this.attr:'')+(this.css?' style="'+this.css+'"':'')+'>'+this.head];for(var i=0;i<this.length;i++){s.push(this[i].html());}s=s.join('')+this.foot+'</div>';return this.ib.wrap?this.ib.wrap(s):s;}return '';},resize:function(w,h){for(var i=0;i<this.length;i++){this[i].resize(this.i_wd+(w-this.wd),null);}},plusHeight:function(a){for(var i=0,l=this.length;i<l;i++){this[i].resize(null,this[i].ht+a);}this.ht+=a;this.i_ht+=a;},fo:function(a){var q=this.parentNode;do{var r=q.parentNode;if(r&&r.fw&&r.vis){for(var i=0,d;i<r.length;i++){if(r[i].$())r[i].$().style.display=a?(i==q.nodeIndex?'':'none'):(i==r.gz?'':'none');}}}while(q=q.parentNode);},render:function(a,b){if(this._disposed||this.vis)return this;if(!this.head)return Fn.Div.prototype.render.apply(this,arguments);var p=this.parentNode;$.html(p.$(),'<div id="'+this.id+'"'+(this.attr?' '+this.attr:'')+(this.css?' style="'+this.css+'"':'')+'>'+this.head+'<div id="'+this.id+'-cont" class="clearfix"><hr width=100%></div>'+this.foot+'</div>',this.nodeIndex);this.i_wd=this.$('cont').offsetWidth;if(!this.i_wd){this.fo(true);var d=this.$('cont').offsetWidth;if(!d){var c=this.$('cont').parentNode.parentNode,d=$.boxwd(c)-(Br.cmp?this.$('cont').offsetLeft-c.offsetLeft:this.$('cont').getBoundingClientRect().left-c.getBoundingClientRect().left);}this.i_wd=d;this.fo(false);}for(var i=0,s=[];i<this.length;i++){this[i].resize(this.i_wd,null);s.push(this[i].html());}this.$('cont').innerHTML=s.join('');this.vis=true;this.fireEvent('render',this.wd-this.i_wd,this.ht-this.i_ht);return this;}}}); ﻿Fn.fW('TreeItem',{Const:function(x,a){this.xml=x;this.id=Fn.Tree.getId();this.pk=x.getAttribute('pk')||this.id;this.tree=a;a.add(this);if(a=this.attr('op'))this.open=a==1;},Extend:[Fn.EventNode],Prototype:{vis:false,open:false,$:function(a,b,c){return arguments.length>1?$.append(this.$(a),b,c):$(this.id+(a?'-'+a:''));},add:function(a,b,c){if(!a)return;if(b!=null&&this[b]==a){return;}if(a.vis)a.remove(true);this.addNode(a,b);var l=this.length;if(!this.vis)c=true;if(!c){if(a.nodeIndex==l-1&&l>=2){var e=this[l-2].$('plus');if(e)e.src=this[l-2].plusIco();}if(b==null||!this[b+1])this.$('cont',a.html());else this[b+1].$('',a.html(),'beforeBegin');a.fireEvent('render');if(!this.folder){this.folder=true;this.toggle(this.level<0);}this.indent();}return a;},attr:function(a,b){if(arguments.length===2){if(this.xml)this.xml.setAttribute(a,b);if(this.vis){switch(a){case 't':if(this.xml.getAttribute('alt')==='1')this.$('t').title=b;if(this.$('t'))this.$('t').innerHTML=b;break;case 'ic':case 'oic':if(this.$('ic'))this.$('ic').src=this.attr(this.open?'oic':'ic');break;case 'bc':var c=this.$('bx');if(c){if(c.type==='checkbox')c.checked=b==1;else return Fn.Tree.aS(this,b);}break;}}}else{b=this.xml.getAttribute(a)||this.tree.bF[a];if(b)return b;switch(a){case 'ic':return Fn.Tree[this.level<0?'rootIcon':(this.folder?'folderIcon':'fileIcon')];break;case 'oic':return(this.xml.getAttribute('ic')||this.tree.bF['ic'])||Fn.Tree[this.level<0?'openRootIcon':((this.length||(this.src&&!this.loaded))?'openFolderIcon':'fileIcon')];break;}return '';}},toggle:function(a){if(a==null)a=!this.open;if(this.length){if(this.$('ic')){var ic=this.attr('ic'),oic=this.attr('oic');if(ic.charAt(0)==='.'&&ic.indexOf('/')<0){ic=ic.replace(/\./g,'');oic=oic.replace(/\./g,'');$.class_replace(this.$('ic'),a?ic:oic,a?oic:ic);}else this.$('ic').src=a?oic:ic;}if(this.$('cont'))this.$('cont').style.display=a?'block':'none';this.open=a;$.class_add(this.$(),'tree-open',!a);if(this.$('plus'))this.$('plus').src=this.plusIco();}},toggleAll:function(a){this.toggle(a);for(var i=0;i<this.length;i++)this[i].toggleAll(a);},indent:function(lvl,del,last,level,nodesLeft){if(lvl==null)lvl=-2;var state=0;for(var i=this.length-1;i>=0;i--){state=this[i].indent(lvl+1,del,last,level);if(state)return;}if(del){if(level>=this.level&&this.$('plus')){if(this.folder){this.$('plus').src=(this.open)?Fn.Tree.lMinusIcon:Fn.Tree.lPlusIcon;}else if(nodesLeft){this.$('plus').src=Fn.Tree.lIcon;}return 1;}}if(this.$('indent-'+lvl)){var foo=this.parentNode;for(var i=0;i<lvl;i++)foo=foo.parentNode;this.$('indent-'+lvl).src=(foo.nodeIndex==foo.parentNode.length-1)||((del)&&(last))?Fn.Tree.blankIcon:Fn.Tree.iIcon;}return 0;},g_next:function(){if(!this.parentNode)return null;var i=this.nodeIndex;if(i===this.parentNode.length-1){return this.parentNode.g_next();}else{return this.parentNode[i+1];}},g_prev:function(b){if(!this.parentNode)return null;var i=this.nodeIndex;if(i===0){return this.parentNode;}else{if((this.parentNode[--i].open)||(b&&this.parentNode[i].folder)){return this.parentNode[i].g_last();}else{return this.parentNode[i];}}},g_last:function(){var i=this.length-1;if(this[i].open){return this[i].g_last();}else{return this[i];}},getPath:function(){var s=[],n=this;do{s.push(n.xml.getAttribute('pk'))}while(n=n.parentNode);s.reverse();return s.join('/');},plusIco:function(){if(this.tree.face==='favor')return '';var s=((this.length||(this.src&&!this.loaded))?((this.open)?((this.nodeIndex==this.parentNode.length-1)?Fn.Tree.lMinusIcon:Fn.Tree.tMinusIcon):((this.nodeIndex==this.parentNode.length-1)?Fn.Tree.lPlusIcon:Fn.Tree.tPlusIcon)):((this.nodeIndex==this.parentNode.length-1)?Fn.Tree.lIcon:Fn.Tree.tIcon));if(this.tree.face==='normal'){s=s.indexOf('us.')>0?s.replace(/\/[TL]/,'/'):Fn.Tree.blankIcon;}return s;},showRightButton:function(){if(this.bo){$.toggle(this.bo,true);}else{var a=js.parseJSON(this.attr('x'));for(var i=0,s=[];i<a.length;i++){s.push($.htm.ic(a[i].ic,js.s_printx(a[i].clk,this.xml,true),'li'));}this.bo=$.append(this.$(),'<ul class="tree-cmd nobr">'+s.join('')+'</ul>');}},hideRightButton:function(){if(this.bo)$.toggle(this.bo,false);},checkBox:function(a){if(this.$('bx'))this.$('bx').checked=a==null?true:!!a;},isBoxChecked:function(a){return this.$('bx')?this.$('bx').checked:null;},renew:function(outs,ins,fn,bLow){var c=this.$('cont');if(typeof fn==='string'){var fld=fn;fn=function(m,n){return m.attr(fld)<n.attr(fld)?-1:1};}if(!bLow&&c&&Br.cmp){c.parentNode.removeChild(c);if(outs){for(var i=0,l=outs.length;i<l;i++){outs[i].$get(c).removeNode(true);outs[i].$get(c,'cont').removeNode(true);outs[i].dispose();}}if(ins){for(var i=0,l=ins.length,s=[];i<l;i++){this.add(ins[i],null,true);s.push(ins[i].html());}$.append(c,s.join(''));s.length=0;}if(fn){var a=fn;if(typeof fn==='function'){a=js.map(this);a.sort(fn);}for(var i=0,l=a.length,e,f;i<l;i++){e=a[i].$get(c);f=e.nextSibling;c.insertBefore(f,c.children[i*2]);c.insertBefore(e,c.children[i*2]);$.class_del(e,'z-hv');this.addNode(a[i],i);}}this.$().parentNode.insertBefore(c,this.$().nextSibling);}else{if(outs){var i=outs.length;while(i--)outs[i].remove();}if(ins){for(var i=0,l=ins.length;i<l;i++){this.add(ins[i]);}}if(fn){var a=fn;if(typeof fn==='function'){a=js.map(this);a.sort(fn);}for(var i=0,l=fn.length;i<l;i++)this.add(a[i],i);}}},click:function(){Fn.Tree.clk(this);},focus:function(){this.tree.addsel(this);},$get:function(a,b){return $.get('[id="'+this.id+(b?'-'+b:'')+'"]',a)},html:function(a){if(this.length)this.folder=1;var s,face=this.tree.face,favor=face==='favor',ps=this.attr('ps');this.level=this.parentNode.level+1;if(ps){var c=this.attr('clz'),d=VM(this.tree.vmid).x('parsers/*[@id="'+ps+'"]');s='<div id='+this.id+' class="tree tree-ps clearfix'+(this.open?' tree-open':'')+(c?' '+c:'')+(this.ds?' z-ds':'')+'" ondblclick=Fn.Tree.dbl(this) onclick=Fn.Tree.clk(this,event) onmouseover=Fn.Tree.over(this) onmouseout=Fn.Tree.out(this)>';if(d){if(d.getAttribute('type')==='js'){s+=eval('('+js.s_trim(d.text)+').call( this,this.xml)');}else s+=VM.iH(d.text,this.xml);}s+='</div>';}else{if(face==='normal-line'){var f=this,g='',i=0;while(f.parentNode.parentNode){f=f.parentNode;g='<img id='+this.id+'-indent-'+i+' src='+((f.nodeIndex==f.parentNode.length-1)?Fn.Tree.blankIcon:Fn.Tree.iIcon)+'>'+g;i++;}s='<div id='+this.id+' class="tree'+(this.ds?' z-ds':'')+'" ondblclick=Fn.Tree.dbl(this) onmouseover=Fn.Tree.over(this) onmouseout=Fn.Tree.out(this)>'+g+'<img id='+this.id+'-plus src='+this.plusIco()+' onclick="Fn.Tree.toggle(this,event)">';}else{var f,c=this.attr('clz');var ic=this.plusIco(),pd=0;if(favor){pd+=5;if(this.tree.hideroot!=1)pd+=14;}s='<div id='+this.id+' ondblclick=Fn.Tree.dbl(this) onclick=Fn.Tree.clk(this,event) onmouseover=Fn.Tree.over(this) onmouseout=Fn.Tree.out(this) class="tree'+(c?' '+c:'')+(this.ds?' z-ds':'')+'"><a class=tree-a id='+this.id+'-anc href=javascript: style=padding-left:'+(this.level*14+pd)+'px hidefocus';if(this.attr('on')==1)s+=Fn.Tree.cO(this);s+='><i class=va-i></i>';if(ic)s+='<img id='+this.id+'-plus src='+ic+' onclick=Fn.Tree.toggle(this,event)>';}if(f=this.xml.getAttribute('bn')||this.tree.bF['bn']){g=this.attr('bc');i=this.attr('bv');u=this.attr('bds')==1;var h=this.attr('br')==1;if(i||this.tree.bxro)s+='<input type='+(this.tree.bxro?'radio':'checkbox')+' style=vertical-align:middle;margin-left:'+(Br.ie?-2:2)+'px id='+this.id+'-bx name='+f+(h?' readonly':'')+' value='+(this.tree.bxro?this.attr('bv'):i)+(g==1?' checked':'')+'>';else s+='<span class="b'+(js.m(g)+(h?3:0))+'" id='+this.id+'-bx><input type=hidden id='+this.id+'-hd name='+f+' value='+g+'></span>';}f=this.xml.getAttribute('t')||this.attr('t');var ic=(this.open?this.attr('oic'):(this.xml.getAttribute('ic')||this.tree.bF['ic']||Fn.Tree[this.folder||(this.src&&!this.loaded)?'folderIcon':'fileIcon'])),cc=ic.charAt(0)==='.'&&ic.replace(/\./g,'');s+='<img id='+this.id+'-ic class="tree-ic'+(cc?' '+cc:'')+'" src='+(cc?$.htm.dot:ic);s+='><span class=tree-t id='+this.id+'-t';var alt=this.xml.getAttribute('alt')||this.attr('alt');if(alt==='1')alt=f;if(alt)s+=' title="'+js.s_quot(alt)+'"';s+='>'+f+'</span></a></div>';}if(this.open&&this.src&&!this.loaded)this.tree.hb(this.src,this);this.vis=true;if(a)return s;s+='<div id='+this.id+'-cont class=tree-cont style="display: '+(this.open?'block':'none')+';">';g=this.length;if(g){for(i=0,s=[s];i<g;i++)s.push(this[i].html());s.push('</div>');return s.join('');}return s+'</div>';},remove:function(a){if(this._disposed)return;var pn=this.parentNode,ind=this.nodeIndex;this.fY(a);var l=pn.length;if(!l){if(pn.$('cont'))pn.$('cont').style.display='none';pn.toggle(false);pn.folder=false;pn.open=false;$.class_del(pn.$(),'tree-open');}if(ind==l)pn.indent(null,true,true,this.level,l);if(!l){pn.folder=false;pn.open=false;$.class_del(pn.$(),'tree-open');if(pn.$('plus'))pn.$('plus').src=pn.plusIco();}if(l){if(ind){var o=pn[ind-1];if(o.$('plus'))o.$('plus').src=o.plusIco();}}},fY:function(a){if(!a){for(var i=this.length-1;i>=0;i--)this[i].fY();}else{var p=this.parentNode;if(p){for(i=this.nodeIndex,l=p.length-1;i<l;i++)(p[i]=p[i+1]).nodeIndex=i;p.length--;delete p[i];}delete this.parentNode;}var p=this.$();if(p)$.rm(p);if(p=this.$('cont'))$.rm(p);if(!a)this.dispose();},dispose:function(){if(this._disposed)return;for(var i=this.length-1;i>=0;i--)this[i].dispose();this.tree.del(this);this.tree=this.xml=this.id=this.pk=null;delete this.tree;delete this.xml;delete this.id;delete this.pk;this.removeNode();}}});Fn.fW('Tree',{Const:function(x,a){Fn.TreeItem.call(this,x,a);},Extend:[Fn.TreeItem],Prototype:{folder:true,open:true,level:-1,remove:function(){if(this.$())$.rm(this.$());if(this.$('cont'))$.rm(this.$('cont'));js.remove(this.tree.gp,this);this.dispose();},html:function(a,z){var b=this.xml.getAttribute('bn')||this.tree.bF['bn'],e=this.attr('clz'),c='<div id='+this.id+' ondblclick=Fn.Tree.dbl(this) onclick=Fn.Tree.clk(this,event) onmouseover=Fn.Tree.over(this) onmouseout=Fn.Tree.out(this) class="tree'+(this.open?' tree-open':'')+(e?' '+e:'')+(this.ds?' z-ds':'')+(this.tree.hideroot==1?' none':'')+'"><a class=tree-a id='+this.id+'-anc href=javascript: hidefocus';if(this.attr('on')==1)c+=Fn.Tree.cO(this);c+='>';if(b){var d=this.attr('bc'),i=this.attr('bv'),h=this.attr('br')==1;if(i||this.tree.bxro)c+='<input type='+(this.tree.bxro?'radio':'checkbox')+' style=vertical-align:middle;margin-left:'+(Br.ie?-2:2)+'px id='+this.id+'-bx name='+b+(h?' readonly':'')+' value='+(this.tree.bxro?this.attr('bv'):i)+(d==1?' checked':'')+'>';else c+='<span class="b'+(js.m(d)+(h?3:0))+'" id='+this.id+'-bx><input type=hidden id='+this.id+'-hd name='+b+' value='+d+'></span>';}b=this.xml.getAttribute('t')||this.attr('t');if(z&&this.length){c+='<img id='+this.id+'-plus src='+this.plusIco()+' onclick=Fn.Tree.toggle(this)>';}c+='<img id='+this.id+'-ic class=tree-ic src="'+(this.open?this.attr('oic'):Fn.Tree.rootIcon)+'">';c+='<span class=tree-t id='+this.id+'-t>'+b+'</span></a></div>';this.vis=true;if(a){return c;}c+='<div id='+this.id+'-cont class=tree-cont style="display: '+(this.open?'block':'none')+';">';g=this.length;if(g){for(var i=0,c=[c];i<g;i++)c.push(this[i].html());c.push('</div>');return c.join('');}return c+'</div>';}},Helper:{rootIcon:Cfg.imgp+'t/root.gif',openRootIcon:Cfg.imgp+'t/root.gif',folderIcon:Cfg.imgp+'t/folder.png',openFolderIcon:Cfg.imgp+'t/openfolder.png',fileIcon:Cfg.imgp+'t/file.png',iIcon:Cfg.imgp+'t/I.gif',lIcon:Cfg.imgp+'t/L.gif',lMinusIcon:Cfg.imgp+'t/Lminus.png',lPlusIcon:Cfg.imgp+'t/Lplus.png',tIcon:Cfg.imgp+'t/T.gif',tMinusIcon:Cfg.imgp+'t/Tminus.png',tPlusIcon:Cfg.imgp+'t/Tplus.png',blankIcon:Cfg.imgp+'t/blank.png',defaultText:'Tree Item',defaultAction:'',emptyreload:false,idc:0,idp:'tree-',_a:{},getId:function(){return this.idp+(this.idc++).toString(32)},toggle:function(a,e){this.get(a).toggle();$.e_stop(e)},focus:function(a){if(a=this.get(a))a.tree.addsel(a)},blur:function(a){if(a=this.get(a))a.tree.rmsel(a)},get:function(a){var b;if(typeof a=='string'&&a.indexOf('tree-')==0){b=a;}else{var c=a;while(c&&c.nodeType==1&&c.id.indexOf('tree-')==-1)c=c.parentNode;if(c)b=c.id;}return b&&this._a[b.match(/^tree-\w+/)];},clk:function(a,event){if((a=this.get(a))&&!a.ds){var b=a.attr('act'),c=$(a.id+'-bx'),d=event&&event.srcElement,f=a.tree.face==='favor',g,o;if(c){if(d&&d.id===a.id+'-bx'){if(o=a.attr('bo')){g=Function(js.s_printx(o,a.xml,true)).call(a);}if(g!==false&&d.tagName!=='INPUT')Fn.Tree.boxCheck(c);}}if(d&&d.id===a.id+'-ic'&&(o=a.attr('iclk'))){g=Function(js.s_printx(o,a.xml,true)).call(a);}if(b&&g!==false){if(!d||d.id!==a.id+'-plus')g=Function(js.s_printx(b,a.xml,true)).call(a);}if(!a._disposed){if(g!==false)a.tree.addsel(a);if(f)a.toggle();}}},dbl:function(a){if(a=this.get(a)){var b=a.attr('on_dblclick')||a.attr('dbl');if(!a.ds&&b){Function(js.s_printx(b,a.xml,true)).call(a);}else a.toggle();}},cz:function(a,t){if((a=this.get(a))&&!a.ds){var b=a.attr('on_'+(t||event.type));if(b)Function(js.s_printx(b,a.xml,true)).call(a);}},cO:function(a){var b=a.xml.selectNodes('@*[starts-with(name(),"on_")]'),c=a.tree.bF._on,s='';for(var i=0,d;i<b.length;i++){d=b[i].nodeName;if(d==='on_load'){a.addEvent('load','Fn.Tree.cz(this,"load")');}else{s+=' '+d.replace('_','')+'=Fn.Tree.cz(this)';if(c)c=c.replace(','+d+',',',');}}if(c){for(var i=0,c=c.split(',');i<c.length;i++){if(c[i])s+=' '+c[i].replace('_','')+'=Fn.Tree.cz(this)';}}return s;},boxCheck:function(a,b){var o=a&&(a.nodeType?a:a.$());if(!o)return;var c=this.get(a),d=js.m(o.className.replace(/[a-z]/g,''));if(c instanceof Fn.TreeTmpItem)return;if(o.type==='checkbox'||o.type==='radio'){if(o.readOnly)return o.checked=b==null?o.defaultChecked:!!b;else o.checked=b==null?!o.checked:!!b;if(o.type==='checkbox')c.xml.setAttribute('bc',b==null?(o.checked?1:0):(b?1:0));}else{if(d<3){var v=b==null?(d?0:1):b;this.aS(c,v);if(b==null){var e=c;while((e=e.parentNode)&&$(e.id+'-bx')){if(js.all(e,'$.class_any($(v.id+"-bx"),"b0","b3")'))this.aS(e,0);else if(js.all(e,'$.class_any($(v.id+"-bx"),"b1","b4")'))this.aS(e,1);else this.aS(e,2);}}for(var i=0;i<c.length;i++){this.boxCheck(c[i],v);}}o.blur();}},aS:function(a,b){var c=a.$('bx');if(c){a.$('hd').value=b;c.className=c.className.replace(/\d/,b);a.xml.setAttribute('bc',b);}},over:function(a){$.class_add(a,'z-hv');var b=this.get(a),c=b.attr('over');if(c)Function(js.s_printx(c,b.xml,true)).call(b);},out:function(a){if(!a.contains(event.toElement))$.class_del(a,'z-hv');},getScrollContainer:function(a){var el=a.rootNode.$().parentNode;while(el!=null&&(el.style.overflow!='auto'))el=el.parentNode;return el||$.canvas();},oncontextmenu:function(d,e){if(d.context){if(e.srcElement.tagName!='SPAN'||e.srcElement.id.indexOf('tree-')!=0)return;var a=Fn.Tree.get(e.srcElement);if(a&&!(a.parentNode&&a.parentNode.loading)){var menu=Fn.Menu(e.srcElement,window);d.context(a,menu,e);if(menu.show(e))e.returnValue=false;}}},xadd:function(a,b,c){a=this.get(a);if(a.src&&a.loaded===false){a.tree.gH(a,b);}else{if(c==null)c=a.length;for(var i=0,d=$.xs(b,'d');i<d.length;i++){a.add(a.tree.iu(d[i],a.tree),c+i);}}return a;},xmodify:function(a,b){a=this.get(a);a.tree.hJ(a,a.tree.iu(b,a.tree),a.nodeIndex);},html:function(a,f){if(a.tree){a.tree.empty();a.tree.cC=f;}else{a.tree=new this.DivTree(a.id);a.tree.p_xml(a.x());}var c=a.tree.cC,d=a.xs('tree/d'+(c?'['+c+']':'')),e=c?a.xs('tree/d[not('+c+') and count(descendant::d['+c+'])>0]'):null;for(var i=0,l=d.length;i<l;i++){g=a.tree.is(d[i],a.tree);}if(c){for(var i=0,l=e.length;i<l;i++)g=a.tree.is(e[i],a.tree,true);}for(var i=0,d=[],e=a.tree.gp,l=e.length;i<l;i++){d.push(e[i].html());}a.tree.bB=c?a.xs('tree//d['+c+' or count(descendant::d['+c+'])>0]').length:l;return d.join('');},DivTree:Fn.fW({Const:function(a){this.vmid=a;this.gp=[];this.fw={};this.one=true;},Prototype:{sel:null,bornsrc:null,bF:false,cC:null,_disposed:false,p_xml:function(a,f){var b=$.x(a,'pub/default');if(b){this.bF=$.x_obj(b);if(this.bF.on==1){var b=$.xs(a,'pub/default/@*[starts-with(name(),"on_")]');for(var i=0,c=',';i<b.length;i++){c+=b[i].nodeName+',';}this.bF._on=c;}}if($.x(a,'pub/one[text()="0"]')){this.one=false;this.sel=[];}this.face=$.xt(a,'pub/face/@v')||'normal';this.hideroot=$.xt(a,'pub/hideroot');this.bornsrc=$.xt(a,'tree/@src')||VM(this.vmid).src;this.xml=a;if(b=$.xt(a,'pub/filter'))this.cC=b;if($.xt(a,'pub/boxradio')=='1')this.bxro=!0;return a;},xf:function(a,b){if(!a.childNodes.length)return js.array(a);var c=a.selectNodes(b);if(c.length){for(var i=0,d=js.array(),e,l=c.length;i<l;i++){if(e=this.xf(c[i],b)){d.push(e);}}return d;}return null;},pks:function(a){if(!a)return false;var b=a.indexOf('/');if(b>-1){var c=a.substr(b?0:1).split('/'),l=c.length,d=this.fw[c[l-1]];if(d){for(var i=0,j,e,f=[];i<d.length;i++){e=d[i];for(j=l-2;j>=0;j--){e=e.parentNode;if(!e||e.pk!=c[j])break;}if(j<0)f.push(d[i]);}return f;}}return this.fw[a]||false;},pk:function(a){return this.pks(a)[0];},cE:function(a){if(this.one)this.sel=a;else this.sel.push(a);if(a.$())$.class_add(a.$(),'z-on');},aF:function(a){if(this.one)this.sel=null;else js.remove(this.sel,a);if(a.$())$.class_del(a.$(),'z-on');},issel:function(a){if(this.one)return this.sel==a;else for(var i=this.sel.length;i>-1;i--)if(this.sel[i]==a)return true;},iE:function(a){var b=this.sel;if(b)return a==null?b:(this.one?b.attr(a):js.map(b,'v.attr("'+a+'")'));},addsel:function(a){if(this.one){if(this.sel&&this.sel!=a)this.aF(this.sel);this.cE(a);}else{if(window.event&&event.ctrlKey){if(js.index(this.sel,a)>-1){this.aF(a);}else{this.cE(a);}document.selection.empty();}else if(window.event&&event.shiftKey){var p,o;if(p=a.parentNode){var l=p.length,s0=s1=-1;for(var i=l-1;i>=0;i--){if(js.index(this.sel,p[i])>-1){s0=i;break;}}for(var i=0;i<l;i++){if(a==p[i]){s1=i;break;}}if(s0>-1&&s1>-1){var n=Math.min(s0,s1),x=Math.max(s0,s1);for(var i=0;i<l;i++){if(i<n||i>x)this.aF(p[i]);else{this.cE(p[i]);}}}else if(s1>-1){this.cE(a);}}}else{for(var i=this.sel.length-1;i>=0;i--)this.aF(this.sel[i]);this.cE(a);}}},rmsel:function(a){this.aF(a);},sheetCompare:function(a,b){for(var i=0;i<a.length;i++)this.gH(a[i],$.x(b,'d[@pk="'+a[i].pk+'"]'));},gH:function(a,b){if(!b)return;var l=b.selectNodes('d').length,bl=!!a.src;if(a.loading){a.addEventOnce('load',function(){this.tree.gH(a,b);this.tree.gI(b);});}else{var t=b.getAttribute('t');if(t&&a.attr('t')!=t)a.attr('t',t);if(l>0&&((bl&&!a.loaded)||(!bl&&!a.length))){this.io(b,a);this.gI(b);a.toggle(true);}else this.sheetCompare(a,b);}},gI:function(x){var a=$.xt(x,'ancestor::fr[@type="sh"]/pub/focus');if(a&&$.x(x,'.//d[@pk="'+a+'"]'))this.sheetExpand(a);},sheetExpand:function(a){var n=this.pk(a);if(n){n.tree.addsel(n);var p=n;while(p.parentNode){p=p.parentNode;if(!p.open)p.toggle();}VM._a[n.tree.vmid].scrollIntoView(n.$('t'));}},reloadText:function(a,b){if(typeof a=='string')a=this.pk(a);if(a&&!a._disposed&&a.loaded)Ajax.sendx(a.src,js.bind(function(x){if(x!==false){this.sheetCompare(a,x);if(b)for(var i=0;i<a.length;i++){if(a[i].src)this.reloadText(a[i],1);}}},this));},reborn:function(a,b,c){if(a._disposed)return;if(b=='remove')return a.remove();if(!b)b='modify';if(a.parentNode)this.ir(a.id,b,c);else{if(b=='modify'){if(a.tree.bornsrc)this.hK(a,c);}else this.ir(a.id,b,c);}},hb:function(a,b,c,d,e){if(b.loading)return;b.loading=true;if(a.indexOf('$')>-1)a=js.s_printx(a,b.xml,null,true);Ajax.sendx(a,this[c?'iq':'io'],this,c?[c,b,d,e]:b,e);},R:function(x,d,l,e){var a=x.getAttribute('src'),n=a?new Fn.TreeLoadItem(x,a,d,(l==null?x.selectNodes('d').length:l)):new Fn.TreeItem(x,d);if(e)n.ds=e;return n;},RT:function(x,d,l,e){var a=x.getAttribute('src'),n=a?new Fn.TreeLoad(x,a,d,(l==null?x.selectNodes('d').length:l)):new Fn.Tree(x,d);if(e)n.ds=e;return n;},io:function(a,b){if(!b._disposed){if(b.tree.ondataload)a=b.tree.ondataload(a,b);this.fR(a,b);b.fireEvent('load');}},fR:function(x,b){if(b._disposed)return;if(b.src){b.loaded=true;b.loading=false;}if(!x||x.tagName!='d'){if(x)VM(b).cmd(x);return this.ip(b);}for(var i=0,c=$.xs(x,'d'),l=c.length;i<l;i++){b.add(this.iu(c[i],b.tree),null,true);}if(b.eo!=null){b.eo.remove();delete b.eo;}if(!b.length&&this.emptyreload){b.reset();b.fireEvent('load',[a]);return;}if(b.length&&b.$()){for(var i=0,l=b.length,s=[];i<l;i++)s.push(b[i].html());b.$('cont',s.join(''));for(i=0;i<l;i++)b[i].fireEvent('render');if(!b.folder){b.folder=true;b.toggle(b.open);}b.vis=true;}},ip:function(a){a.open=false;if(a.eo!=null){a.eo.remove();delete a.eo;}},ir:function(a,b,s){a=Fn.Tree._a[a];if(!a)return;var c=b=='modify'?a.parentNode:a;if(!c)return;if(c.folder&&c.src){if(c.parentNode&&c.parentNode.loading){c.parentNode.addEvent('load',function(){this.ir(a.id,b,s);},this,null,true);}else if(a.loading){a.addEvent('load',function(){this.ir(a.id,b,s);},this,null,true);}else if(c.loading){c.addEvent('load',function(d){this.iq(d,b,c,b==='modify'?a:null);},this,null,true);}else{c.reload(b,b==='modify'?a:null,s);}}else{if(c.parentNode&&c.parentNode.folder&&c.parentNode.src){c.parentNode.reload('modify',c,s);}else{var d=c;while(d&&!d.reload)d=d.parentNode;if(d)d.reload(b,b==='modify'?a:null,s);}}},iq:function(a,b,c,d,y){if(a===false||!c||c._disposed)return;var e=a,f=c.length;if(e.tagName==='view')e=$.x(e,'static/fr/tree');if(b==='reload'){while(c.length)c[c.length-1].fY();this.fR(e,c);}else if(b==='add'){var s=[','];for(var i=0,l=c.length;i<l;i++)if(c[i].pk)s.push(c[i].pk);s.push(',');s=s.join();for(var i=0,g=e.selectNodes('d'),h,k,l=g.length;i<l;i++){h=g[i];k=h.getAttribute('pk');if(k&&s.indexOf(','+k+',')<0)c.add(this.iu(h,c.tree),i);}}else if(b==='modify'&&d&&!d._disposed){var x=$.x(e,'d[@pk="'+d.pk+'"]'),h=-1;if(x)h=js.index(x.parentNode.selectNodes('d'),x);if(d.loading){d.addEventOnce('load',function(){if(x)this.hJ(d,this.iu(x,c.tree),h,y);else d.remove();},this);return;}else{if(x)this.hJ(d,this.iu(x,c.tree),h,y);else d.remove();}d.loading=false;d.loaded=true;}if(!f&&c.length)c.toggle(true);c.loaded=true;c.loading=false;c.fireEvent('load',a);},hJ:function(a,b,c,y){var d=a.id,e=a.pk,f=a.nodeIndex,h=a.tree.issel(a),i=a.open,j=!!a.src,l=a.length;if(l){for(var k=b.length-1;k>=0;k--)b[k].fY();b.loading=a.loading;b.loaded=a.loaded;for(var k=a.length-1;k>=0;k--)b.addNode(a[k],b.length);if(a.eo){b.eo=a.eo;delete a.eo;}}var p=a.parentNode,t=a.tree;delete Fn.Tree._a[b.id];t.del(b);b.id=d;if(p){t.del(a);a.removeNode();p.addNode(b,f);}$.rm(a.$());t.add(b);a.$('cont',b.html(!!l),'beforeBegin');b.fireEvent('render');if(!isNaN(c)&&c>-1&&c!=f)b.parentNode.add(b,c>f?c+1:c);if(h)b.tree.addsel(b);if((i&&!b.open)||(!j&&b.src))b.toggle(null,y);},hK:function(n){Ajax.sendx(n.tree.bornsrc,function(x){if(x!==false){if(x.tagName=='view')x=$.x(x,'.//fr[@id="'+VM(n.tree.vmid,true).frid+'"]/tree');this.hJ(n,this.RT($.x(x,'.//d[@pk="'+n.pk+'"]'),n.tree,true));}},this);},iu:function(x,d,e){var a=d.cC,b=x.selectNodes(a?'d['+a+']':'d'),c=a?x.selectNodes('d[not('+a+') and count(descendant::d['+a+'])>0]'):null,l=b.length,n=this.R(x,d,l+(a?c.length:0),e);if(l){for(var i=0;i<l;i++)n.add(this.iu(b[i],d),null,true);}if(a){for(var i=0,l=c.length;i<l;i++)n.add(this.iu(c[i],d,true),null,true);}return n;},is:function(x,d,e){var a=d.cC,b=x.selectNodes(a?'d['+a+']':'d'),c=a?x.selectNodes('d[not('+a+') and count(descendant::d['+a+'])>0]'):null,l=b.length,n=this.RT(x,d,l+(a?c.length:0),e);if(l){for(var i=0;i<l;i++)n.add(this.iu(b[i],d),null,true);}if(a){for(var i=0,l=c.length;i<l;i++)n.add(this.iu(c[i],d,true),null,true);}return n;},add:function(a){if(this.fw[a.pk])this.fw[a.pk].push(a);else this.fw[a.pk]=[a];Fn.Tree._a[a.id]=a;if(a.level<0){this.gp.push(a);}},del:function(a){if(this.sel==a)this.rmsel(a);js.remove(this.fw[a.pk],a);if(a.level<0)js.remove(this.gp,a);delete Fn.Tree._a[a.id];},empty:function(){for(var i=this.gp.length-1;i>=0;i--)this.gp[i].dispose();this.gp.length=0;},remove:function(){if(this._disposed)return;var a=this.gp.length?VM._a[this.gp[0].tree.vmid].div:null;this.dispose();if(a)a.remove();},dispose:function(){if(this._disposed)return;if(this.gp.length){this.empty();this.gp=this.fw=this.sel=this.xml=this.bo=null;delete this.gp;delete this.fw;delete this.sel;delete this.xml;}this._disposed=true;}}}),Drag:Fn.fW({Const:function(a,b,c,d,e){if(a)this.ics=Fn.Tree.Drag.g_csr(a);this.src=b;this.sortSrc=c;this.vmid=d;this.frid=e;this.id=Fn.Tree.Drag.g_id();Fn.Tree.Drag._a[this.id]=this;},Helper:{_a:{},csrs:{},idc:0,g_id:function(){return 'treedrag-'+this.idc++;},g_csr:function(a){return(Fn.Tree.Drag.csrs[a]||(Fn.Tree.Drag.csrs[a]=$.db('<img src='+a+' style=position:absolute;z-index:9999;display:none;>'))).style;},reset:function(){for(var i in this._a)this._a[i].gg=null;}},Prototype:{gg:null,_disposed:false,move:function(a){var m=a.srcElement.id.match(/^tree-\w+/);if(m){var b=$(m+'-anc');if(b&&b.contains(a.srcElement)){with(this.ics){display='block';pixelTop=a.clientY+9;pixelLeft=a.clientX+13;}}}},out:function(a){if(this.ics)this.ics.display='none';},down:function(a){this.downX=a.clientX;this.downY=a.clientY;},start:function(a){var b=Fn.Tree.get(a.srcElement);if(!b&&this.frid)return;this.out();this.cI=b;b.iI=$.x_obj(b.xml);var c=$.db('<div style="position:absolute;top:-99px;cursor:default;z-index:999;color:gray;border:1px dashed gray;padding:0 5px;max-width:200px;background:#fafafa;" class="fix opc8">'+(b&&b.ic?'<img src='+b.ic+' align=absmiddle hspace=3 onerror=$.rm(this)>':'')+(b?b.attr('t'):js.s_trim(a.srcElement.innerText))+'</div>'),d=this,e=d.src||d.sortSrc;d.iF=c;$.e_moveup(c,function(){var x=event.clientX,y=event.clientY;c.style.posLeft=x+20;c.style.posTop=y+6;d.hC=null;if(e)d.cX(x,y);},function(ev){var success=VM._a[d.vmid].$().contains(ev.srcElement);if(e)d.bR(null,null,success);$.rm(c);});this.fire();},fire:function(){VM._a[this.vmid].fireEvent('dragstart',this.cI,this.iF,this.downY+2);},xdrag:function(x,c,src,pxs,mv){var d=this,f;d.cI=x;$.e_moveup(c,function(){var a=event.clientX,b=event.clientY;d.cX(a,b,src,pxs);if(mv){mv(a,b,event.srcElement,x,c);}},function(ev){var x=event.clientX,y=event.clientY,r=$.bcr(VM._a[d.vmid].$()),success=x>r.left&&x<r.right&&y>r.top&&y<r.bottom;d.bR(src,pxs,success);});},bR:function(src,pxs,success){var f=this,a=f.hC;clearTimeout(f.hz);f.he(true,true);var x=event.clientX,y=event.clientY,r=this.gg;if(a&&success&&r&&x>r.left&&x<r.right&&y>r.top&&y<r.bottom){var b=f.cI,c=a.je,d=js.type(b)==='object',e;e=(f.as?(pxs||a.sortSrc):(src||a.src));if(typeof e==='function'){var m=c;if(f.as&&c.parentNode){m=c.parentNode;if(c.length&&c.open&&f.as===2)m=c;}e=e(b,m);}if(e===false){}else if(!pxs&&!f.as&&b.parentNode==c){DFish.alert(Loc.tree_movefail1);}else if(!b._disposed&&'$' in b&&b.$('cont').contains(c.$())){DFish.alert(Loc.tree_movefail2);}else{e=e.replace(/\$from(\w+)?\.(\w+)(\([^&])?/g,function(g,h,k,j){var m=b;if(h=='parent')m=m.parentNode;return m?js.url_esc(d?(m._disposed?m.iI[k]:j?eval('m.'+k+j):m.attr(k)):m.getAttribute(k)):''}).replace(/\$to(\w+)?\.(\w+)(\([^&])?/g,function(g,h,k,j){var m=c;if(f.as&&c.parentNode){m=c.parentNode;if(c.length&&c.open&&f.as===2)m=c;}if(h=='parent')m=m.parentNode;return m?js.url_esc(j?eval('m.'+k+j):m.attr(k)):'';}).replace(/\$prev(\w+)?\.(\w+)(\([^&])?/g,function(g,h,k,j){var m=c;if(f.as){if(c.parentNode){if(c.length&&c.open){if(f.as===2)m='';}}else m='';}return m?js.url_esc(j?eval('m.'+k+j):m.attr(k)):'';}).replace(/\$index\b/g,function(e){if(f.as&&c.parentNode){var h=c;if(c.length&&c.open){if(f.as===2)return 0;}return h.nodeIndex+1;}else return c.parentNode?'':0;});if(!d||(b!=c&&!(f.as&&b.tree==c.tree&&b.level==c.level&&b.nodeIndex==c.nodeIndex+1&&!c.open))){VM(a.vmid).cmd({tagName:'ajax',src:e});}}}if(a){f.hC=f.hC.je=f.cI=f.iF=f.gg=a=b=c=d=e=a.je=null;}$.rm('_df_tree_index');},cK:function(){return!this.closed&&this.frid&&VM(this.vmid).find(this.frid).$();},he:function(a,b){if(a&&this.dU){clearInterval(this.dU);delete this.dU;}if(b&&this.dT){clearInterval(this.dT);delete this.dT;}},gy:function(x,y,r){var a=VM(this.vmid).find(this.frid);if(!a)return;if(y>r.bottom-25&&y<r.bottom+25){this.he(false,true);if(!this.dU)this.dU=setInterval(function(){a.scrollTop('+=30')},300);}else if(y<r.top+25&&y>r.top-25){this.he(true,false);if(!this.dT)this.dT=setInterval(function(){a.scrollTop('-=30')},300);}else{this.he(true,true);}},cU:function(){var a=VM(this.vmid).find(this.frid).tree;return a.sel&&(a.one?a.sel:a.sel[0]);},cX:function(x,y,src,pxs){if(!this.gg){var c=this.cK();if(c){c=$.bcr(c);if(c.width&&c.height)this.gg=c;}}var b=this.gg,g,tr=VM(this.vmid).find(this.frid).tree;if(!b)return;if(x>b.left&&x<b.right&&(y>b.top-20)&&(y<b.bottom+20)){this.gy(x,y,b);var c=document.elementFromPoint(x,y),n,t,k;while(c&&!c.id)c=c.parentNode;if(c){t=c.id.match(/^tree-\w+/);n=t&&Fn.Tree._a[t];if(!n&&c.id==='_df_tree_index')n=this.je;if(!n){n=tr.gp[tr.gp.length-1];if(n.length)n=n[n.length-1];k=true;}if(n){var d=this,e=$.bcr(n.$()),f=e.bottom-y;g=pxs||this.sortSrc?($('_df_tree_index')||$.db('<div id=_df_tree_index style=background:#fd7921;height:3px;overflow:hidden></div>')):null;if(n.folder&&!n.open){if(this.hz)clearTimeout(this.hz);this.hz=setTimeout(function(){if(!d.as&&n.folder&&!n.open&&d.je==n){n.toggle(true)}},600);}if(k||(f>-2&&f<5)){if(g){g.style.display='';this.as=1;var ml=6;if(k){$.after(n.$('cont'),g);}else{n.$().nextSibling.parentNode.insertBefore(g,n.$().nextSibling);ml+=14*(n.level+(n.length?0:1));if(n.length&&n.open){if(n.level===-1||f<2){this.as=2;ml+=n.level===-1?12:28;}}}g.style.marginLeft=ml+'px';}}else{if(g){g.style.display='none';this.as=0;}}this.hC=d;d.je=n;}else{clearTimeout(this.hz);}}return;}else{if(g=$('_df_tree_index')){g.style.display='none';this.as=0;}}this.he(true,true);if(this.hz)clearTimeout(this.hz);},remove:function(){if(this._disposed)return;this.out();this.dispose();},dispose:function(){if(this._disposed)return;this.hC=this.gg=this.cI=this.src=this.ics=this.vmid=this.frid=null;delete this.hC;delete this.gg;delete this.cI;delete this.src;delete this.ics;delete this.vmid;delete this.frid;delete Fn.Tree.Drag._a[this.id];this._disposed=true;}}})}});Fn.fW('TreeLoadItem',{Const:function(x,a,b,c){Fn.TreeItem.call(this,x,b);this.src=a;this.loaded=!!c;this.loading=false;if(!c){if(this.open){this.tree.hb(a,this);}else this.eo=this.add(new Fn.TreeTmpItem(b));}},Extend:[Fn.TreeItem],Prototype:{toggle:function(a,b){if(a==null)a=!this.open;if(a){if(!this.loaded&&!this.loading)this.tree.hb(this.src,this,null,null,b);}Fn.TreeItem.prototype.toggle.call(this,a);},toggleAll:function(a,b){this.toggle(a,b);for(var i=0;i<this.length;i++)this[i].toggle(a,b);},reload:function(a,b,c){if(this.loaded){if(!a)a='reload';this.tree.hb(this.src,this,a,b,c);}else if((a==='add'||this.open)&&!this.loading){Fn.TreeItem.prototype.toggle.call(this,true);this.tree.hb(this.src,this,null,null,c);}},reset:function(){this.toggle(false);while(this.length>0)this[this.length-1].remove();this.loaded=false;this.loading=false;this.eo=this.add(Fn.treetmpitem(this.tree));}}});Fn.fW('TreeLoad',{Const:function(x,a,b,c){Fn.Tree.call(this,x,b);this.xml=x;this.src=a;this.loaded=c;this.loading=false;if(!c){if(this.open)this.tree.hb(a,this);else{this.eo=this.add(new Fn.TreeTmpItem(b));}}},Extend:[Fn.TreeLoadItem,Fn.Tree],Prototype:{}});Fn.fW('TreeTmpItem',{Const:function(a){this.id=Fn.Tree.getId();this.pk=this.id;this.tree=a||new Fn.Tree.DivTree();this.tree.add(this);},Extend:[Fn.TreeItem],Prototype:{html:function(a){var i=0,g='',s;if(this.tree.face==='normal-line'){var f=this;while(f.parentNode.parentNode){f=f.parentNode;g='<img id='+this.id+'-indent-'+i+' src='+((f.nodeIndex==f.parentNode.length-1)?Fn.Tree.blankIcon:Fn.Tree.iIcon)+'>'+g;i++;}f=null;this.level=i;s='<div id='+this.id+' class=tree>'+g+'<img id='+this.id+'-plus src='+this.plusIco()+'>';}else{i=this.parentNode.level+1;this.level=i;var ic=this.plusIco(),pd=0;if(this.tree.face=='favor'){pd+=5;if(this.tree.hideroot!=1)pd+=14;}s='<div id='+this.id+' class=tree style=padding-left:'+(i*14+pd)+'px>';}this.vis=true;return s+'<a class=tree-a href=javascript:void(0) id='+this.id+'-anc><span id='+this.id+'-t>loading...</span></a></div>';}}}); ﻿Fn.fW('Oper',{Const:function(a,b,c){this.func=a.func||'office';this.owner=b;this.x=a;this.id=Fn.Oper.g_id();this.G=[];Fn.Oper._a[this.id]=this;var e;if(c){switch(a.func){case 'classic':this.valign='middle';e=c.addset('rows=*','class="'+(a.trans!=1?'bg-'+a.face:'')+(a.align?' tx'+a.align:'')+'"');this.div=e.add('class="nobr"');break;case 'office':this.valign='middle';e=c.addset('rows=*','class="'+(a.trans!=1?'bg-'+a.face:'')+(a.align?' tx'+a.align:'')+'"');this.div=e.add('class="nobr"');break;case 'tab':e=c.add('class="nobr relative'+(a.trans!=1?' bg-'+a.face:'')+'"'),s='</div>';this.div=e;if(a.plusclk){var f=new Fn.OperTab({clk:a.plusclk,t:a.plustitle,ic:$.htm.dot});if(a.plusmore)f.addmenu(Function(a.plusmore));f.parentNode=this;this.plusTab=f;s+='<div id='+this.id+'-plus class="ln-top"><dl class="o-wrap o-plus">'+f.html()+'</dl></div>';}var v=a.dir==='v';Fn.Div.p_tag(e,'<div class="ln-'+a.face+(a.lnclz?' '+a.lnclz:'')+'"></div><div id='+this.id+'-cont'+(v?' style=overflow:hidden ondragstart="return false" onmousewheel="Fn.Oper.wheel(this)"':'')+' class="relative '+(v?'o-dir-v wdbr':'nobr '+(a.align||'left'))+'">',s);break;case 'menu':e=c.add('class=relative');this.div=e;Fn.Div.p_tag(e,'<div id='+this.id+'-cont style=overflow:hidden ondragstart="return false" onmousewheel="Fn.Oper.wheel(this)" class="relative o-dir-v">','</div>');break;default:this.valign='middle';break;}if(!this.div){this.div=c.add?c.add(a.align?'align='+a.align:null):c;}this.contdiv=c;if(a.func=='office'||a.func=='tab'||a.func=='menu'){if(a&&a.inFilm){var f=c;while(f&&!f.type_film)f=f.parentNode;if(f)f.addEvent('view',this.resize,this);}c.addEvent('resize',this.resize,this);}Fn.Div.addOnRender(this.div,Function('Fn.Oper.dZ("'+this.id+'")'));this.div.addEventOnce('remove',this.dispose,this);}},Helper:{_a:{},_n:{},idc:0,idp:'oper-',g_id:function(){return this.idp+(this.idc++);},get:function(a){if(a){if(typeof a==='object')a=a.id;return this._a[a.match(/^oper-\d+/)];}},hover:function(a,b){var c=this._a[a.id];if(c&&!c.x.ds&&!c.loading&&!c.ax){c.clz('z-hv',b);if(c.eG&&c.x.overmenu==1){clearTimeout(c.jC);if(!b)c.jC=setTimeout(function(){c.menu()},300);}else if(c.eG&&Fn.Menu.cur&&Fn.Menu.cur.owner&&Fn.Menu.cur.owner!=c&&Fn.Menu.cur.owner.rootNode==c.rootNode)c.menu();}if(c.x.alt){DFish.tip({target:c.$(),html:c.x.alt,snap:'bt,tb'});}},down:function(a,b){var c=this._a[a.id];if(!c.x.ds&&!c.loading&&!c.ax){c.clz('z-dn',b);}},clk:function(a,b){return this.click(a,b);},click:function(a,b){var a=this._a[a.id||a];if(a){if(b==null){if(a.eG){if(!a.x.clk)b=true;else{var e=event.srcElement;b=a.$('k').contains(e)||(a.$('r')&&a.$('r').contains(e));}}}a[b?'menu':'clk']();}},xclk:function(a){var a=this._a[a.id||a];if(a)a.xclk();},mapToMenu:function(a,b){if(b){if(typeof b==='function')b=b();for(var i=0,e,f,g;i<b.length;i++){e=b[i];g=js.clone({},e.x||e);if(h=a.owner&&a.owner.x&&a.owner.x.folder){delete g.ic;if(g.focus==1){g.bold=1;}g.clk='this.getOwner()[this.nodeIndex].clk()';if(g.xclk)g.xclk='var p=this.getOwner();p[this.nodeIndex].xclk();return p.V(this)';}f=g.split==1?a.addsplit():a.add(g);Fn.Oper.mapToMenu(f,e.nodes);}}return a;},showmore:function(a,o){var b=this._a[a];for(var i=0,c=0,l=b.length;i<l;i++){c+=b[i].$().offsetWidth;if(c>b.div.i_wd)break;}var d=new Fn.Menu(b.owner),e,f;for(;i<l;i++){e=b[i];f=e.split?d.addsplit():d.add(e.x);if(e.eG)Fn.Oper.mapToMenu(f,e.eG);}d.show(o);},scr:function(a,b){var c=this._a[a];if(c.length>1){var d=$.bcr(c[0].$()),e=$.bcr(c[1].$()),v=c.x.dir==='v'?'top':'left',k=c.x.dir==='v'?'scrollTop':'scrollLeft',f=e[v]-d[v],l=$(c.id+'-cont')[k];js.fps_timer(function(p){$(c.id+'-cont')[k]=l+f*p*b;});}},dZ:function(a){var b=this._a[a],c=b.func;if((c==='tab'||b.x.film)&&b.gz){b.gz.focus();}if(c=='office'||c=='tab'||c=='menu'){b.resize();}},wheel:function(a){var b=this.get(a);a.scrollTop+=(event.wheelDelta>0?-1:1)*40;}},Extend:[Fn.Node],Prototype:{$:function(a){return a?$(this.id+'-'+a):(this.contdiv||this.div).$()},init:function(x){if(x){var b=$.xs(x,'*');for(var i=0;i<b.length;i++)this.x_add(b[i]);}return this;},x_add:function(b,c){var a=$.x_obi(b,null,'focus,bold,split');if(b.tagName==='gr')return this.addgr(a,c,b);if(a.split)return this.addsplit(c);var e=this.add(a,c);if(a.src)e.eG=a.src;else if($.x(b,'b')){var d=$.x_json(b).nodes,i=0,l=d.length;if(e.x.folder){for(var i=0;i<l;i++){e.add(d[i]);}}else e.eG=d;}return e;},x_ins:function(b,c,d){var e=b.getAttribute('id'),f=e&&this.get(e),g,h;if(f){g=f.isFocus();f.remove(true);}if(h=d&&this.get(d)){if(c==='beforeend')c=h.length;else if(c==='afterbegin')c=0;else c=h.nodeIndex+(c.indexOf('end')>0?1:0);}else{c=c.indexOf('begin')>0?0:null;}if(h&&h.x.folder){this.x_add.call(h,b,c);}else{this.x_add(b,c);if(this.oScrLt){$.rm(this.oScrLt);$.rm(this.oScrRt);this.oScrLt=this.oScrRt=null;}this.data();this.resize(true);}if(g)this.focus(e);},x_upd:function(b,c,d){if(!d)d=b.getAttribute('id');if(d&&(d=this.get(d))){c=d.nodeIndex;d.remove();var s=this.x_add(b,c).html();$.html($(this.id+'-wrap'),s,c);}},add:function(x,i){var o=new Fn['Oper'+js.s_up(this.func)](x);this.addNode(o,i);if(x.focus){(this.x.folder?this.parentNode:this).gz=o;}if(x.nodes)o.addmenu(x.nodes);return o;},addsplit:function(a){return this.addNode(new Fn.OperSplit(),a);},addgr:function(a,i,x){return this.addNode(new Fn.OperOptGrp(a,this.func).init(x),i);},additem:function(a,b){if(a instanceof Fn.OperItem)a=this.add.apply(this,a.args.concat(b));else{if(a.parentNode&&a.parentNode.div.vis)$.rm(a.id);this.addNode(a,b);}if(this.div.vis)this.div.data(a.html(),b==null?'beforeEnd':b);},attr:function(a){return this.x[a]},data:function(){if(this.func=='classic'&&this.div.vis)Q('td:first',this.div.$()).append(this.html());else this.div.data(this.html());return this;},resizeTo:function(w,h){Fn.Div.resizeTo(this.div,w,h);},resize:function(e){if(e===true){setTimeout('Fn.Oper._a["'+this.id+'"].gd()');}else{this.gd();}},gd:function(){if(this._disposed)return;var d=this.div,p=d.parentNode,n=p[1],b,c,s;if(!d.$())return;if(this.x.dir==='v'&&d.i_ht){var e=$(this.id+'-cont').scrollHeight,f=this.id,h=d.i_ht;if(e>d.i_ht){if(!this.oScr)this.oScr=$.append(d.$(),'<div class=o-scr-v><div class="o-scr-prev" onclick=Fn.Oper.scr("'+this.id+'",-1)><em class="i-fa fa-chevron-up"></em></div><div class="o-scr-next" onclick=Fn.Oper.scr("'+this.id+'",1)><em class="i-fa fa-chevron-down"></em></div></div>');h-=26;}else{if(this.oScr){$.rm(this.oScr);this.oScr=null;}}$(this.id+'-cont').style.height=h+'px';}else if(this.func==='office'){b=(this.x&&this.x.nohead!=1?'13,':'')+'*,';c=14;if(this.x&&this.x.nohead!=1)n=p[2];s='<a class=operbg-r href=javascript:void(0) onclick=Fn.Oper.showmore("'+this.id+'",this) hidefocus></a>';if(d.wd!=null&&d.$().scrollWidth>d.i_wd){setTimeout(function(){if(d.$().scrollWidth>d.i_wd){if(!n)n=p.add().data(s).render();if(!n.i_wd){p.resize(null,null,'cols='+b+c);}}},10);}else if(n&&n.i_wd!=null){p.resize(null,null,'cols='+b+0);}}else if(this.func==='tab'){var M=function(){if(this.oScrLt){$.rm(this.oScrLt),$.rm(this.oScrRt);this.oScrLt=this.oScrRt=null;}if(this.J){Q($(this.id+'-wrap')).prepend(Q($(this.id+'-wrap:fix')).children());Q($(this.id+'-cont:fix')).remove();delete this.J;}};M.call(this);var b=$(this.id+'-cont'),e=d.i_wd-(this.plusTab?this.plusTab.$().offsetWidth+4:0),f=40,g=this.x.bnw||90;var tmp=this[0]&&Math.max(js.m(this[0].$().currentStyle.marginLeft),js.m(this[0].$().currentStyle.marginRight));if(isNaN(tmp))tmp=0;g+=tmp;if(e>-1&&this.x.bxw){var m=this.x.bxw,w,l=this.length,h=Math.floor(e/g),k=Math.floor((e-f)/g);if((m+tmp)*l>e){if(g*l>e){this.oScrLt=$.before(b,'<div class="'+this.x.face+'-lt" onclick=Fn.Oper.scr("'+this.id+'",-1)><i class=va-i></i>'+$.htm.arw('l2')+'</div>');this.oScrRt=$.after(b,'<div class="'+this.x.face+'-rt" onclick=Fn.Oper.scr("'+this.id+'",1)><i class=va-i></i>'+$.htm.arw('r2')+'</div>');f=Q(this.oScrLt).width()*2;k=Math.floor((e-f)/g);for(var i=0;i<this.length;i++){if(this[i].x.xclk)break;}if(i&&k>i){var n=$.before(b,b.cloneNode(false)),fm=$(this.id+'-wrap').cloneNode(false);n.id+=':fix';fm.id+=':fix';for(var j=0;j<i;j++){fm.appendChild(this[j].$());}n.appendChild(fm);j=(g+tmp)*i;n.style.width=j+'px';b.style.width=(e-j)+'px';this.J=i;k-=this.J;}w=Math.min(this.x.bxw,((e-f)/k)-tmp);b.style.width=(k*(w+tmp))+'px';}else{w=Math.min(this.x.bxw,e/l-tmp);b.style.width=e+'px';}}else{w=Math.min(this.x.bxw,e/l-tmp);b.style.width='';}for(var i=0;i<l;i++)this[i].$().style.width=w+'px';if(this.oScrLt){var d=this.getSelected();if(d)d.B();}if(this.plusTab&&this.plusTab.x.t){this.collapsePlusTitle();}}}},collapsePlusTitle:function(){var r=$.bcr($(this.id+'-cont')),l=this.length;for(var i=0,b,c=0;i<l;i++){b=$.bcr(this[i].$());if(b.left<r.left){c+=this[i].x.folder?this[i].length:1;}else break;}for(var i=l-1;i>=0;i--){b=$.bcr(this[i].$());if(b.right>r.right){c+=this[i].x.folder?this[i].length:1;}else break;}var t=this.plusTab,d=t.id+'-n';if(this.J)c-=this.J;this.plusTab.$('t').innerHTML='<i class=va-i></i>'+(c?'+'+c:this.plusTab.x.t);$.class_add(this.plusTab.$(),'z-mg',!c);},get:function(a,b){var c=this.dp(a,b);if(!c&&this.x&&this.func=='stack'){c=VM(this.owner).find(this.x.move).dp(a);}return c},dp:function(a,b){if(b!=null){var c=this.get(a);return c&&c.attr(b);}if(a==null){return this.gz;}if(a.parentNode==this){return a;}for(var i=0;i<this.length;i++){if(this[i].length){var c=arguments.callee.call(this[i],a);if(c)return c;}if(this[i].x&&this[i].x.id==a){return this[i];}}return isNaN(a)?null:this[a];},disable:function(a,b){if(c=this.get(a))c.disable(b);},focus:function(a,b){if(a=this.get(a))a.focus(b);},click:function(a){if(a=this.get(a))a.clk();},xclk:function(a){if(a=this.get(a))a.xclk();},close:function(a){if(a=this.get(a))a.close();},getSelected:function(a){if(a){var b=this.getSelected(),c=this.G,i=c.length;while(i--){var o=Fn.Oper._a[c[i]];if(o&&o!==b){return o;}}return;}return this.gz||js.find(this,'v.x.focus',true);},vm:function(){return VM(this.owner);},xt:function(a){var x=this.vm().xfr(this.x.id);return x&&$.xt(x,a);},prev:function(){return VM.Base.prototype.prev.call(this);},next:function(){return VM.Base.prototype.next.call(this);},show:function(){$.toggle(this.div.parentNode.$(),true)},hide:function(){$.toggle(this.div.parentNode.$(),false)},bh:function(){js.each(this,'if(v instanceof Fn.OperOptGrp)v.bh()');},on:function(a,b){if(a==='contextmenu'){return;}},render:function(){this.data();Fn.Oper.dZ(this.id);},html:function(s){if(!s){for(var i=0,s='';i<this.length;i++)s+=this[i].html();}var c=this.x.valign||this.valign,h=this.x.dir!=='v'&&this.div&&this.div.i_ht;return '<dl id="'+this.id+'-wrap" class="o-wrap '+this.x.face+'-wrap'+(this.x.bxw?' c-lmt':'')+(c?' va-'+c:'')+'"'+(h&&h>0?' style="height:'+h+'px;"':'')+'>'+s+(c?'<i class="va-i va-'+c+'"></i>':'')+'</dl>';},dispose:function(){if(!this._disposed){var i=this.length;while(i--)this[i].dispose();delete Fn.Oper._a[this.id];delete this.gz;delete this.contdiv;delete this.div;delete this.owner;delete this.x;delete this.id;this.removeNode();}}}});Fn.fW('OperOptGrp',{Const:function(x,a){this.x=x;this.func=a;},Extend:[Fn.Oper],Prototype:{$:function(){return this[0].$().parentNode.parentNode},bh:function(){js.each(this,'v.$().parentNode.className=v.av()');},ingr:function(){return this.parentNode instanceof Fn.OperOptGrp;},html:function(){for(var i=0,s='';i<this.length;i++)s+=this[i].html();return '<dt class="o-l grp '+(this.rootNode||this.parentNode).x.face+(this.nodeIndex===this.parentNode.length-1?' z-end':'')+'"><dl>'+s+'</dl></dt>';}}});Fn.fW('OperItem',{Const:function(x){this.x=x;this.id=Fn.Oper.g_id();Fn.Oper._a[this.id]=this;},Extend:[Fn.EventNode],Prototype:{eG:null,vis:false,ic_w:0,valign:'middle',add:function(x,i){var n=this.addNode(new this.constructor(x),i);if(x.focus){this.parentNode.gz=n;}n.getOwner=function(){return this.parentNode};if(this.x.folder){var l=this.length;if(this.vis)$(this.id+'-t').innerText='('+l+')'+this.x.t;}return n},$:function(a){return $(this.id+(a?'-'+a:''));},attr:function(a,b){if(b!==undefined){if(b===DFish.RESET){b=(this.defaults||this.x)[a];}if(!this.defaults)this.defaults={};if(!(a in this.defaults))this.defaults[a]=this.x[a];var o;if(o=this.$()){if(a==='ic'){var c=Q('.i-c',o);if(!b)c.remove();else if(c.length)Q('.i-c',o).replaceWith($.htm.ic(b));else Q('.tt',o).before($.htm.ico(b));}else if(a==='t'){Q('.tt',o).html(b);}else if(a==='alt'){if(Fn.Tip.inst){Fn.Tip.inst.remove();if(b)DFish.tip({target:this.$(),html:b,snap:'bt,tb',showDelay:0});}}}this.x[a]=b;}return this.x[a]},clk:function(){if(this.jK)return this.jK=false;if(!this.x.ds&&!this.loading){if(!this._disposed&&this.nodeIndex>-1&&(this.rootNode.x.film||this.tabEffect)){if(this.x.folder){if(this.length===1)this[0].clk();else this.menu();}else this.focus();}if(this.x.clk){if(false===(typeof this.x.clk==='string'?Function(this.x.clk):this.x.clk).call(this))return false;}this.fireEvent('click');}},xclk:function(){if(this.x.xclk==1){var p=this.parentNode;this.close();if(p&&!p._disposed&&p.x.folder){var l=p.length;$(p.id+'-t').innerText=l>1?'('+l+')'+p.x.t:p.x.t;}}else Function(this.x.xclk).call(this);},focus:function(a){if(!this._disposed&&!this.x.ds){var r=this.rootNode;if(a!==false&&this.nodeIndex>-1&&(r.x.film||this.tabEffect)){this.cd();c=r.gz||js.find(r,'v.x.focus',true);if(c&&c!==this)c.cE(false);}this.cE(a);}},cE:function(a){a=this.P(a);this.x.focus=a;var r=this.rootNode;if(a!==false){r.gz=this;r.G.push(this.id);}else if(r.gz===this)r.gz=null;if(a!==false&&r.oScrLt)this.B();},P:function(a){if(a==null)a=true;var p=this.parentNode;if(p.x.folder)p.clz('z-on',!a);this.clz('z-on',!a);return a},B:function(){if(this.rootNode.J&&!this.x.xclk)return;var a=$.bcr(this.parentNode.x.folder?this.parentNode.$():this.$()),b=$(this.rootNode.id+'-cont'),c=$.bcr(b),d=a.left<c.left?a.left-c.left:a.right>c.right?a.right-c.right:null;if(d){var l=b.scrollLeft,r=this.rootNode;js.fps_timer(function(p){b.scrollLeft=l+d*p;if(p===1&&r.plusTab&&r.plusTab.x.t){r.collapsePlusTitle();}});}},isFocus:function(){return this.x.focus?true:false},tabFocus:function(){var b=js.find(this.rootNode,'v.x.focus',true);if(b&&b!==this)b.cE(false);this.cE();},setLoading:function(a){if(a==null)a=true;if(a===false){if(this.loading){this.attr('ic',DFish.RESET);$.class_del(this.$(),'opc6');}}else if(!this.loading){this.attr('ic','img/p/loading-dot.gif');var t=this.x.t,l=t.length-t.replace(/^ +/g,'').length;if(l>1){Q('.i-c',this.$()).css({position:'absolute','margin-left':(-(7-(l-2)*2))+'px'});}$.class_add(this.$(),'opc6');}this.loading=a;},makeFolder:function(){var x=js.extend({xclk:''},this.x),v=VM(this),f=x.focus,k=v.x('static//fr[@type="oper"]//b[@id="'+this.x.id+'"]');this.x.id=this.id+':makefolder';k.setAttribute('id',this.x.id);this.x.folder=1;this.x.clk='';delete x.focus;delete this.x.focus;var d=$.x_doc('<insert type="oper" target="'+this.x.id+'" where="beforeend"></insert>');$.x_add(d,'b',null,null,x);v.cmd(d);var n=VM().button(x.id);if(f){n.P(true);this.rootNode.gz=n;}var h=this.rootNode.G,i=0;for(;i<h.length;i++){if(h[i]===this.id)h[i]=n.id;}return n.folderNode=this;},closeOther:function(){var p=this.parentNode,i=p.length;while(i--){if(p[i]!==this)p[i].xclk();}},closeAll:function(){var p=this.parentNode,i=p.length;while(i--)p[i].xclk();},close:function(){this.fireEvent('remove');var c=this.rootNode.x.film;if(c){if(this.x.folder){var i=this.length;while(i--){if(this.rootNode.gz==this[i]){this.rootNode.gz=this;}this[i].remove_page();this[i].remove();}}if(!this.parentNode.x.folder)$.xrm(this.xml());if(!this.x.folder)this.remove_page();this.remove_tab();}else{this.remove();}},remove_tab:function(){var a=this.nodeIndex,b=this.rootNode,d=b.length-1,f=b.gz===this||this.x.focus,p=this.parentNode;if(!b){this.remove();return;}if(!d){b.gz=null;this.cj();}this.remove();b.bh();if(d&&f){if(p.x.folder){b.gz=p;}var h=b.G,i=h.length;while(i--){if(Fn.Oper._a[h[i]]){b.G=h.slice(0,i);Fn.Oper._a[h[i]].clk();break;}}}b.resize();if(!d){var e=b.vm().xfr(b.x.id).parentNode;f=b.div.parentNode.parentNode;this.rmtabfr(e,f);}},remove_page:function(){var d=this.rootNode.vm(),e=d.find(this.rootNode.x.film);if(e&&(f=e.index2id(this.cH()))){d.cmd({tagName:'delete',type:'panel',target:f});}},rmtabfr:function(a,b){var e=a.parentNode,f=$.xs(e,'fr');if(f.length==3&&e.getAttribute('dragaccept')==1){var g=$.xp(a)?0:2,k=b.parentNode;k.parentNode.addNode(k[g],k.nodeIndex,true,true);e.parentNode.replaceChild(f[g],e);}},update:function(a){Fn.Oper.x_upd(this.parentNode,$.attr($.x_doc('<b/>'),a),'',this.x.id||this.nodeIndex);},ingr:function(){return this.parentNode instanceof Fn.OperOptGrp},grl:function(){return this.ingr()&&this.parentNode.length>1&&this.nodeIndex},grr:function(){if(this.ingr()){var l=this.parentNode.length;return l>1&&this.nodeIndex<l-1}},av:function(){var l=this.grl(),r=this.grr();return l||r?(l&&r?'grl grr':(l?'grl':'grr')):'';},clz:function(a,b){if(this.$())$.class_add(this.$(),a,b);return this},xml:function(){var b=this.rootNode.vm().xfr(this.rootNode.x.id);return b&&$.x(b,'.//b[@id="'+(this.x.id)+'"]');},addmenu:function(a){this.eG=a},setMenu:function(a){this.eG=a},getMenu:function(){return this.eG},menu:function(a){if(!this.x.ds){if(a)this.aw(a);if(typeof this.eG==='function'){this.eG.call(this);}else if(typeof this.eG==='string'){var c=this;$.class_add($(c.id+'-m'),'z-loading');if(!c.loading)Ajax.sendx(c.x.src,function(x){if(x!==false&&c.parentNode){if($.class_any(c.$(),'z-hv'))c.aw($.x_json(x).nodes);$.class_del($(c.id+'-m'),'z-loading');c.loading=false;}});c.loading=true;}else{this.aw(a);}}},aw:function(a,b){var c=new Fn.Menu(this);Fn.Oper.mapToMenu(c,a||this.eG||this);if(c.length){c.addEvent('close','this.jr(0)',this);var r=$.bcr(this.$());if(this.grl())r.left-=1;var d={minWidth:r.right-r.left,face:this.rootNode.x.face,snaptype:this.getSnapType()};if(b)js.clone(d,b);c.show(r,d);this.jr(1);if(this.x.overmenu==1)c.delayHide();this._menu_obj=c;return c}},jr:function(a){var z=a?$.g_z():'',prev=this.parentNode[this.nodeIndex-1];if(this.grl()){prev.clz('ctx-prv',!a);$.css(prev.$(),'z-index',z);}this.clz('z-hv',1).clz('ctx',!a);$.css(this.$(),'z-index',z);if(this.arw_ctx){Q('cite',this.$('m')).setClass('f-arw-'+(a?this.arw_ctx:(this.arw||'b1')));}this.ax=a;},V:function(a){var m=a.parentNode;a.remove();for(var i=0;i<this.length;i++){if(this[i].isFocus()){m[i].focus();break;}}return this.length<2;},getSnapType:function(){return this.rootNode.x.face==='o-office'?$.snaptype.v:''},getTabPanel:function(a){return a?this.getTabPanel().attr(a):this.rootNode.vm().find(this.rootNode.x.film).get(this.cH())},cH:function(){var a=this.nodeIndex;if(this.parentNode.x.folder)return a+this.parentNode.cH();for(var i=a-1,b;i>-1;i--){b=this.parentNode[i];if(b.split)a--;if(b.x.folder)a+=b.length-1;}if(this.ingr())a+=arguments.callee.call(this.parentNode);return a;},cd:function(){this.cj(this.cH());},cj:function(a){var b=this.rootNode.x.film;if(b){if(b.view){if(b.vis)b.view(a);else{b.setdefault(a);if(b.get(a)&&b.get(a).type_src){b.get(a).go();}}}else{var c=b.split(','),d=this.rootNode.vm();for(var i=0,e;i<c.length;i++){if(e=d.find(c[i]))e.view(a);}}}},disable:function(a){if(a==null)a=1;this.x.ds=a;if(this.$())$.class_add(this.$(),'f-ds',!a);},trigger:function(a,e){if(a==='menu'){if(this.nodeIndex>-1){Function(this.x.menu).call(this);if(e)$.e_stop(e);}}},html:function(){this.vis=true;var c=this.av(),p=this.parentNode,w=this.x.w,t=this.x.t,s='<dt id='+this.id+' class="o-l '+(this.rootNode||p).x.face+(p.x.dir==='v'?' clearfix':'')+(c?' '+c:'')+(this.x.ds?' f-ds':(this.x.focus?' z-on':''))+(this.x.main?' ma':'')+(this.nodeIndex===p.length-1?' z-end':'')+(this.x.clz?' '+this.x.clz:'')+'"';if(this.x.folder&&this.length>1){t='('+(this.length)+')'+t;}var y='';if(p.x.cellspacing!=null)y+='margin-right:'+this.parentNode.x.cellspacing+'px;';if(y)s+=' style="'+y+'"';if(this.x.menu){s+=' oncontextmenu=Fn.Oper._a["'+this.id+'"].trigger("menu",event)';}if(!Br.mobile)s+=' onmouseover=Fn.Oper.hover(this) onmouseout=Fn.Oper.hover(this,1)';s+=' onmousedown=Fn.Oper.down(this) onmouseup=Fn.Oper.down(this,1) onselectstart=return(!1) onclick=Fn.Oper.clk(this)>'+this.htm_l()+'<div class=c>';var d=[];if(this.x.ic)s+=$.htm.ico(this.x.ic,{w:!this.x.t&&w});if(t){s+='<div id='+this.id+'-t'+(w?' style="width:'+w+'px;text-align:center"':'')+' class="fix tt'+(this.x.bold?' bold':'')+'"><i class=va-i></i>'+(t.indexOf('<')<0&&t.indexOf('>')<0?t.replace(/ /g,'&nbsp;'):t)+'</div>';}y=this.htm_m();if(this.x.xclk)y+='<div class=x>'+$.htm.ic('.i-x','Fn.Oper.xclk("'+this.id+'")')+'</div>';if(y)y='<div class=k id='+this.id+'-k>'+y+'</div>';return s+y+'</div>'+this.htm_r(c)+'</dt>'},htm_l:function(){return '<div class=l></div>'},htm_r:function(c){return '<div id='+this.id+'-r class=r>'+(c?'<div class=rbg></div>':'')+'</div>';},htm_m:function(){var y='';if(this.eG){if(this.x.clk)y+='<div class=p></div>';y+='<div id='+this.id+'-m class=m><i class=va-i></i>'+$.htm.arw(this.arw)+'</div>';}return y;},wrapHtml:function(){this.O=true;var v=this.x.valign||this.valign;return '<dl class="o-wrap '+this.parentNode.x.face+'-wrap'+(v?' va-'+v:'')+'">'+this.html()+'</dl>';},remove:function(){if(!this._disposed){if(this.$())((this.O&&this.$().parentNode)||this.$()).removeNode(true);this.dispose();}},dispose:function(){if(!this._disposed){delete Fn.Oper._a[this.id];if(this.eG)delete this.eG;if(this._menu_obj){this._menu_obj.dispose();delete this._menu_obj;}delete this.x;delete this.id;this.removeNode();}}}});Fn.fW('OperOffice',{Const:function(x){Fn.OperItem.call(this,x)},Extend:[Fn.OperItem],Prototype:{type:'office'}});Fn.fW('OperSplit',{Const:function(){this.id=Fn.Oper.g_id();Fn.Oper._a[this.id]=this;this.x={split:true};},Extend:[Fn.OperOffice],Prototype:{split:true,html:function(){this.vis=true;return '<dt class="o-p"><div class=o-hr></div></dt>';}}});Fn.fW('OperLink',{Const:function(){Fn.OperOffice.apply(this,arguments);},Extend:[Fn.OperOffice],Prototype:{type:'link',getSnapType:function(){return this.rootNode.x.face==='o-side'?'12':''}}});Fn.fW('OperPath',{Const:function(){Fn.OperOffice.apply(this,arguments);},Extend:[Fn.OperLink],Prototype:{type:'path',arw:'r1',arw_ctx:'b1',htm_m:function(){var y='';if(this.nodeIndex!==this.parentNode.length-1||this.eG){if(this.x.clk&&this.eG)y+='<div class=p></div>';y+='<div id='+this.id+'-m class='+(this.eG?'m':'n')+'><i class=va-i></i>'+$.htm.arw(this.arw)+'</div>';}return y}}});Fn.fW('OperClassic',{Const:function(){Fn.OperOffice.apply(this,arguments);},Extend:[Fn.OperOffice],Prototype:{type:'classic'}});Fn.fW('OperImg',{Const:function(){Fn.OperOffice.apply(this,arguments);if(!this.x.ic)this.x.ic='.dot';},Extend:[Fn.OperOffice],Prototype:{type:'img'}});Fn.fW('OperTab',{Const:function(x){Fn.OperOffice.call(this,x);},Extend:[Fn.OperOffice],Helper:{scroll:function(a,b){var c=Fn.Oper._a[a],d=$(c.id+'-cont').scrollLeft,e=103;js.fps_timer(function(p){$(c.id+'-cont').scrollLeft=d+Math.floor(b*e*p);},300,e,true);}},Prototype:{type:'tab',tabEffect:true,title:function(a){if(a==null)return this.x.t;this.$('tt').innerHTML=this.x.t=a;},isFocus:function(){return this.rootNode.gz==null?!!this.x.focus:this.rootNode.gz===this},toggle:function(a){$.class_add(this.$(),'none',a!==false);this.dI=!a;},dispose:function(){if(this._disposed)return;if(this.parentNode.gz==this)delete this.parentNode.gz;Fn.OperOffice.prototype.dispose.call(this);}}});Fn.fW('OperStack',{Const:function(){Fn.OperOffice.apply(this,arguments);},Extend:[Fn.OperTab],Prototype:{type:'stack',focus:function(){var a=this.parentNode,c=a.x.btfcls;if(!a.div.vis)return;var d=a.x.move;if(d){var e=VM(a.owner).find(d);if(js.m(a.id.replace(Fn.Oper.idp,''))<js.m(e.id.replace(Fn.Oper.idp,'')))this.moveTo(a,e);else this.moveTo(e,a);}if(c){var d=a.x.btfcls,e=a.x.film;this.$().className=d||c;}},moveTo:function(a,b){var c=a.length,d=this.parentNode==a?this.nodeIndex:c+this.nodeIndex;if(!c&&!b.length)return;if(c!=d+1){var e=d-c+1;if(e<0){for(var i=c-1;i>d;i--)b.additem(a[i],0);}else{for(var i=0;i<e;i++)a.additem(b[0]);}Fn.Div.resizeTo(a.div,null,a.div.ht+js.m(a.x.prh)*e);Fn.Div.resizeTo(b.div,null,b.div.ht-js.m(b.x.prh)*e);}}}});Fn.fW('OperMenu',{Const:function(){Fn.OperOffice.apply(this,arguments);if(!this.x.ic)this.x.ic='.dot';},Helper:{scr_timer:{},scr:function(a,b,c){var o=Fn.Oper._a[a],d=o.div,e=$(d.id).scrollTop,f=42*2,g=this;clearInterval(g.scr_timer[a]);g.scr_timer[a]=setInterval(function(){$(d.id).scrollTop+=5*(c?1:-1);},15);$.e_attach(b,'mouseup',function(){clearInterval(g.scr_timer[a]);$.e_detach(b,'mouseup',arguments.callee,true);},true);}},Extend:[Fn.OperOffice],Prototype:{type:'menu',tabEffect:true,htm_l:function(){return ''},htm_r:function(){return ''},arw:'r1',menu:function(a){if(!this.x.ds){var b=new Fn.Menu(this);Fn.Oper.mapToMenu(b,a||this.eG);b.addEvent('close','this.jr(0)',this);var r=$.bcr(this.$());b.show(r,{face:this.rootNode.x.face,snaptype:$.snaptype.h});this.jr(1);return b;}}}});﻿Fn.fW('XBox',{Const:function(a,b){this.x=a;this.xml=b;this.b_h=b.firstChild&&b.firstChild.tagName=='h';this.mul=js.m(this.x.mul);this.id=Fn.XBox.g_id();Fn.XBox._a[this.id]=this;},Helper:{_a:{},idc:0,idp:'xbox-',g_id:function(){return this.idp+(this.idc++);},tpname:{xbox:'XBox',pickbox:'Pickbox',combobox:'Combox',olbox:'OLbox',imgbox:'ImgBox',plainbox:'PlainBox'},getById:function(a){var b=this.tpname[js.s_to(a,'-')];return b&&Fn[b]._a[a];},get:function(a,b,c,d){a=VM(a).id;var e;for(var i in this._a){var f=this._a[i];if(f.x.n==b&&f.x.vmid==a){if(f.vis&&!f.$()){f.dispose();}else{e=f;break;}}}if(e&&c){if(c==DFish.GET_VALUE)return e.val();if(c==DFish.GET_TEXT)return e.txval();if(c==DFish.SET_VALUE||c==DFish.RESET){e.gD(d);}else if(c==DFish.DISABLE){e.disable(d);}else if(c==DFish.RESIZE){VM.MX.gk($(e.id),d);e.x.w=d[0];e.hide();}}return e;},drop:function(a){var b=this._a[a];if($(a+'-opts'))return b.dI();if(b.x.ds||b.x.rdn)return;$.db(b.x2s());b.modal=true;if(!b.hide_){$.e_add(document,'mousedown mousewheel',b.hide_=js.fp(b,'hide'));if(VM._a[b.x.mxid])VM._a[b.x.mxid].addEvent('remove',b.hide_);}},rm:function(a){var a=$.pel(a,'A'),b=Fn.XBox.getById(a.parentNode.id.slice(0,-5)),c=b.x.xclk,v=a.getAttribute('_v');if(!c||Function(js.s_printx(c,$.x(b.xml,'.//o[@v="'+v+'"]'),true)).call(b)!==false){a.removeNode(true);b.checkAll(true);}},clk:function(a,b,event){var c=a.id.slice(0,-5),d=Fn.XBox.getById(c),e=d.mul,b=$.pel(b,'A');if(e){Fn.XBox.ee=c;if(a==b)return;if(event&&event.shiftKey){if(!d.gz)d.gz=b;var f=$.query('div',a),i=js.index(f,d.gz),j=js.index(f,b),l=f.length,k=0;for(;k<l;k++)f[k].className=(i<j?(k<i||k>j):(k<j||k>i))?'':'xbx_opt xbx_sel';}else if(event&&event.ctrlKey){d.gz=b;$.class_add(b,'xbx_sel',$.class_any(b,'xbx_sel'));}else{for(var f=$.query('a.xbx_sel',a),l=f.length,k=0;k<l;k++)$.class_del(f[k],'xbx_sel');d.gz=b;$.class_add(b,'xbx_sel');}}else{var f=(b&&b.getAttribute('_v'))||'';if(b){var g=d.val();d.val(f);d.$().innerHTML=b.innerHTML;d.focus();d.modal=false;if(Br._ie6)$.rm(c+'-ie6fr');$.rm(d.id+'-opts');$.rm(d.id+'-optline');event.returnValue=false;if(d.x.on_change&&g!=f){js.call(d.x.on_change,d);}}}},up:function(a){var b=Fn.XBox._a[Fn.XBox.ee],c,d,e;if(!b)return;c=b.$();if(b.b_h){d=c.children,l=d.length;if(a){for(var i=0,f;i<l;i++){e=d[i];if($.class_any(e.firstChild,'xbx_sel')){if(e.previousSibling)c.insertBefore(e,e.previousSibling);}f=e.children;for(var j=2,m=f.length,n;j<m;j++){n=f[j];if($.class_any(n,'xbx_sel')&&n.previousSibling)e.insertBefore(n,n.previousSibling);}}}else{for(var i=l-1,f;i>-1;i--){e=d[i];if($.class_any(e.firstChild,'xbx_sel')){if(e.nextSibling)c.insertBefore(e.nextSibling,e);}f=e.children;for(var j=f.length-1,n;j>0;j--){n=f[j];if($.class_any(n,'xbx_sel')&&n.nextSibling)e.insertBefore(n.nextSibling,n);}}}}else{d=$.query('div.xbx_sel',c),l=d.length;if(a){for(var i=0;i<l;i++){e=d[i];if(e.previousSibling)c.insertBefore(e,e.previousSibling);}}else{for(var i=l-1;i>-1;i--){e=d[i];if(e.nextSibling)c.insertBefore(e.nextSibling,e);}}}},dblclk:function(a){var b=$.pel(event.srcElement,'DIV');c=a.id.slice(0,-5),d=Fn.XBox._a[c];if(d.mul&&d.x.dbl){$.class_add(b,'xbx_sel');Function(d.x.dbl).apply(d);}},dwn:function(a){Fn.XBox._a[a.id.slice(0,-5)].gA=true;a.onmouseup=function(){Fn.XBox._a[this.id.slice(0,-5)].gA=false;a.onmouseup=null;}},over:function(a){if(Fn.XBox._a[a.parentNode.id.slice(0,-5)].gA){$.class_add(b,'xbx_sel',$.class_any(b,'xbx_sel'));}}},Prototype:{type:'XBox',vis:false,$:function(a){return this.mul?$(this.id+'-opts'):$(this.id+(a?'-'+a:''));},val:function(a){if(a!=null)return $(this.id+'-hide').value=a;return $(this.id+'-hide').value;},addval:function(a){this.val(js.ids_add(this.val(),a));},rmval:function(a){this.val(js.ids_del(this.val(),a));},txval:function(){if(this.mul){var a=[],f=$.query('div'+(this.x.ch==1?'':'.xbx_sel'),this.$());for(var l=f.length,i=0;i<l;i++){a.push(js.s_trim(f[i].innerText));}return a.join(',');}else{return js.s_trim(this.$().innerText);}},hide:function(a){if(!a)a=event;var b=$(this.id+'-opts'),c=a&&a.srcElement;if(!c||(b&&!b.contains(c)&&!$(this.id).contains(c)&&!$(this.id+'-drop').contains(c))){this.dI();}},dI:function(){if(Br._ie6)$.rm(this.id+'-ie6fr');$.rm(this.id+'-opts');$.rm(this.id+'-optline');this.modal=false;},checkAll:function(a){if(!this.mul)return;var b=[],c=this.$().children,l=c.length;if(this.b_h){for(var i=0,d,e;i<l;i++){d=c[i].children;e=d.length;for(var j=1;j<e;j++){if(!a)d[j].className='xbx_opt xbx_sel';b.push(d[j].getAttribute('_v'));}}}else{for(var i=0,d;i<l;i++){d=c[i];if(!a)d.className='xbx_opt xbx_sel';b.push(d.getAttribute('_v'));}}$(this.id+'-hide').value=b.join(',');},move:function(a){var b=this.$(),c=a&&a.$(),x,y;if(this.b_h&&!a.b_h)a.b_h=true;if(this.b_h){x={},y={};for(var i=0,d=b.children,f,g;i<d.length;i++){f=d[i];x[f.getAttribute('_h')]=f;if(f.firstChild.className.indexOf('xbx_sel')>-1){for(var j=0,e=f.children,e;j<e.length;j++)e[j].className='xbx_opt xbx_sel';}}for(var i=0,d=c.children,f;i<d.length;i++){f=d[i];y[f.getAttribute('_h')]=f;}}d=$.query('div.xbx_sel',b);for(var i=0,e,f,g;i<d.length;i++){e=d[i];if(a){if(this.b_h){f=e.parentNode.getAttribute('_h');g=x[f].firstChild;if(!y[f]){y[f]=c.appendChild(x[f].cloneNode(false));y[f].appendChild(g.cloneNode(true)).className='xbx_opt';}if(g==e)continue;y[f].appendChild(e);}else c.appendChild(e);e.className='xbx_opt';}else{e.removeNode(true);this.rmx(e.getAttribute('_v'));}}if(this.b_h){for(var i in x){if(x[i].children.length==1)x[i].removeNode(true);delete x[i];}}if(this.x.ch==1)this.checkAll(true);if(a&&a.x.ch==1)a.checkAll(true);},addx:function(a,b,c,d,e){if(!$.x(this.xml,'opts/o[@v="'+c+'"]'))return $.x_add($.x(this.xml,'opts'),'o',e,b,'v',c,'checked',d?1:0);},rmx:function(a){$.xrm($.x(this.xml,'opts/o[@v="'+a+'"]'));},addBySh:function(a,n){var b=a.tree,c=b.one?[b.sel]:b.sel,d=this.mul,e=[];if(!n)n='pk';for(var i=0,f,v;i<c.length;i++){f=c[i];v=f.attr(n);if(v&&(n!='pk'||v!=f.id)){if(!this.addx(f.attr('ic'),f.attr('t'),v))continue;if(d)e.push('<a class=xbx_opt href=javascript:void(0) hidefocus _v="'+v+'"><span class=xbx_lab>'+f.attr('t')+'</span>'+(d&&this.x.xclk?$.htm.ic('.i-x','Fn.XBox.rm(this)'):'')+'</a>');}}if(d)$.append(this.$(),e.join(''));this.checkAll(true);},addByTree:function(a,n){var v=a.attr(n);if(v&&(n!='pk'||v!=f.id)){if(this.addx(a.attr('ic'),a.attr('t'),v)){this.addval(v);$.append(this.$(),'<a class=xbx_opt href=javascript:void(0) hidefocus _v="'+v+'"><span class=xbx_lab>'+a.attr('t')+'</span>'+(this.mul&&this.x.xclk?$.htm.ic('.i-x','Fn.XBox.rm(this)'):'')+'</a>');}}},removeByTree:function(a,n){var v=a.attr(n);if(v&&(n!='pk'||v!=f.id))this.pop(v);},syncTree:function(a,n){this[a.$('bx').checked?'addByTree':'removeByTree'](a,n);},pop:function(v){Q('a[_v="'+v+'"]',this.$()).remove();this.rmx(v);this.rmval(v);},attachEvent:function(a,b){if(a!='onchange')this.$().attachEvent(a,b);},focus:function(){this.$().focus();},disable:function(a){if(a==null)a=1;this.x.ds=a;if(this.$()){$.class_add(this.$('wrap')||this.$(),'rdn',!a);this.$('hide').disabled=a;}if($(this.id+'-drop'))$.class_toggle($(this.id+'-drop'),'z-ds',a);},search:function(a){if(a){if(!this.fK)this.fK={};var b=$.xs(this.xml,'.//*[contains(@t,"'+a.replace(/\"/g,'')+'") or contains(text(),"'+a.replace(/\"/g,'')+'")]'),c=this.fK[a]||0;if(c>=b.length)c=0;var d=b.item(c),f;if(d){if(this.b_h){f=d.selectNodes('preceding::*').length-this.xml.selectNodes('preceding::*').length;if(this.mul&&d.tagName=='o')f++;f=$.tags('div',this.$())[f];}else{f=this.$().children($.xp(d));}if(f){Fn.XBox.clk(this.$(),f);if(!this.eL)this.eL=VM(this.$(),true);$.view(this.eL.$(),f);}this.fK[a]=++c;}}},save:function(){if(this.mul){var b=[],c=this.$().children,l=c.length;if(this.b_h){for(var i=0,d,e;i<l;i++){d=c[i].children;e=d.length;for(var j=1;j<e;j++){if(this.x.ch==1||$.class_any(d[j],'xbx_sel'))b.push(d[j].getAttribute('_v'));}}}else{for(var i=0,d;i<l;i++){d=c[i];if(this.x.ch==1||$.class_any(d,'xbx_sel'))b.push(d.getAttribute('_v'));}}$(this.id+'-hide').value=b.join(',');}},gD:function(d){var a=$.x(this.xml,'opts/o[@v="'+d+'"]');if(a){if(this.mul){}else{$(this.id).innerHTML=(a.getAttribute('ic')?'<img src='+Cfg.path+a.getAttribute('ic')+' hspace=1 align=absmiddle> ':'')+(a.text||'');this.val(d);}}},g_error:function(a,c){if(!this.$()){this.dispose();return null;}if(!this.x.ds)return Fn.FormCheck.ja(a,c,this.val());},x2s:function(){var a=this.id,b=this,c=b.mul,d=$.xs(b.xml,b.b_h?'opts/h':'opts/o'),l=d.length,r=b.$()&&$.bcr(b.$()),e=r?r.width+16:b.x.w,p=21,f=(b.x.size||(c&&b.b_h?$.xs(b.xml,'.//opts/*').length:l))*p,g=c?null:$.snapbcr(e,f,r,$.snaptype.v),ah=g&&Math.min(g.pos=='t'?r.top:$.canrec().height-g.top,f),droph=c?f:Math.min(f,ah-(ah%p)),h=[],s=(c?'':'position:absolute;top:'+(g.top+(g.pos=='t'?f-droph-2:0))+'px;left:'+g.left+'px;z-index:'+$.g_z()+';');if(!c&&Br.ie6c()){h.push($.htm.ie6fr(e,droph+2,'',a+'-ie6fr',s));}h.push('<div onselectstart=return(false) onclick=Fn.XBox.clk(this,event.srcElement,event) ondblclick=Fn.XBox.dblclk(this) class="clearfix trg_optwrap'+(b.x.bdr!='0'?' bd-mid':'')+'" id='+a+'-opts style="'+s+'width:'+e+'px;height:'+(c?'auto':droph)+'px;" layout='+b.x.layout+'>');if(b.b_h){for(var i=0,k,q,r;i<l;i++){q=d[i];r=q.getAttribute('t');h.push('<span _h="'+r+'"><div class=xbx_opt><font color=blue>'+r+'</font></div>');k=$.xs(q,'o');for(var j=0,m=k.length,n,o,p;j<m;j++){n=k[j];o=n.getAttribute('ic');p=n.getAttribute('checked')==1;h.push((c?'<div class="xbx_opt'+(p?' xbx_sel':'')+'"':'<a class=xbx_opt href=javascript:')+' _v="'+n.getAttribute('v')+'">'+(o?'<img src='+Cfg.path+o+' hspace=1 align=absmiddle> ':'')+'<span'+(Br._ie6?' style=display:inline-block;':'')+'>'+n.text+'</span>'+(c?'</div>':'</a>'));}h.push('</span>');}}else{for(var i=0,j,k,m,v=this.$()&&this.val();i<l;i++){j=d[i];k=j.getAttribute('ic');m=this.vis?v===j.getAttribute('v'):j.getAttribute('checked')==1;h.push('<a class="xbx_opt'+(m?' xbx_sel':'')+'" href=javascript:void(0) hidefocus _v="'+j.getAttribute('v')+'">'+(k?'<img src='+Cfg.path+k+' hspace=1 align=absmiddle> ':'')+'<span class=xbx_lab>'+j.text+'</span>'+(c&&b.x.xclk?$.htm.ic('.i-x','Fn.XBox.rm(this)'):'')+'</a>');}}return h.join('')+'</div>';},html:function(y){this.vis=true;var x=this.x,s='<span class="txwrp'+(x.trans==1?' f-trans':'')+(x.clz?' '+x.clz:'')+'"><input type=hidden name='+x.n+' id='+this.id+'-hide value="';if(this.mul){var a=$.xs(this.xml,x.ch==1?'.//opts/o':'.//opts/o[@checked="1"]'),v=[];for(var i=0;i<a.length;i++)v.push(a[i].getAttribute('v'));s+=v+'">'+this.x2s(this.id);}else{var a=$.x(this.xml,'opts/o[@checked="1"]');if(!a){a=x.v?$.x(this.xml,'opts/o[@v="'+x.v+'"]'):null;if(!a)a=$.x(this.xml,'opts/o');}var mn=21,rd=x.rdn==1||x.ds==1;s+=((a&&a.getAttribute('v'))||'')+'"><div id='+this.id+' name='+x.n+' onclick=Fn.XBox.drop("'+this.id+'") onfocus=VM.MX.f_focus(this) onblur=VM.MX.f_blur(this)'+(y||(' class="left nobr mx_text mx_xbox bd-input z-trg'+(rd?' rdn':'')+(x.bg?' cstbg':'')+'" style="width:'+(x.w-mn)+'px;'+(x.bg?'background-color:'+x.bg:'')+'" minus='+((x.eF||0)+mn)+' layout='+x.layout))+(x.tbi?' tabIndex='+x.tbi:'')+(x.cA?' df_fix=1':'')+'>'+(a&&a.getAttribute('ic')?'<img src='+Cfg.path+(a&&a.getAttribute('ic'))+' hspace=1 align=absmiddle> ':'')+'<span'+(Br._ie6?' style=display:inline-block;':'')+'>'+((a&&a.text)||'')+'</span></div><a class="trg_drop bd-input'+(rd?' z-ds':'')+'" id='+this.id+'-drop href=javascript:; onclick=Fn.XBox.drop("'+this.id+'") hidefocus>'+$.htm.arw('b1')+'</a>';if(x.mk)s+='<div class="mknm"'+(x.mkw?' style="width:'+(x.mkw)+'px;"':'')+'>'+x.mk+'</div>';}return s+'</span>';},dispose:function(){if(!this._disposed){if(this.hide_){$.e_remove(document,'mousedown mousewheel',this.hide_);if(VM._a[this.x.mxid])VM._a[this.x.mxid].removeEvent('remove',this.hide_);$.rm(this.id+'-opts');}delete Fn[this.type]._a[this.id];js.dps(this,'id','x','xml','hide_','eL','fK','mul');this._disposed=true;}}}});Fn.fW('ImgBox',{Const:function(a,b){this.x=a;this.xml=b;this.imgw=Math.max(js.m(this.x.imgw),16);this.imgh=Math.max(js.m(this.x.imgh),16);this.txh=$.x(this.xml,'opts/o[text()!=""]')?17:0;this.optw=this.imgw+2*this.imgpd+2;this.opth=this.imgh+2*this.imgpd+2+this.txh;this.id=Fn.ImgBox.g_id();Fn.ImgBox._a[this.id]=this;},Extend:[Fn.XBox],Helper:{_a:{},idc:0,idp:'imgbox-',g_id:Fn.XBox.g_id,clk:Fn.XBox.clk,dblclk:Fn.XBox.dblclk,drop:Fn.XBox.drop,get:Fn.XBox.get},Prototype:{type:'ImgBox',imgpd:10,x2s:function(){var a=this.id,b=this,d=$.xs(b.xml,'opts/o'),l=d.length,r=$.bcr(b.$()),csw=js.m(b.x.dropw),avw=Math.max(r.left,$.canrec().width-r.left-r.width),adw=(Math.min(l,Math.ceil(avw/b.optw)-1))*b.optw,e=Math.max(b.optw,csw?Math.min(csw,adw):adw),f=Math.ceil(l/Math.ceil(e/b.optw))*b.opth,g=$.snapbcr(e,f,r,$.snaptype.h),ah=Math.min(g.pos=='t'?r.top:$.canrec().height-g.top,f),h=ah<f?ah-2:f,k=g.pos=='t'||g.pos=='b'?1:-1,v=this.val(),s=[];if(!l)return '';s.push('<div id='+a+'-opts onselectstart=return(false) onclick=Fn.ImgBox.clk(this,event.srcElement,event) ondblclick=Fn.ImgBox.dblclk(this) class="trg_optwrap bd-text mx_bginput" style="position:absolute;top:'+(g.top)+'px;left:'+(g.left+k)+'px;z-index:'+$.g_z()+';width:'+(e+0)+'px;height:'+h+'px;" layout='+b.x.layout+'>');for(var i=0,j,m;i<l;i++){j=d[i];m=j.getAttribute('v');s.push('<a _v="'+m+'" class="imgbx_opt'+(v==m?' bg-mid':'')+'" href=javascript:; style="width:'+b.optw+'px;height:'+b.opth+'px;">'+b.dY(j)+'</a>');}return s.join('')+'</div><div id='+a+'-optline style="position:absolute;width:1px;height:'+b.opth+'px;top:'+(g.top+1)+'px;left:'+((g.pos==='r'?g.left:r.left+1)+(k>0?e+2:k))+'px;z-index:'+$.g_z()+';" class="mx_bginput white"></div>';},disable:function(a){if(a==null)a=1;this.x.ds=a;if(this.$()){$.class_add(this.$(),'rdn',!a);this.$('hide').disabled=a;}if($(this.id+'-drop'))$.class_toggle($(this.id+'-drop'),'z-ds',a);},html:function(y){this.vis=true;var x=this.x,s='<span class="txwrp'+(x.trans==1?' f-trans':'')+(x.clz?' '+x.clz:'')+'"><input type=hidden name='+x.n+' id='+this.id+'-hide value="',a=$.x(this.xml,'opts/o[@checked="1"]'),rd=x.rdn==1||x.ds==1;if(!a){a=x.v?$.x(this.xml,'opts/o[@v="'+x.v+'"]'):null;if(!a)a=$.x(this.xml,'opts/o');}s+=(a&&a.getAttribute('v'))+'"><div id='+this.id+' name='+x.n+' onclick=Fn.ImgBox.drop("'+this.id+'") onfocus=VM.MX.f_focus(this) onblur=VM.MX.f_blur(this)'+(y||(' class="mx_bginput left bd-input bd-noright'+(rd?' rdn':'')+(x.bg?' cstbg':'')+'" style="width:'+this.optw+'px;height:'+this.opth+'px;'+(x.bg?'background-color:'+x.bg:'')+'" layout='+x.layout))+' df_fix=1>';return s+this.dY(a)+'</div><a class="trg_imgdrop'+(rd?'-ds':'')+'" id='+this.id+'-drop href=javascript:; onclick=Fn.ImgBox.drop("'+this.id+'") hidefocus><div class=trg_l><div class=trg_r><div class="trg_c i-c" style="height:'+(this.opth-16)+'px"><i class=va-i></i><img src=img/p/playr.gif></div></div></div></a></span>';},dY:function(a){if(!a)return '';return '<div style="height:'+(this.imgh+2)+'px;padding:'+this.imgpd+'px;"><div class="bd-form white" style="width:'+this.imgw+'px;height:'+this.imgh+'px;overflow:hidden"><table width=100% height=100% cellspacing=0 cellpadding=0><tr><td align=center><img src='+DFish.url(a.getAttribute('ic'))+' onload=$.imgfix(this,'+this.imgw+','+this.imgh+') onerror=width='+this.imgw+';height='+this.imgh+(a.text?' title="'+a.text+'"':'')+'></table></div></div>'+(this.txh?'<div class=fix style=width:'+this.optw+'px;height:'+this.txh+'px;line-height:normal;text-align:center;margin-top:-4px>'+(a.text||'')+'</div>':'');}}});Fn.fW('Combox',{Const:function(x){this.x=x;this.fD=null;this.hf=js.m(this.x.strict);this.ha=x.srcid||x.src;this.jI={};this.x.rdn=js.m(this.x.rdn);this.x.ds=js.m(this.x.ds);this.id=Fn.Combox.g_id();Fn.Combox._a[this.id]=this;if(this.x.src){if(this.x.nocache==1){if(Fn.Combox.iy[this.ha]){delete Fn.Combox.iy[this.ha].xml;delete Fn.Combox.iy[this.ha];}if(this.x.dropsrc&&Fn.Combox.iy[this.x.dropsrc]){delete Fn.Combox.iy[this.x.dropsrc].xml;delete Fn.Combox.iy[this.x.dropsrc];}}this.checkOnStart();}},Helper:{_a:{},idp:'combobox-',idc:0,g_id:Fn.XBox.g_id,get:Fn.XBox.get,dh:String.fromCharCode(65292),onenableinterval:function(a){var b=this._a[a];if(!b)return;var c=b.getXmlHandler();if(c&&b.$()){if(c.loaded)b.init();if(c.loaded||c.error){clearInterval(b.eR);delete b.eR;}}},hasModified:function(){for(var k in this._a)if(this._a[k].dA())return true;return false;},iy:{},setx:function(a,b){if(a===false||a.tagName!='view'){var x=this.iy[b];x.loaded=x.loading=false;x.error=true;if(a&&a.tagName!='view')VM().cmd(a);}else{var x=this.iy[b];if(!x)x=this.iy[b]={};x.xml=a;x.loaded=true;x.loading=false;x.error=false;}},load:function(a,b,c,d){var x=a&&this.iy[a];if(!x&&!c)return null;if(x&&x.loading)return x;else x={xml:null,loaded:b,loading:!b};this.iy[a]=x;if(!b)Ajax.sendx(a,this.setx,this,a,d);return x;},removeData:function(a){var c=this.iy[a];if(c){delete this.iy[a].xml;delete this.iy[a];}for(var i in this._a){var d=this._a[i];if(d.ha==a){d.reset();d.checkOnStart(true);}}}},Prototype:{vis:false,_disposed:false,bq:true,checkOnStart:function(a){this.aY(a);if(!this.vis){this.hide_=js.bind(function(e){if(this.$()){if(!this.$('wrap').contains(e.srcElement)&&(!this.$('drop')||!this.$('drop').contains(e.srcElement))&&(!this.$('pop')||!this.$('pop').contains(e.srcElement))&&(!this.$('popall')||!this.$('popall').contains(e.srcElement))&&!(this.x.dropsrc&&this.$('drop')&&this.$('drop').contains(e.srcElement))){this.hide();}}else{if(this.vis)this.dispose();}},this);$.e_add(document,'mousedown click mousewheel',this.hide_);}},aY:function(a){var b=this.getXmlHandler();if(!b||b.error){b=Fn.Combox.load(this.ha,!this.x.src,true,a);if(!this.x.src)b.xml=$.x_doc('<combox/>').ownerDocument;}if(b.loading||b.loaded)this.eR=setInterval('Fn.Combox.onenableinterval("'+this.id+'")',150);},init:function(){if(!this.$('hide'))return;var a=this.getXml(),b=$.xs(a,'.//fr/pub/combox');this.hT={};this.hU=b.length;for(var i=0;i<b.length;i++){var c=b[i],d=c.parentNode.parentNode,e=js.clone($.x_obj(c),{type:d.getAttribute('type')});this.hT[d.getAttribute('id')]=e;if(e.xf)this.ia=e.xf;}if(!this.loaded){this.verifyTextByValue();this.gv();this.bz=this.$('hide').value;}this.loaded=true;this.vis=true;if(!this.x.ds){this.disable(false);}this.jz();if(this.iG){for(var i=0;i<this.iG.length;i++)this.hm.apply(this,this.iG[i]);delete this.iG;}if(this.x.graytip&&!this.val())VM.MX.graytoggle(this.$(),true);if(Br.gck&&!Br.ie11){var self=this;this.$().addEventListener('compositionstart',function(){self._imeMode=true},false);this.$().addEventListener('compositionend',function(){self._imeMode=false},false);}},jz:function(){var a=this.text().split(','),b=document.createDocumentFragment();for(var i=0,x,t,c;i<a.length;i++){if(a[i]){if(x=this.getDataByText(a[i])){t=this.ia&&x.getAttribute(this.ia)==='1'?'s':this.x.dblclk?'u':'font';c=document.createElement(t);if(t==='font')c.color='#333';c.innerText=a[i];b.appendChild(c);}else{b.appendChild(document.createTextNode(a[i]));}if(this.x.one!=1)b.appendChild(document.createTextNode(','));}}$.html(this.$(),b);},verifyTextByValue:function(v){var a=this.getXml();if(!a)return;if(v!=null)this.$('hide').value=v;var ta=[],va=(v!=null?v:this.val()).split(',');for(var i=0;i<va.length;i++){var b,j;for(j in this.hT){if(b=$.x(a,'.//fr//*[@'+this.hT[j].vf+'="'+va[i]+'"]'))break;}if(b)ta[i]=b.getAttribute(this.hT[j].tf);else if(!this.hf)ta[i]=va[i];else va.splice(i--,1);}this.$('hide').value=va.join(',');this.text(ta.join(','));},text:function(a){return arguments.length?(this.$().innerText=a):js.s_trim(this.$().innerText)},dc:function(){return this.x.win?this.x.win.document:document;},$:function(a){return(this.x.win?this.x.win.$:$)(a?this.id+'-'+a:this.id);},val:function(){this.save();var a=this.$('hide');return a?a.value:'';},txval:function(){this.save();return this.text();},getXmlHandler:function(a){return Fn.Combox.iy[a||this.ha];},getXml:function(a){return(this.getXmlHandler(a)||false).xml;},validate:function(){if(!this.loaded)return false;var a=this.getXmlHandler();if(!a||!a.loaded||a.loading||a.error){if(!this.x.ds)this.disable();if(a&&a.loading)this.aY();return false;}return a.xml;},getDataByText:function(a){var x=this.validate(),v;if(x&&a){for(var i in this.hT){if(v=x.selectSingleNode('.//fr[@id="'+i+'"]//*[@'+this.hT[i].tf+'="'+a+'"]')){if(!this.jI[a])this.jI[a]=v.getAttribute(this.hT[i].vf);}return v;}}},getValueByText:function(a){var x=this.validate();if(this.jI[a]){return this.jI[a];}if(x&&a){for(var i in this.hT){return this.jI[a]=$.xt(x,'.//fr[@id="'+i+'"]//*[@'+this.hT[i].tf+'="'+a+'"]/@'+this.hT[i].vf);}}},save:function(){if(this.validate()&&this.$()){this.gs();this.gv();}},gv:function(){var x=this.validate();if(!x||!this.$())return false;var ar=this.text().split(','),t,n,r=[],a=[];for(var i=0,l=ar.length,j;i<l;i++){t=ar[i];n=this.getValueByText(t);if(n){a.push(n);}else if(!this.hf){a.push(t);}}this.$('hide').value=a.join(',');return true;},g_error:function(a,c){var x=this.validate();if(!this.$()){this.dispose();return null;}if(this.hf&&!x)return Loc.data_loading;if(this.x.ds)return null;var t=this.text(),m=Fn.FormCheck.ja(a,c,this.val());if(t)for(var i=0,ar=t.split(',');i<ar.length;i++)if(ar[i]&&this.hf&&!this.getValueByText(ar[i]))m=Loc.ps(Loc.form.invalid_obj,this.x.t);return m;},dA:function(){if(this.validate()){this.save();return this.val()!=this.x.v;}},fq:function(){if(this.x.one!=1&&this.$()){var c=this.$(),d=c.innerText;if(d&&d.charAt(d.length-1)!=','){c.innerText=d+',';}}},gs:function(){var v=this.text(),ar=v.split(','),o={},r=[],c=0;for(var i=0,t;i<ar.length;i++){t=ar[i];if(!t)continue;if(!o[t])r.push(t);o[t]=true;c++;}if(c&&c!=r.length){this.text(r.join(','));this.gr();this.fq();}},cy:function(){if(this.x.on_change){this.gv();var v=this.$('hide').value,b=v!=this.bz;this.bz=v;if(b){js.call(this.x.on_change,this);}}},gr:function(modRng){var v=this.text();if(!v){return;}if(this.x.one==1&&v.indexOf(',')>-1){v=this.text(v.replace(/,/g,''));}else if(v.indexOf(Fn.Combox.dh)>-1){v=this.text(v.replace(RegExp(Fn.Combox.dh,'gi'),','));}var ar=v.split(','),startPos=0,endPos=0,dbl=!!this.x.dblclk,xf=this.ia;if(Br.ie){var rng=this.dc().body.createTextRange(),elRng;rng.moveToElementText(this.$());elRng=rng.duplicate();rng.execCommand('removeformat');rng.execCommand('unlink');rng.collapse();for(var i=0,x;i<ar.length;i++){rng.moveStart('character',startPos);endPos=ar[i].length;rng.moveEnd('character',endPos);startPos=endPos+1;this.et(rng);}}else if(!this._imeMode){var rng=document.createRange();rng.selectNodeContents(this.$());var sel=window.getSelection(),txn=sel.rangeCount&&sel.getRangeAt(0).cloneRange();if(!txn||!txn.inRange(rng))return;sel.removeAllRanges();sel.addRange(rng);document.execCommand('removeformat');document.execCommand('unlink');Q('br',this.$()).remove();if(Br.fox)rng.selectNodeContents(this.$());for(var i=0,dup,x;i<ar.length;i++){dup=rng.cloneRange();endPos=startPos+ar[i].length;dup.movePoint(startPos,endPos);startPos+=ar[i].length+1;x=this.getDataByText(dup.text);sel.removeAllRanges();sel.addRange(dup);if(x){if(xf&&x.getAttribute(xf)==='1')document.execCommand('Strikethrough');else if(dbl)document.execCommand('Underline');else document.execCommand('ForeColor',false,'#333');}}sel.removeAllRanges();sel.addRange(modRng||txn);sel.collapseToEnd();if(x&&this.x.one!=1){ar=$.r_r();var t1=rng.text;rng.setEnd(ar.endContainer,ar.endOffset);if(t1===rng.text&&txn){var n=this.$().appendChild(document.createTextNode(','));txn.selectNodeContents(n);sel.removeAllRanges();sel.addRange(txn);sel.collapseToEnd();}}this.jy=txn;}if(this.x.graytip&&this.text()){$.class_add($(this.id+'-graytip'),'none');}this.cy();},iJ:function(){var rng;if(Br.ie){rng=this.dc().body.createTextRange();rng.moveToElementText(this.$());}else{rng=document.createRange();rng.selectNodeContents(this.$());}return rng;},cL:function(k,jF){var txn=$.r_r(),rng=this.iJ();if(Br.ie){txn.collapse();if(!rng.inRange(txn)){(txn=rng.duplicate()).collapse();}if(k===188){var dup=txn.duplicate();dup.moveStart('character',-1);this.et(dup);dup.collapse();var tmp=this.jE(this.iJ(),dup);this.et(tmp);}rng=this.jE(rng,txn);}else{var sel=window.getSelection(),txn=txn.cloneRange();if(!txn||!txn.inRange(rng)){return;}dup=rng.cloneRange();dup.setEnd(txn.endContainer,txn.endOffset);this.jE(rng,dup);if(k===188){var jG=dup.cloneRange();jG.setStart(txn.startContainer,txn.endOffset-1);dup.setEnd(txn.endContainer,txn.endOffset-1);var tmp=this.jE(this.iJ(),dup);this.et(tmp,txn);this.et(jG,txn);}}var t=rng.text;this.et(rng,txn);if(this.x.one!=1)this.gh();if(this.x.graytip&&this.text())$.class_add($(this.id+'-graytip'),'none');this.cy();return jF?t:rng;},jE:function(rng,txn){var v=rng.text;if(Br.ie){rng.setEndPoint('EndToStart',txn);var pos=rng.text.length,tmp=v.slice(0,pos),startPos=tmp.lastIndexOf(',');txn.moveStart('character',startPos-pos+1);tmp=v.slice(pos);var endPos=tmp.indexOf(',');if(endPos<0)endPos=tmp.length;txn.moveEnd('character',endPos);return txn;}else{var pos=txn.text.length,tmp=v.slice(0,pos),i=tmp.lastIndexOf(',')+1,j;tmp=v.slice(pos);j=tmp.indexOf(',');if(j<0)j=tmp.length;rng.movePoint(i,pos+j);return rng;}},et:function(rng,txn){var t=rng.text,x=this.getDataByText(t),xf=this.ia;if(Br.ie){rng.execCommand('removeformat');rng.execCommand('unlink');if(x){if(xf&&x.getAttribute(xf)==='1')rng.execCommand('Strikethrough');else if(this.x.dblclk)rng.execCommand('Underline');else rng.execCommand('ForeColor',false,'#333333');}if(rng.text.indexOf('<')>-1&&rng.text.indexOf('>')>-1){var r=rng.duplicate();r.collapse();r.moveStart('character',rng.text.indexOf('<'));r.moveEnd('character',1);r.pasteHTML('<font class="_ielt">&lt;</font>');}}else if(!this._imeMode){var sel=window.getSelection();if(!txn)txn=$.r_r();sel.removeAllRanges();sel.addRange(rng.cloneRange());document.execCommand('removeformat');document.execCommand('unlink');if(x){if(xf&&x.getAttribute(xf)==='1')document.execCommand('Strikethrough');else if(this.x.dblclk)document.execCommand('Underline');else document.execCommand('ForeColor',false,'#333333');}sel.removeAllRanges();sel.addRange(txn);sel.collapseToEnd();this.jy=txn;}},gh:function(){var a=this.$().lastChild;while(a&&a.nodeType===3&&a.nodeValue===''){a.parentNode.removeChild(a);a=this.$().lastChild;}if(!a||a.nodeType===3)return;if(Br.ie){var r=document.body.createTextRange(),t=$.r_r();r.moveToElementText(a);if(0===t.compareEndPoints('EndToEnd',r)){t.collapse(false);t.text=',';}}else{var r=document.createRange(),t=$.r_r();r.selectNode(a);if(t.inRange(r)){var n=this.$().appendChild(document.createTextNode(',')),s=window.getSelection();t.selectNodeContents(n);s.removeAllRanges();s.addRange(t);s.collapseToEnd();}}},focus:function(){if(Br.ie)try{this.$().setActive()}catch(ex){}try{this.$().focus()}catch(ex){}},popPicker:function(){if(this.x.rdn||this.x.ds)return false;this.save();this.modal=true;eval(js.s_printf(this.x.pkrclk,this.val()));},setValueByPicker:function(a,b,c){if(this.gD(b,c)){DFish.close(a);}else DFish.alert(Loc.choose_onlyone);},gD:function(a,b){if(this.loaded){if(this.x.one==1&&a.indexOf(',')>-1)return false;this.focus();this.aP(a,b);this.modal=false;}else{this.x.v=a;if(this.$('hide'))this.$('hide').value=a;}return true;},aP:function(a,b){if(this.eQ)this.text(b||a);else{this.verifyTextByValue(a);this.jz();}},gR:function(a,b,c){var d=$.bcr(this.$('wrap'));if(this.x.dropsrc)d.right+=18;return $.snapbcr(a,b,d,c);},fz:function(k){var x=this.validate();if(!x)return false;if(this.x.rdn||this.x.ds)return false;var a=this.id+'-pop',b='',s=this.x.insense;if(!this.fD){var w=(this.x.w||this.$().offsetWidth)+4,dw=Math.max(js.m(this.x.dropw),js.m(w)),dh=Math.max(js.m(this.x.droph),66);this.fD=DFish.snapDiv(a,'white',dw,dh,this.$('wrap'));}for(var i in this.hT){var e=this.hT[i].sf,t=this.hT[i].tf;f=$.xpath(t,k,'contains',s)+' and '+$.xpath(t,k,'!=',s);if(e){e=e.split(',');for(var j=0;j<e.length;j++){f+=' or '+$.xpath(e[j],k,'contains',s);}}if(this.eQ)f='';if(this.fG){this.fG.find(i).filter(f);}else{var p=$.x(x,'.//fr[@id="'+i+'"]/pub'),q=$.x(p,'filter');if(q)q.text=f;else $.x_add(p,'filter',null,f);}}if(!this.fG){this.fG=VM.xgo(new Fn.DivFilm(dw,this.x.droph?dh:-1).render($(a)),x,VM._a[this.x.vmid]);this.fG.ext('xboxid',this.id);}b=this.fG.find(i);if((b.type==='lb'&&b.bB>b.dF)||(b.type!=='lb'&&b.bB>0)||this.eQ){var r=this.applyPickerPos();if(Br.ie6c())$.css($(a+'-ie6fr'),'height',(this.fD.offsetHeight||dh)+2,'top',r.top,'left',r.left);if(b.type==='lb')b.focus(0);this.hide(true);this.fG.ext('rec',r.type);this.ifrev(true);}else{this.hide();}this.modal=true;return this.fD;},fA:function(){if(this.x.rdn||this.x.ds)return false;if(this.fC)return this.hide();this.modal=true;var x=this.getXml(this.x.dropsrc),a=this.id,b=a+'-popall',w=(this.x.w||this.$().offsetWidth)+4,dw=Math.max(js.m(this.x.dropw),js.m(w)),dh=Math.max(js.m(this.x.droph),66),el=DFish.snapDiv(b,'white',dw,dh,this.$()),vm,rn=function(){var c=Fn.Combox._a[a],r=c.gR(dw,el.offsetHeight,vm.ext('rec'));$.css($(b),'top',Math.max(r.top,0),'left',r.left,'z-index',$.g_z());if(!x)Fn.Combox.setx(vm.xml,c.x.dropsrc);vm.ext('rec',r.type);c.ifrev(true);c.focus();};if(x){if(this.x.dropsrc==this.x.src){for(var i in this.hT){var p=$.x(x,'.//fr[@id="'+i+'"]/pub/filter');if(p)p.text='';}}vm=VM.xgo(new Fn.DivFilm(dw,this.x.droph?dh:-1).render(el),x,VM._a[this.x.vmid]);rn();}else{vm=VM.inst(VM.p_film(new Fn.DivSet('rows=*',dw,this.x.droph?dh:-1).render(el)),VM.g_url('vm:|'+js.s_printf(this.x.dropsrc,js.url_esc(this.val())),null),VM._a[this.x.vmid]);vm.addEventOnce('render',rn);VM.dy(vm);}vm.ext('xboxid',this.id);vm.addEvent('page',rn);this.fB=el;this.fC=vm;},jh:function(k){var t=this.cL(k,true),v=t&&t.replace(/\"/g,'');if(v)this.fz(v);else this.hide();},jH:function(a){if(!a){a=document.createRange();a.selectNodeContents(this.$());}var sel=window.getSelection();sel.removeAllRanges();sel.addRange(a);sel.collapseToEnd();},bs:function(a){if(this.x.rdn||this.x.ds)return false;this.focus();if(!Br.ieVer&&this.jy){this.jH(this.jy);}var t;if(a.tree){if(a.ds)return;if(t=this.hT[VM(a,true).frid])t=a.attr(t.tf);}else{var v=VM(a,true);if(v.type==='lb'){t=v.tr2x(a,this.hT[v.frid].tf);}else if(v.type==='img'){t=v.bP(a).getAttribute(this.hT[v.frid].tf);}}if(!t)t='';var r=this.cL();if(this.x.one==1||!r){this.text(t);}else{r.text=t;}if(!Br.ieVer){this.jH(this.x.one==1?null:r);}this.save();this.cL();if(this.eQ){var self=this;setTimeout(function(){self.hide()});}else this.hide();},hide:function(a){if(!a&&this.fD){if(Br.ie6c())$.rm(this.fD.id+'-ie6fr');this.fD.style.display='none';this.modal=false;}if(this.fC){if(Br.ie6c())$.rm(this.fB.id+'-ie6fr');this.fC.remove();this.fB.removeNode(true);this.fC=this.fB=null;this.modal=false;}this.ifrev(false);},ec:function(a){if(this.x.rdn||this.x.ds)return false;var b,e=a.keyCode;if(e===13){if(this.x.onenterkey)return false;b=1;}else if(e===40||e===38){if(this.fD&&this.hU==1)b=1;}else if(e===37||e===39)return;else if(e===8)Q('br'+(this.$().innerText?'':'u,font'),this.$()).remove();if(b&&this.fG&&this.fD.style.display!=='none'){for(var i in this.hT)return this.fG.find(i).ec(e);}if(!a.ctrlKey&&a.keyCode!==17){clearTimeout(this.bC);this.bC=setTimeout('Fn.XBox.getById("'+this.id+'").jh('+e+')',js.m(this.x.delay)||200);}},ea:function(e){if(this.x.rdn||this.x.ds)return false;var k=e.keyCode;if(k===13){if(this.x.onenterkey){var tp=typeof this.x.onenterkey;if(tp==='string')eval(this.x.onenterkey);else if(tp==='function')this.x.onenterkey();else if(tp==='object')this.x.onenterkey[0].apply(this.x.onenterkey[1],this.x.onenterkey[2]||[]);}return false;}else if((k>36&&k<41)&&this.fD&&this.fD.style.display!=='none'){return false;}if(this.x.one==1&&k==188&&!e.shiftKey)return false;},eb:function(e){if(e.keyCode==13)if(!Br.cmp){$.e_stop(e);return false;}},eU:function(e){if(this.x.rdn||this.x.ds)return false;},eX:function(e){if(this.x.rdn||this.x.ds)return false;this.focus();var obj=this,rng=$.r_r(),txr=$.db('<div class=hide><textarea></textarea></div>').children[0];txr.focus();setTimeout(function(){rng.text=js.s_trim(txr.value);if(Br.ie){rng.collapse(false);rng.select();}else{var sel=window.getSelection();sel.removeAllRanges();sel.addRange(rng);sel.collapseToEnd();}if(!obj.eq)obj.gr();$.rm(txr.parentNode);txr=null;},0);},eS:function(e){if(this.x.rdn||this.x.ds)return false;},eY:function(e){if(this.$().scrollTop>0){this.$().scrollTop=0;}},jA:function(e){if(!this.x.ds&&!Br.ieVer){this.jy=$.r_r();}},eV:function(e){if(this.x.ds)return false;var r=this.cL(),v=this.getValueByText(r.text.replace(/,/g,'')),n=$.r_r();if(v&&n.text!==','){if(this.x.dblclk)eval(js.s_printf(this.x.dblclk,v));$.e_stop(e);if(Br.ie)this.dc().selection.empty();else this.dc().defaultView.getSelection().removeAllRanges();}},attachEvent:function(a,b){if(a=='onchange')this.x.on_change=b;else this.$().attachEvent(a,b);},ifrev:function(a){},cV:function(l){return Math.min(16,Math.max(5,l));},disable:function(a){if(this.$()){Fn.XBox.prototype.disable.call(this,a);if(this.x.pkrclk){$.class_toggle($(this.id+'-pkr'),'z-ds',a);}if(this.fD)this.hide();this.$().contentEditable=!a;}},cE:function(a){VM.MX.f_focus(a);},aF:function(a){setTimeout(function(){VM.MX.f_blur(a)})},setPickerPos:function(fn){this.az=fn;},applyPickerPos:function(){var w=(this.x.w||this.$().offsetWidth)+4,dw=Math.max(js.m(this.x.dropw),js.m(w)),r;this.fD.style.display='';if(this.az){r=this.az();r.zIndex=$.g_z();$.css(this.fD,r);this.fG.contdiv.parentNode.resize(r.width,r.height);}else{if(dw!=this.fG.contdiv.parentNode.wd){this.fD.style.posWidth=dw;this.fG.contdiv.parentNode.resize(dw);}r=this.gR(dw,this.fD.offsetHeight,this.fG.ext('rec'));$.css(this.fD,'top',Math.max(r.top,0),'left',r.left,'z-index',$.g_z());}return r;},html:function(y){var xc=this.getXmlHandler(),x=this.x,r=x.rdn||x.ds,rd=(!xc||!xc.loaded||r),a=x.dropsrc,b=!!x.pkrclk,c='Fn.Combox._a[\''+this.id+'\'].',m=(a?21:3)+(b?22:0),s='<span class="txwrp'+(x.trans==1?' f-trans':'')+(x.clz?' '+x.clz:'')+'"><input type=hidden name='+x.n+' id='+this.id+'-hide comboxid='+this.id+' value="'+(x.v||'')+'"'+(x.ds?' disabled':'')+'>'+(x.graytip?VM.MX.jk(this.id,x.graytip,true):'')+'<div id='+this.id+'-wrap'+' class="ln-bl txsel bd-input'+(x.dblclk?' txsel-link':'')+(rd?' rdn':'')+(x.bg?' cstbg':'')+'">'+'<div contenteditable=false class="left txsel-edtr'+(x.nobr?' z-nobr nobr':'')+'" id='+this.id+' onfocus="return '+c+'cE(this)" onblur="return '+c+'aF(this)" onkeydown="return '+c+'ea(event)" onkeypress="return '+c+'eb(event)" onkeyup="'+c+'ec(event)" oncut="return '+c+'eU(event)" '+(Br.ieVer?'onbeforepaste':'onpaste')+'="return '+c+'eX(event)" onclick="'+c+'jA(event)" ondblclick="'+c+'eV(event)" onbeforeeditfocus="return '+c+'eS()" onscroll="return '+c+'eY()"'+(y||(' style="width:'+(x.w-m)+'px;'+(x.bg?';background-color:'+x.bg:'')+'" minus='+((x.eF||0)+m)+(x.layout?' layout='+x.layout:'')))+(x.graytip?' data-graytip="'+x.graytip+'"':'')+(x.tbi?' tabIndex='+x.tbi:'')+(x.cA?' df_fix=1':'')+'>'+(x.tx||'')+'</div>';if(a)s+='<a class="trg_drop'+(rd?' z-ds':'')+(b?' z-mid':'')+'" id='+this.id+'-drop href=javascript:; onclick="'+c+'fA()" hidefocus>'+$.htm.arw('b1')+'</a>';if(b){s+='<a class="trg_pkr'+(rd?' z-ds':'')+'" id='+this.id+'-pkr href=javascript:; onclick="'+c+'popPicker()" hidefocus></a>';}if(x.mk)s+='<div style="float:left;width:'+x.mkw+'px;height:19px;line-height:19px;">'+x.mk+'</div>';return s+'</div></span>'},remove:function(){if(this._disposed)return;this.dispose();},reset:function(){this.hide();Fn.Pickbox.prototype.hide.call(this);if(this.fD){if(Br._ie6)$.rm(this.fD.id+'-ie6fr');this.fG.dispose();$.rm(this.fD);this.fD=this.fG=null;this.modal=false;}if(this.fB){if(Br._ie6)$.rm(this.fD.id+'-ie6fr');this.fC.dispose();$.rm(this.fD);this.fB=this.fC=null;this.modal=false;}if(this.eR){clearInterval(this.eR);delete this.eR;}},dispose:function(){if(!this._disposed){if(this.hide_)$.e_remove(document,'mousedown click mousewheel',this.hide_);this.reset();delete Fn.Combox._a[this.id];delete this.fD;delete this.hide_;delete this.jI;if(this.x.win)delete this.x.win;this._disposed=true;}}}});Fn.fW('OLbox',{Const:function(x){this.x=x;this.ha=x.srcid||x.src;this.jI={};this.id=Fn.OLbox.g_id();Fn.OLbox._a[this.id]=this;this.bN=$.x_doc('<combox><opts/></combox>');if(x.tx)this.addx(x.tx);},Extend:[Fn.Combox],Helper:{_a:{},idp:'olbox-',idc:0,g_id:Fn.XBox.g_id,get:Fn.XBox.get},Prototype:{eQ:true,fD:null,bx:null,checkOnStart:function(){var a=this;this.hide_=function(e){if(a.$()){if(!a.$('wrap').contains(e.srcElement)&&(!a.$('drop')||!a.$('drop').contains(e.srcElement))&&(!a.$('pop')||!a.$('pop').contains(e.srcElement))&&(!a.$('popall')||!a.$('popall').contains(e.srcElement))&&!(a.x.dropsrc&&a.$('drop')&&a.$('drop').contains(e.srcElement)))a.hide();}else{if(this.vis)this.dispose();}};$.e_add(document,'mousedown click mousewheel',a.hide_);a.bz=a.$('hide').value;setTimeout(function(){a.gr();if(a.x.graytip&&!a.val())VM.MX.graytoggle(a.$(),true);if(Br.gck&&!Br.ie11){a.$().addEventListener('compositionstart',function(){a._imeMode=true},false);a.$().addEventListener('compositionend',function(){a._imeMode=false},false);}},10);},init:function(a){Fn.Combox.setx(a,this.x.src);var a=this.getXml(),b=$.xs(a,'.//fr/pub/combox');this.hT={};this.hU=b.length;for(var i=0;i<b.length;i++){var c=b[i],d=c.parentNode.parentNode;this.hT[d.getAttribute('id')]=js.clone($.x_obj(c),{type:d.getAttribute('type')});}if(this.fG)this.fG.xml=a;this.bz=this.$('hide').value;this.vis=true;},validate:function(){if(!this.vis)return false;var a=this.getXmlHandler();if(!a||!a.loaded||a.loading||a.error)return false;return a.xml;},addx:function(a){a=a.split(',');for(var i=0;i<a.length;i++){if(!$.x(this.bN,'opts/o[@v="'+js.s_quot(a[i])+'"]'))$.x_add($.x(this.bN,'opts'),'o','','','v',a[i]);}},getDataByText:function(a){if(!a)return a;var x=$.x(this.bN,'opts/*[@v="'+a+'"]');if(x)return x;for(var i in this.hT)if(x=$.x(this.bN,'opts/*[@'+this.hT[i].tf+'="'+a.replace(/\"/g,'')+'"]'))return x;x=Fn.Combox.prototype.getDataByText.call(this,a);if(x)$.x_add(this.bN,x.cloneNode(true));return x;},jh:function(){if(this._disposed)return;var a=this.cL();if(!a||!a.text){return this.hide();}a=a.text;var b=this.x.src.replace(/\$0\b/g,js.url_esc(a)),f=function(x){if(x!==false){if(x.tagName==='view'){this.reset();this.init(x);this.fz(a);}else{VM._a[this.x.vmid].cmd(x);}}};if(b.indexOf('javascript:')===0){b=eval(b);}if(typeof b==='object'){f.call(this,b);}else{if(b.indexOf('<')===0){f.call(this,$.x_doc(b));}else this.ajax(b).sendx(f,this);}},fA:function(){if(this.x.rdn||this.x.ds)return false;if(this.fC)return this.hide();this.modal=true;var a=this.id,b=a+'-popall',h=66,w=(this.x.w||this.$().offsetWidth)+4,dw=Math.max(js.m(this.x.dropw),js.m(w)),el=DFish.snapDiv(b,'white',dw,h,this.$()),vm=VM.inst(VM.p_film(new Fn.DivSet('rows=*',dw,-1).render(el)),VM.g_url('vm:|'+js.s_printf(this.x.dropsrc,js.url_esc(this.val())),null),VM._a[this.x.vmid]);vm.ext('xboxid',this.id);vm.addEventOnce('render',function(){var c=Fn.OLbox._a[a],r=c.gR(dw,$(b).offsetHeight);$.css($(b),'top',Math.max(r.top,0),'left',r.left);c.init(vm.xml);if(Br.ie6c())$.css($(b+'-ie6fr'),'height',(el.offsetHeight||h)+2,'top',r.top,'left',r.left);c.ifrev(true);c.focus();});VM.dy(vm);this.fB=el;this.fC=vm;},gD:function(a,b){if(this.x.one==1&&a.indexOf(',')>-1)return false;this.addx(b||a);this.aP(a,b);this.focus();this.modal=false;return true;},ajax:function(a,b){return new Ajax(a,b).bind(this,'al');},save:function(){this.$('hide').value=this.text();},disable:function(a){Fn.Combox.prototype.disable.call(this,a);this.$().contenteditable=!a;},ed_w:function(){return this.x.w-(this.x.dropsrc?20:2)-(this.x.pkrclk?35:0)},cE:function(a){VM.MX.f_focus(a);if(this.text()){if(this.fD){this.applyPickerPos();}}},html:function(y){var x=this.x,rd=(x.rdn||x.ds),a=x.dropsrc,b=!!x.pkrclk,c='Fn.OLbox._a[\''+this.id+'\'].',m=(a?21:3)+(b?22:0),s='<span class="txwrp'+(x.trans==1?' f-trans':'')+(x.clz?' '+x.clz:'')+'"><input type=hidden name='+x.n+' id='+this.id+'-hide comboxid='+this.id+' value="'+(x.v||'')+'"'+(x.ds?' disabled':'')+'>'+(x.graytip?VM.MX.jk(this.id,x.graytip,true):'')+'<div id='+this.id+'-wrap'+' class="ln-bl txsel'+(x.dblclk?' txsel-link':'')+(rd?' rdn':'')+(x.bg?' cstbg':'')+'">'+'<div contenteditable='+(!rd)+' class="ln-bl txsel-edtr'+(x.nobr?' z-nobr nobr':'')+'" id='+this.id+' onclick="return '+c+'cE(this)" onfocus="return '+c+'cE(this)" onblur="return '+c+'aF(this)" onkeydown="return '+c+'ea(event)" onkeypress="return '+c+'eb(event)" onkeyup="'+c+'ec(event)" oncut="return '+c+'eU(event)" '+(Br.ieVer?'onbeforepaste':'onpaste')+'="return '+c+'eX(event)" ondblclick="'+c+'eV(event)" onbeforeeditfocus="return '+c+'eS()" onscroll="return '+c+'eY()"'+(y||(' style="width:'+(x.w-m)+'px;'+(x.bg?';background-color:'+x.bg:'')+'" minus='+((x.eF||0)+m)+(x.layout?' layout='+x.layout:'')))+(x.graytip?' data-graytip="'+x.graytip+'"':'')+(x.tbi?' tabIndex='+x.tbi:'')+(x.cA?' df_fix=1':'')+'>'+(x.tx||'')+'</div>';if(a)s+='<a class="trg_drop'+(rd?' z-ds':'')+(b?' z-mid':'')+'" id='+this.id+'-drop href=javascript:; onclick="'+c+'fA()" hidefocus>'+$.htm.arw('b1')+'</a>';if(b){s+='<a class="trg_pkr'+(rd?' z-ds':'')+'" id='+this.id+'-pkr href=javascript:; onclick="'+c+'popPicker()" hidefocus></a>';}if(x.mk)s+='<span>'+x.mk+'</span>';this.vis=true;return s+'</div></span>';}}});Fn.fW('Pickbox',{Const:function(x){this.x=x;this.id=Fn.Pickbox.g_id();Fn.Pickbox._a[this.id]=this;},Helper:{_a:{},idp:'pickbox-',idc:0,g_id:Fn.XBox.g_id,get:Fn.XBox.get},Prototype:{vis:false,$:function(a){return a?(this.x.win?this.x.win.$:$)(this.id+'-'+a):((this.x.win?this.x.win.$:$)(this.id));},val:function(){var a=(this.x.win?this.x.win.$:$)(this.id+'-hide');return a&&a.value;},attachEvent:function(a,b){this.$().attachEvent(a,b);},popPicker:function(){if(this.x.rdn||this.x.ds)return false;this.modal=true;eval(js.s_printf(this.x.pkrclk,this.val()));},setValueByPicker:function(){Fn.Combox.prototype.setValueByPicker.apply(this,arguments);},gD:function(a,b){if(typeof a=='object'){b=a[1];a=a[0];}var c=this.aP(a,b);if(c)this.modal=false;return c;},aP:function(a,b){if(this.x.one==1&&a.indexOf(',')>-1)return false;this.$('hide').value=a;this.$().innerHTML=this.ps(a,b);return true;},hide:function(){for(var i in Fn.Dialog._a){var a=Fn.Dialog._a[i];if(a.poper==this.$('btn')&&this.$('btn'))a.close();}},ps:function(a,b){if(!a)return '';if(this.x.clk){var c=a.split(','),d=b.split(','),e=[];for(var i=0;i<c.length;i++){e.push('<a href=javascript: onclick="'+js.s_quot(js.s_printf(this.x.clk,c[i]))+'" hidefocus><u>'+d[i]+'</u></a>');}return e.join(',');}else return b;},focus:function(){this.$().setActive();this.$().focus();},g_error:Fn.XBox.prototype.g_error,disable:function(a){Fn.Combox.prototype.disable.call(this,a);},html:function(){this.vis=true;var x=this.x,rd=(x.rdn||x.ds),b=!!x.pkrclk,m=3+(b?24:0),s='<span class="txwrp'+(x.trans==1?' f-trans':'')+(x.clz?' '+x.clz:'')+'"><input type=hidden name='+x.n+' id='+this.id+'-hide pickboxid='+this.id+' value="'+(x.v||'')+'"'+(x.ds?' disabled':'')+'><div id='+this.id+' style="width:'+(x.w-m)+'px;'+(x.bg?'background-color:'+x.bg:'')+'" minus='+((x.eF||0)+m)+(x.layout?' layout='+x.layout:'')+(x.tbi?' tabIndex='+x.tbi:'')+(x.cA?' df_fix=1':'')+' class="txsel ln-mid'+(x.nobr?' txsel_nobr nobr':'')+(rd?' rdn':'')+(x.bg?' cstbg':'')+(b?' z-trg':'')+'">'+this.ps(x.v,x.tx)+'</div>';if(b){s+='<a class="trg_pkr'+(rd?' z-ds':'')+'" id='+this.id+'-pkr href=javascript:; onclick="'+c+'popPicker()" hidefocus></a>';}if(x.mk)s+='<div style="float:left;width:'+x.mkw+'px;height:22px;line-height:22px;">'+x.mk+'</div>';return s+'</span>';},dispose:function(){if(!this._disposed){if(this.x.win)delete this.x.win;delete this.x;delete Fn.Pickbox._a[this.id];this._disposed=true;}}}});Fn.fW('PlainBox',{Const:function(x){this.x=x;this.id=Fn.PlainBox.g_id();Fn.PlainBox._a[this.id]=this;},Helper:{_a:{},idp:'plainbox-',idc:0,g_id:Fn.XBox.g_id,get:Fn.XBox.get},Extend:[Fn.Combox],Prototype:{vis:false,eq:true,$:function(a){return a?(this.x.win?this.x.win.$:$)(this.id+'-'+a):((this.x.win?this.x.win.$:$)(this.id));},val:function(){var a=(this.x.win?this.x.win.$:$)(this.id+'-hide');return a&&a.value;},attachEvent:function(a,b){this.$().attachEvent(a,b);},popPicker:function(){if(this.x.rdn||this.x.ds)return false;this.modal=true;eval(js.s_printf(this.x.pkrclk,this.val()));},setValueByPicker:function(){Fn.Combox.prototype.setValueByPicker.apply(this,arguments);},gD:function(a,b){if(typeof a=='object'){b=a[1];a=a[0];}var c=this.aP(a,b);if(c)this.modal=false;return c;},aP:function(a,b){if(this.x.one==1&&a.indexOf(',')>-1)return false;this.$('hide').value=a;this.$().innerHTML=this.ps(a,b);return true;},hide:function(){for(var i in Fn.Dialog._a){var a=Fn.Dialog._a[i];if(a.poper==this.$('btn')&&this.$('btn'))a.close();}},focus:function(){this.$().setActive();this.$().focus();},g_error:Fn.XBox.prototype.g_error,disable:function(a){Fn.Combox.prototype.disable.call(this,a);},cE:function(a){VM.MX.f_focus(a);},aF:function(a){setTimeout(function(){VM.MX.f_blur(a)})},fI:function(){if(this.x.autoht==1)return;var r=$.bcr($(this.id+'-wrap')),c=$.r_r().getBoundingClientRect();if(c.top+c.height>=r.bottom){this.div.scrollTop('+='+c.height);}},ao:function(a){if(this.x.autoht==1)return;var k=event.keyCode;if(k===13){this.fI();}else if(k===38||k===40){this.div.fixScrollY();}},gD:function(a,b){this.text(a);this.save();this.modal=false;$.class_add($(this.id+'-graytip'),'none',!a);return true;},save:function(){this.$('hide').value=this.text();},html:function(y){var x=this.x,rd=(x.rdn||x.ds),c='Fn.PlainBox._a[\''+this.id+'\'].',h=x.h||68,s='<span class="txwrp'+(x.trans==1?' f-trans':'')+(x.clz?' '+x.clz:'')+'"><input type=hidden name='+x.n+' id='+this.id+'-hide comboxid='+this.id+' value="'+(x.v||'')+'"'+(x.ds?' disabled':'')+'>'+(x.graytip?VM.MX.jk(this.id,x.graytip,x.v):'')+'<div id='+this.id+'-wrap'+' class="ln-bl bd-input txsel txsel-plain'+(rd?' rdn':'')+(x.bg?' cstbg':'')+'">';d=new Fn.Div(x.w,x.autoht==1?null:h,null,null,null,null,'miniscroll');d.data('<div class="txsel-edtr" contenteditable id='+this.id+' onfocus="return '+c+'cE(this)" onblur="return '+c+'aF(this)" onkeyup="return '+c+'ao(this)" '+(Br.ieVer?'onbeforepaste':'onpaste')+'="return '+c+'eX(event)"'+(y||(' style="border:0;width:'+(x.w-9)+'px;'+(x.bg?';background-color:'+x.bg:'')+';min-height:'+(h-4)+'px" minus=9'+(x.layout?' layout='+x.layout:'')))+(x.graytip?' data-graytip="'+x.graytip+'"':'')+(x.tbi?' tabIndex='+x.tbi:'')+(x.cA?' df_fix=1':'')+'>'+(x.v||'')+'</div>');s+=d.html();this.div=d;this.vis=true;return s+'</div></span>';},dispose:function(){if(!this._disposed){if(this.x.win)delete this.x.win;delete this.x;delete Fn.Pickbox._a[this.id];this._disposed=true;}}}}); (function(){Fn.fW('VM',{Const:function(a,b){if(a){if(typeof a==='string')return a.indexOf('/')===0?VM.getByPath(a):VM.aN(a,b);if(a.id){var c=a.id.match(/^vm-\w+/);if(c&&!b)return VM.aN(c[0]);if(typeof a.getOwner==='function')return VM(a.getOwner());if(a.ownerPlugin)a=a.ownerPlugin;if(typeof a.$==='function')a=a.$();else if(a.nodeType!==1&&$(a.id))a=$(a.id);}var c,d;if(a.$){if(a==window)return VM();c=a.$();}else c=a;while(c&&!(d=(c.vmid||('getAttribute' in c&&c.getAttribute('vmid')))))c=c.parentNode;return c?VM.aN(d,b):VM();}else return VM._a[VM.hF];},Extend:[Fn.EventNode],Helper:{_a:{},jc:{},jp:{},idc:0,idp:'vm-',g_id:function(){return this.idp+(this.idc++).toString(32);},inst:function(a,b,c,d,e,f){var f=new Function;f.prototype=this.prototype;f=new f;f.film=a;if(b){f.pkid=b.pkid;f.src=b.src;f.js=b.js;f.b_vm=b.b_vm;f.timeout=b.timeout;f.error=b.error;}f.bM={};f.hS={};f.opcs={};f.parent=c;if(d)f.scroll=d;if(e)f.addEvent('render',e);if(c&&b.pkid)c.hS[b.pkid]=f;var a=f,b='';while(a&&a.parent){b=a.pkid+'/'+b;a=a.parent;}f.path='/'+b;f.id=VM.g_id();return VM._a[f.id]=f;},aN:function(a,b){if(a.indexOf('#')===0)return VM.jc[a.slice(1)];var c=a.match(/^vm-\w+/);if(c)a=c[0];var c=this._a[a];if(!c){}else if(b){return c;}else{while(c.parentNode)c=c.parentNode;return c;}},getByPath:function(a){var b=a.replace(/^\/|\/$/g,'').split('/'),c=VM();if(a==='/')return c;for(var i=0;i<b.length;i++){if(!c.hS[b[i]]&&i==b.length-1){c=null;break;}if(!(c=c.hS[b[i]]))break;}return c;},page_html:function(a,x,v){if(x.record){js.clone(x,VM.LB.cR(a,x.record));x.clk='VM._a["'+a+'"].find("'+x.record+'").page("$0","'+x.id+'");';}x.clk+=';$.e_stop()';if(typeof a=='object')a=a.id;var b=js.m(x.sumPage),c=js.m(x.currentPage),d=x.sumRecords,e=x.currentRecords,f=js.m(x.pageSize)||5;var htm=[];switch(x.face){case 'office':var o=DFish.oper({func:'office',face:'o-office','valign':'middle'}),g=o.addgr({}),n;g.add({ic:".i-fa .fa-chevron-left",clk:'VM.exec(\''+a+'\',\''+escape(x.clk)+'\','+(c-1)+')',ds:c==1});if(x.showInfo!='0'){g.add({t:c+'/'+b}).addmenu(function(){for(var i=1,k=[],t;i<=b;i++){t={t:i+'/'+b,clk:'VM.exec(\''+a+'\',\''+escape(x.clk)+'\','+i+')'};if(i==c){t.ds=1,t.t+='     ';}k.push(t);}this.aw(k);});}g.add({ic:".i-fa .fa-chevron-right",clk:'VM.exec(\''+a+'\',\''+escape(x.clk)+'\','+(c+1)+')',ds:c==x.sumPage});v.addEvent('remove',o.dispose,o);htm.push('<div class=o-page-wrap>'+(n?n.html():'')+o.html()+'</div>');break;case 'side':var g=DFish.oper({func:'link',face:'o-side'}),n;if(x.showInfo!='0'){var t=c+'/'+b,l=t.length,clz=[];if(l>5)clz.push('ft-12');if(l>6){clz.push('z-br ft-normal');t='<div class=t1>'+c+'</div><div class=hr>/</div><div class=t2>'+b+'</div>';}g.add({t:t,clz:clz.join(' ')}).addmenu(function(){for(var i=1,k=[],t;i<=b;i++){t={t:i+'',clk:'VM.exec(\''+a+'\',\''+escape(x.clk)+'\','+i+')'};if(i==c){t.ds=1,t.t+='     ';}k.push(t);}this.aw(k,{snaptype:'12',minWidth:String(b).length*6+80,index:c});});}g.add({ic:".i-side-prev",clk:'VM.exec(\''+a+'\',\''+escape(x.clk)+'\','+(c-1)+')',ds:c==1});g.add({ic:".i-side-next",clk:'VM.exec(\''+a+'\',\''+escape(x.clk)+'\','+(c+1)+')',ds:c==x.sumPage});v.addEvent('remove',g.dispose,g);htm.push('<div align="'+(x.align||'left')+'" style="line-height:1">'+(n?n.html():'')+g.html()+'</div>');break;case 'step':htm.push('<i class=va-i></i>',c==1?'<font color=#aaaaaa>'+Loc.page_prev+'</font>':'<a href=javascript: onclick="VM.exec(\''+a+'\',\''+escape(x.clk)+'\','+(c-1)+')">'+Loc.page_prev+'</a>','&nbsp; ',c==x.sumPage?'<font color=#aaaaaa>'+Loc.page_next+'</font>':'<a href=javascript: onclick="VM.exec(\''+a+'\',\''+escape(x.clk)+'\','+(c+1)+')">'+Loc.page_next+'</a>');break;default:htm.push('<table align='+(x.align||'right')+' cellspacing=0 cellpadding=0 style=table-layout:fixed;margin-right:'+('marginRight' in x?x.marginRight:18)+'px;><tr>');function css_ico(s,i){return ' class=df-pagenm style="background:url('+Cfg.img+'p/page-'+s+'.gif) no-repeat center #fff;"'+exe(i);};function css_itd(n){var iw=18;if(n!=null&&n>9)iw+=(String(n).length-1)*6;return ' style="width:'+iw+'px;height:19px;background:url('+Cfg.img+'p/page-bg.gif) no-repeat bottom right;"';};function exe(i){return ' onclick="VM.exec(\''+a+'\',\''+escape(x.clk)+'\','+i+');return(!1)"';};htm.push(x.showInfo!='0'?'<td align=right style="font:11px Arial;color:#999;padding-right:12px;" class=fix><span>Pages:</span><input name=page class=df-pagetx value="'+c+'" onkeyup="VM.fl(this,'+b+',\''+a+'\',\''+escape(x.clk)+'\')"><span>/'+b+' </span><span>Records:</span><span>'+e+'</span><span>/'+d+'</span>':'','<td'+css_itd()+'><div'+css_ico('first',1),'>&nbsp;</div>'+'<td'+css_itd()+'><div'+css_ico('prev',c>1?c-1:1)+'>&nbsp;</div>');var first,last;if(b>f){first=c>1&&f>1?js.m_rng(c-Math.floor(f/2),1,b-f+1):c;last=first+f<=b?first+f:b+1;}else{first=1;last=b+1;}for(var k=first;k<last;k++){htm.push('<td'+css_itd(k)+'><div class=df-pagenm'+exe(k)+'>',k==c?'<font color=red>'+k+'</font>':k,'</div>');}htm.push('<td'+css_itd()+'><div'+css_ico('next',c<b?(c+1):b)+'>&nbsp;&nbsp;</div>'+'<td'+css_itd()+'><div'+css_ico('last',b)+'>&nbsp;&nbsp;</div></table>');break;}return htm.join('');},fl:function(a,b,c,d){if(event.keyCode==13){var e=a.value;if(!isNaN(e)){VM.exec(c,d,js.m_rng(parseFloat(e),1,b));}$.e_stop(event);}},g_url:function(a,b){if(typeof a==='object'){return js.extend(arguments.callee(a.url,b),a);}if(0===a.indexOf('vm:')){a=js.s_fr(a,'vm:').split('|');if(!b)b=a[0];var c=a[2]?js.url_unesc(a[2]).split(','):null;a={src:a[1],js:c,b_vm:true};}else a={src:a,b_vm:0===a.indexOf('<view>')};if(b)a.pkid=b;return a;},ep:function(a,b,c){return '<table width=100% height=100%'+(a?' '+a:'')+'><tr><td align=center><span class="f-ajax-loading'+(c?' '+c:'')+'"><img src='+Cfg.imgp+'loading-12.gif hspace=3 align=absmiddle> <font color=gray>'+(b==null?Loc.loading:b)+'</font></span></table>'},s_loading:function(){return this.ep();},p_film:function(a,b){var c=this.jB(a,b);if(a.vis)c.render();return c},jB:function(a,b){var c=b?a.addfilm.apply(a,b):a.addfilm();if(!Cfg.plus)c.setdefault(c.add().data(c.wd<122?'':VM.ep()));return c},go:function(a,b,c,d,e,f,g,h,i,j){if(d){if(d instanceof VM){}else if((d instanceof Fn.Dialog)&&d.x.n){c=d.x.n;d=VM();}else d=null;}if(a.vis&&d&&d.hS[c]){return d.hS[c].reload(b,j);}var v=VM.inst(a,this.g_url(b,c),d,e,f);if(g)v.isGlobal=g;if(h)v.isCache=h;if(i)v.independent=i;v.hstry=[b];v.hstry.point=0;a.vis?VM.dy(v,j):Fn.Div.addOnRender(a,js.fp(VM,'dy',v,j));return v},dy:function(a,b){if(a.b_vm){a.showLoading();a.film.addEventOnce('remove',a.dispose,a);var e=1;function c(d){a.loading=false;if(d===false){if(typeof b==='function')b();return;}if(d){if(d.tagName==='view'){a.xml=d;}else{a.addEventOnce('render',a.cmd,a,[d]);a.xml=$.x_doc('<view><static><fr id="blank" type="html"/></static></view>');}}if(--e==0){a.start();if(typeof b==='function')b();}};if(a.js){e=2;Ajax.loadjs(a.js,c,b===true);}if(a.src){if(a.src.indexOf('<view>')===0)c($.x_doc(a.src));else{if(!a.loading){a.loading=true;a.ajax(a.src,c,null,!!b,a.error,null,a.timeout);}}}else a.start();}else{a.start();}return a;},xgo:function(a,b,c,d,e){var d=VM.inst(a,{b_vm:true,pkid:d},c,e);d.xml=typeof b=='string'?$.x_doc(b):b;if(a.vis){d.start(1);}else{Fn.Div.addOnRender(a,js.fp(d,'start',1));}return d;},g_xvms:function(x){if(!VM.iv){var c='',i;for(i in VM.jser.vm)c+='or @type="'+i+'"';VM.iv='//fr['+c.substr(3)+']';}return $.xs(x,VM.iv);},bj:function(a,x,b){var c=a.attributes,d;if(c){for(var i=0,l=c.length,d={},e,f;i<l;i++){e=c[i];f=e.nodeName;d[f]=b?js.s_printa(e.nodeValue,b,'src'===f):e.nodeValue;}}else if('tagName' in a){if(b){for(var i in a){if(typeof a[i]==='string')a[i]=js.s_printa(a[i],b,'src'===i);}}d=a;}if(x)js.clone(d,x);return d;},da:function(a,b,c){var f=VM(),g='/view/templates';if(!f.vis)return null;var h=f.x(g+'/template[@id="'+a+'"]');if(!h){if(h=(f.xt(g+'/@src')||Cfg.template_src)){VM._a[c].ajax(js.s_printx(h,b),function(v){if(v!==false)$.x_add(f.x(g),v);},null,true);h=f.x(g+'/template[@id="'+a+'"]');}}if(h){return h.cloneNode(true);}},bi:function(a,b,c){var d=VM._a[a];if(d){for(var i=0,f=b.childNodes,l=f.length;i<l;i++){if(c)d.cmd.apply(d,[f[i]].concat(c));else d.cmd.call(d,f[i]);}}},fV:[],fU:'_record_fr',fT:function(a,f){var b=VM.fU,c=VM.fV,d=c.length,u=Cfg.path+'js/htc/record.html';if(!('i' in c)){if(f){c.rl=a;VM.fT([a[0],$.x_doc('<cmd record="1"><js><![CDATA[this.reload("vm:|'+f.src+'")]]></js></cmd>'),[]]);return;}c.i=d;}else{c.i++;if(c.i<d)c.splice(c.i,d-1);}u=js.url_set(u,'i',c.i);if(!$(b))$.db($.htm.hiframe(b,u));else frames[b].location.assign(u);c.push(a);},rcmd:function(a){var b=VM.fV,c=js.url_get(a,'i');if(c!=b.i){if(!VM._a[b[c][0]])b[c][0]=VM().id;VM.bi.apply(null,b[c]);b.i=c;}else if(b.rl){var d=b.rl;delete b.rl;VM.fT(d);}},developmsg:function(a){if(Cfg.debug){a=a||event.srcElement;if(event.altKey||(event.ctrlKey&&event.type=='contextmenu')){var b=VM(a),c,d=$.bcr(b.$()),e=$.db('<div id=df_developmsg style="position:absolute;border:2px dashed red;z-index:'+$.g_z()+';width:'+(d.width-4)+'px;height:'+(d.height-4)+'px;left:'+d.left+'px;top:'+d.top+'px;"></div>');for(var i=0;i<b.length;i++)if(b[i].$()&&b[i].$().contains(a))c=b[i];var s=' view src: '+b.src+'\nview path: '+(b.path.slice(0,-1)||'/')+(c?'\n panel id: '+(c.frid||''):'');if(Cfg.php)s+='\n vmid: '+b.id;if(b.js)s+='\n js: '+b.js;if(event.altKey){alert(s);$.rm(e);}else{DFish.alert(s,null,null,'$.rm("df_developmsg")');}$.e_stop();}}},execjs:function(a,b,c){if(typeof b=='string')b=VM(b)||$(b);if(!b)b=null;switch(typeof a){case 'string':return Function(a).apply(b,c||js.A);break;case 'function':return a.apply(b,c||js.A);break;case 'object':var d=a[0];return(typeof d=='string'?Function('return '+d+'.apply(this,arguments)'):d).apply(b,a[1]||js.A);break;}},jser:{vm:{lb:js.A,mx:js.A,sh:js.A,dl:['js/vm/dl.js'],rl:['js/fn/calendar.js','js/vm/rl.js'],img:['js/vm/img.js'],plugin:js.A},en:function(a,b,s){var c=[],i,d=(b?'static':(a.tagName=='fr'?'..':'.'))+'//fr[@type="';for(i in this.vm)if(!!$.x(a,d+i+'"]')&&!VM[i])c.push.apply(c,this.vm[i]);if(i=(d=$.xs(a,'source/js')).length){for(var j=0;j<i;j++)c.push(d[j].text);}if(i=(d=$.xs(a,'source/css')).length){for(var j=0,e=[];j<i;j++)e.push(d[j].text);$.css_import_link(e);}if(c.length){if(b)Ajax.loadjs(c,js.fp(VM._a[b],'render'),s);else Ajax.require(c);}else if(b){VM._a[b].render();}}},exec:function(a,b){Function(js.s_printa(unescape(b),js.argu(2))).call(VM(a));},x_mrg:function(a,b,c){if(!c)c='commands';var d=$.x(a,c)||$.x_add(a,c);e=$.xs(b,'*');for(var i=0,l=e.length,f,g;i<l;i++){f=e[i];g=$.x(d,c=='events'?'text()="'+f.text+'"':'*[@id="'+f.getAttribute('id')+'"]');if(g)d.replaceChild(f,g);else d.appendChild(f);}},fH:function(x,a,b){if(x.nodeType==1){x=x.cloneNode(true);var c=$.xs(x,(b?'':'descendant-or-self::*//')+'@*[contains(.,"$")]');for(var i=0;i<c.length;i++){if(!$.x(Br.ie||Br.ie11?c[i]:(c[i].ownerElement||c[i]),'ancestor::*[@type="commands"]')){c[i].nodeValue=c[i].nodeValue.replace(/\$(\d+)/g,function(d,e){if(e<a.length)return typeof a[e]=='object'?'':a[e]});}}}else x=js.printJSON(x,a);return x;},iH:function(a,b){var t=a.replace(/\$IF\.(\w+)(\{[^}]+\})/g,function($0,$1,$2){eval('var t='+$2);var f=b.getAttribute($1);return t[f in t?f:'default']||'';});return js.s_printx(t,b);},startByCfg:function(){if(Cfg.src){$.class_add(document.body,'df_body '+Cfg.skin.bg);var a=new Fn.DivSet('rows=*',$.canrec().width,$.canrec().height);$.attachResize(function(w,h){Fn.Div._a[a.id].resize(w,h);Fn.Menu.cur&&Fn.Menu.cur.dispose();document.body.click();});VM.hF=VM.go(VM.p_film(a.render()),Cfg.src).id;}},start:function(a,b,c,d){var e=new Fn.DivSet('rows=*',c,d,'class=df_body'),w=$.win(b);e.ww=w;var f=VM.go(VM.p_film(e.render(b)),a);if(w==window)VM.hF=f.id;return f;},load:function(a,b,c,d,e){VM.go(VM.p_film(new Fn.DivSet('rows=*',c,d).render(b)),a,e,VM(b));},keysubmit:function(a,b){if(!b||b.keyCode==13){var c=VM._a[a],d;if(c&&(d=c.x('//b[@dft="1"]'))){Function(d.getAttribute('clk')).call(c);}}}},Prototype:{type:'vm',ff:25,dQ:22,vis:false,start:function(a){if(this._disposed)return;if(!this.b_vm)this.render();else VM.jser.en(this.xml,this.id,a);if(this.xml&&(a=this.xt('@id'))){VM.jc[a]=this;}},showLoading:function(a){if(Cfg.plus){if(this.plus_waiting){this.plus_waiting.close();this.plus_waiting=null;}if(a===false){this.film.view(this.contdiv);}else{this.plus_waiting=plus.ui.createWaiting("加载中...");}}else{if(a===false)this.film.view(this.contdiv);else this.film.viewdefault();}},reload:function(a,b){if(this.ba&&this.dB())DFish.confirm(Loc.confirms.giveup_modify,Function('VM._a["'+this.id+'"].fX("'+a+'",'+(b||false)+')'));else this.fX(a,b);},fX:function(a,b,h){if(h)VM.fT([this.id,$.x_doc('<cmd record="1"><js><![CDATA[this.reload("'+a+'")]]></js></cmd>'),[]],this);Ajax.bb(this);if(typeof a==='number'&&this.hstry){var c=a+this.hstry.point,d=this.hstry[c];if(d){this.doReload(d,b);this.hstry.point=c;}}else{this.doReload(a,b);if(this.hstry){if(this.hstry.point!=this.hstry.length-1)this.hstry.splice(this.hstry.point+1,this.hstry.length-1-this.hstry.point);this.hstry.point=this.hstry.length;this.hstry.push(a);}}},doReload:function(a,b){this.fireEvent('remove');while(this.length)this[this.length-1].dispose();this.reset();if(this.div)this.div.remove();if(a){var c=js.type(a);if(c==='xml'){this.xml=a;this.start();return;}else{if(c==='string'){if(c.substr(0,6)==='<view>'){this.xml=$.x_doc(c);this.start();return;}a=VM.g_url(a,this.pkid);}js.clone(this,a);}}VM.dy(this,b);},render:function(){if(this._disposed)return false;if(this.b_vm){var e=this.xt('events/dataload');if(e)Function(e).call(this);}if(!this.contdiv){var a,b=['rows=*','vmid='+this.id],x=this.parent&&this.parent.xfr(this.pkid),c=x&&x.getAttribute('class'),r=this.film.addset('rows=*',(c?'class="'+c+'" ':'')+'vmid='+this.id);(this.contdiv=this.film.setpk(r,this.pkid)).addEventOnce('remove',this.dispose,this);this.contdiv.attr+=' onclick=VM.developmsg() oncontextmenu=VM.developmsg()';this.contdiv.render();}var c='';if(this.b_vm){c=this.x('static/fr');if(!c)c=$.x_add(this.x('static'),'fr','','','type','html');}this.show(this.x2view(),c);this.vis=true;this.fireEvent('render');if(this.b_vm){var d='events/',e=this.xt(d+'resize');if(e)this.div.addEvent('resize',js.bind(e,this));e=this.xt(d+'unload');if(e)this.div.addEventOnce('remove',js.bind(e,this));e=this.xt(d+'load');if(e)Function(e).call(this);}},show:function(a,b,c,d,r){var e=c==null?0:c,f=d==null?this.length:d;for(var i=e;i<f;i++)if(!this[i].vis)this[i].data();if(!this.vis&&this.film&&(!this.film.ho||this.film.ho==this.pkid)){this.showLoading(false);}if(!r||typeof r=='object')a.render(r);e=c==null?0:c,f=d==null?this.length:d;for(var i=e;i<f;i++){if(this[i].fL)this[i].fL();this[i].vis=true;}if(b){var c=$.xs(b,'descendant-or-self::fr[@on="1"]');for(i=0;i<c.length;i++){var d=$.x_obj(c[i]);if(d.id){for(var j in d){if(j.indexOf('on_')===0){var p=this.find(d.id);if(p)p.on(js.s_fr(j,'_'),d[j]);}}}}}},x2view:function(){if(!this.b_vm){var a=this.contdiv.addset('rows=*'),b=this.id;a.add().data($.htm.iframe(a.i_wd,a.i_ht,this.src,b+'-fr',null,this.scroll&&('scrolling='+(this.scroll=='hidden'?'no':this.scroll))));if(Br._ie6)Fn.Div.addOnRender(a[0],Function('frames["'+b+'-fr"].location=VM("'+b+'").src||"about:blank"'));a.addEvent('resize',function(){$(b+'-fr').style.posWidth=this.i_wd;$(b+'-fr').style.posHeight=this.i_ht;});return this.div=a;}if(this.div){this.div.remove();}if(!this.div||this.div._disposed){this.div=this.contdiv.addset('rows=*');}return this.frame2div(this.div,this.x('static/fr'));},fr_div:function(x,d){if(typeof x==='string')x=$.x_doc(x);if(!d)d=new Fn.DivSet('rows=*');return this.frame2div(d,x);},frame2div:function(v,x,y){var a=x.getAttribute('type'),b=x.getAttribute('id'),c,d,e,f,g;var _c=x.getAttribute('class'),_0=_c?'class="'+_c+'"':'',_1=x.getAttribute('style'),_2=x.getAttribute('hmin'),_3=x.getAttribute('vmin');if(_2)_2=parseFloat(_2);if(_3)_3=parseFloat(_3);if((_c||_1)&&!_2&&!_3){if(_c&&/\bbd-|-bd\b/.test(_c)){if(/bd-only(?:bottom|top)/.test(_c))_3=1;else if(/bd-only(?:left|right)/.test(_c))_2=1;else{_2=_3=2;e=/bd-no(?:bottom|top)/g;while(e.exec(_c))_3--;e=/bd-no(?:left|right)/g;while(e.exec(_c))_2--;}}else{_2=_3=0;}var m,p,d;if(_1){c=_1.split(';');for(var i=0,k;i<c.length;i++){e=js.s_trim(c[i]).toLowerCase().split(/\s*:\s*/);k=e[0].indexOf('margin')==0;if(k||e[0].indexOf('padding')==0){if(!m)m={};if(!p)p={};k=k?m:p;if(f=js.s_fr(e[0],'-'))k[f]=js.m(e[1]);else{f=e[1].split(/\s* \s*/);k.top=js.m(f[0]);k.right=js.m(f.length>1?f[1]:f[0]);k.bottom=js.m(f.length>2?f[2]:f[0]);k.left=js.m(f.length>3?f[3]:k.right);}}else if(e[0].indexOf('border')===0){if(!d)d={};if(e[0]==='border'){var r=e[1].match(/\d+(?:px|pt:em)/);if(r)d.top=d.right=d.bottom=d.left=js.m(r[0]);}else if(e[0]==='border-width'){f=e[1].split(/\s* \s*/);d.top=js.m(f[0]);d.right=js.m(f[1]||f[0]);d.bottom=js.m(f[2]||f[0]);d.left=js.m(f[3]||f[1]||f[0]);}else if(e[0].indexOf('width')>0){d[e[0].split('-')[1]]=js.m(e[1]);}else{var r=e[1].match(/\d+(?:px|pt:em)/);if(r){if(e[0]==='border')d.top=d.right=d.bottom=d.left=js.m(r[0]);else d[e[0].split('-')[1]]=js.m(r[0]);}}}}}if(d){var t=_3?(d.top||1):(d.top||0),o=_3?(d.bottom||1):(d.bottom||0),l=_2?(d.left||1):(d.left||0),r=_2?(d.right||1):(d.right||0);_2=l+r;_3=t+o;}if(m){if(m.left)_2+=m.left;if(m.right)_2+=m.right;if(m.top)_3+=m.top;if(m.bottom)_3+=m.bottom;}if(p){if(p.left)_2+=p.left;if(p.right)_2+=p.right;if(p.top)_3+=p.top;if(p.bottom)_3+=p.bottom;}}switch(a){case 'set':case 'fieldset':c=x.getAttribute('rows'),d=c?'rows='+c:'cols='+x.getAttribute('cols');e=a!='set'?v.addset('rows=*',null,null,0,0,y):v.addset(d,_0,_1,_2,_3,y),f=$.xs(x,'*');if(a!='set'){var s=x.getAttribute('style');Fn.Div.p_tag(e,'<fieldset class="f-fieldset '+$.xt(x,'@fscls')+'"'+(s?' style="'+s+'"':'')+'><legend>'+x.getAttribute('fstx')+'</legend>','</fieldset>');e=e.addset(d,null,null,_2||8,_3||25,y);}for(var i=0,l=f.length;i<l;i++)arguments.callee.call(this,e,f[i]);if(b)(this.bM||this.parentNode.bM)[b]=e;return e;break;case 'flow':e=v.addflow(x.getAttribute('dir')==='h',_0,_1,_2,_3,x.getAttribute('scroll'),x.getAttribute('align'),y);for(var i=0,f=$.xs(x,'fr');i<f.length;i++){arguments.callee.call(this,e,f[i]);}var h=x.getAttribute('scrollLock');if(h&&(h=h.split(','))){for(var i=0;i<h.length;i++)Fn.Div.scrollLock(this.bM[h[i]]);}break;case 'film':e=VM.jB(v,[_0,_1,_2,_3,y]);var h=$.xt(x,'@dft'),k=$.xt(x,'@wel');for(var i=0,f=$.xs(x,'fr'),g;i<f.length;i++){g=f[i];if(g.getAttribute('type')!=='src')arguments.callee.call(this,e,g);}e.hZ=k;if((h||k)&&!this.x('static//fr[@film="'+b+'"]')){var m=h&&this.xfr(h)?h:(k&&this.xfr(k)?k:'');if(m){Fn.Div.addOnRender(e,Function('VM._a["'+this.id+'"].go("'+m+'")'));}}break;case 'html':if(v.ht<0&&v.bcol)_1='min-height:1px;'+(_1||'');e=v.add(_0,_1,_2,_3,x.getAttribute('scroll'),y);f=x.getAttribute('align');g=x.getAttribute('valign');if(f||g)Fn.Div.p_tag(e,'<table class=fp-html-'+(g||'top')+' width=100%'+(e.ht!=null?' height=100%':'')+' cellspacing=0 cellpadding=0><tr><td id='+e.id+':frhtml'+(f?' align='+f:'')+(g?' valign='+g:'')+'>',' </td></tr></table>');var h=x.text;if(h){if(h.indexOf('<fish:js>')>-1)h=h.replace(/<fish:js>([\s\S]+?)<\/fish:js>/gi,function($0,$1){return Function($1).call(e)||''});if(h.indexOf('<var')>-1)h=this.ps(h);e.data(h);}break;case 'oper':e=v.addset('rows=*',_0,_1,_2,_3,y);if(!b){b=$.eid('oper-',7);x.setAttribute('id',b)};var h=$.x_obi(x,null,'bxw,bnw');h.inFilm=$.xt(x,'ancestor::fr[@type="film"]/@id');var o=new Fn.Oper(h,this.id,e),p=this.opcs||(this.parentNode&&this.parentNode.opcs);if(p)p[b]=o;o.init(x).data();break;case 'page':e=v.add(_0,_1,_2,_3,null,y);e.data(VM.page_html(this.id,$.x_obj(x),e));break;case 'src':var g=x.getAttribute('global')==1,s=g?v.addset('rows=*'):v,m;if(g&&(m=VM.jp[b])){this.addInst(m);s.additem(m.film);this.bM[b]=m.film;DFish.collapseParent(m);this.addEventOnce('render',function(){Fn.Div.resumeScroll(this.contdiv)});}else{e=VM.p_film(s,[_0,_1,_2,_3,y]);f=x.getAttribute('load');var u=x.getAttribute('src');if(u.indexOf('javascript:')===0){u=eval(u);}if(f==null||js.m(f)){f=VM.go(e,u,b,this,x.getAttribute('scroll'),x.getAttribute('onload'),g,x.getAttribute('cache')==1,x.getAttribute('independent')==1);if(g){VM.jp[b]=f;e.isGlobal=true;}}}if(g&&this.isCache){(this.jq||(this.jq={}))[b]=s;this.contdiv.addEvent('beforeview',function(){if(this.vis){var m=VM.jp[b];if(m.parent!==this){this.addInst(m);this.jq[b].additem(m.film);DFish.collapseParent(m);}}},this);}break;default:f=this.addNode(new VM[a.toUpperCase()](x));if(f.type=='lb'||f.type=='mx'){_0='class="'+(_c?js.ids_add(_c,f.type,' '):f.type)+'"';}e=v.addset('rows=*','vmid='+f.id,null,null,null,y);e.vmid=f.id;f.design(e,x,_0,_1||'',_2,_3);break;}if(e){if(b){(this.bM||this.parentNode.bM)[b]=e;if(v.type_film)v.setpk(e,b);}f=$.xt(x,'@hrz');g=$.xt(x,'@vrz');if(f||g){Fn.Div.set_valve(e,f,g);}}return e;},fr2div:function(a,w,h,b){var c=new Fn.DivSet('rows=*',w,h),d=$.x_doc(a);if(d){var x=this.x('vir')||$.x_add(this.x(),'vir');$.append(x,d);var e=$.xt(d,'@id');if(!e){e=$.eid();d.setAttribute('id',e);}c.addEvent('remove',this.reset,this,[e]);var e=this.length;this.frame2div(c,d);this.show(c,d,e,null,b);}else DFish.alert('fr2div: wrong xml');return c;},addInst:function(a){var p=a.parent;if(a.pkid){this.hS[a.pkid]=a;if(p&&p.hS)delete p.hS[a.pkid];}a.parent=this;},find:function(a,b){var r;switch(b){case DFish.XPATH:var c=this.x('static').selectNodes(a),d=[];for(var i=0,e;i<c.length;i++){e=this.find(c[i].getAttribute('id'));if(e)d.push(e);}r=d;break;default:var c=this.xfr(a),d=c&&c.getAttribute('type');if(d){switch(d){case 'oper':r=this.opcs[a];break;case 'html':if(this.bM[a])r=VM.Base.HtmlPanel.inst(this.id,a);break;case 'page':r=VM.Base.PagePanel.inst(this.id,a);break;case 'flow':r=VM.Base.FlowPanel.inst(this.id,a);break;case 'set':r=VM.Base.SetPanel.inst(this.id,a);break;case 'film':r=VM.Base.FilmPanel.inst(this.id,a);break;case 'src':r=new VM.Base.SrcPanel(this.id,a);break;default:for(var i=0;i<this.length;i++){if(this[i].frid==a){return this[i];}else if(this[i].length){for(var j=0;j<this[i].length;j++)if(this[i][j].frid==a)return this[i][j]}}break;}}break;}return r;},findAll:function(a){return this.find('.//fr[contains(@id,"'+a+'")]',DFish.XPATH);},panel:function(){return this.find.apply(this,arguments);},input:function(){return this.f.apply(this,arguments);},button:function(a){var e=this.xt('static//b[@id="'+a+'"]/ancestor::fr[@type="oper"]/@id');return e?((e=this.find(e))&&(e=e.get(a))):Fn.Oper.get(a);},go:function(a,b,s){var c=this.xfr(a);if(c){var d=c.parentNode,e=b||$.xt(c,'@src'),f,g=d.getAttribute('scroll');if(d.getAttribute('type')==='film'){f=this.bM[d.getAttribute('id')]||this.bM[a].parentNode;f.ho=a;if(c.getAttribute('type')!=='src'||(!b&&this.hS[a]&&($.xi(c,'@cache')&&f.get(a)))){d=f.get(a);if(!d&&(d=this.bM[a])&&(d.parentNode==f))f.setpk(d,a);return f.view(d);}}else f=this.bM[a];if(e.indexOf('javascript:')===0)e=eval(e);VM.go(f,e,a,this,g,c.getAttribute('onload'),c.getAttribute('global')==1,c.getAttribute('cache')==1,c.getAttribute('independent')==1,s);}},dB:function(){var b;for(var i=this.length-1;i>=0;i--)if(this[i].ba){if(!b){for(var i=0;i<this.length;i++)this[i].fireEvent('beforecheck');}b=true;if(this[i].dB())return true;}return false;},$:function(a){if(this._disposed)return null;return a?(this.div&&this.div.ww?this.div.ww.document.getElementById(a):$(a)):(this.div&&this.div.$());},f:function(a,b,c){if(a==null)return;if(a.indexOf(',')>-1){a=a.split(',');for(var i=0,d=[];i<a.length;i++)d.push(this.f(a[i],b,c));return d;}var bv=this.b_vm,pt=bv?'static':'.',d=this.$(this.id+'-'+a),e=this.x(pt+'//i[@n="'+a+'"]'),f=null,tp=e&&e.getAttribute('tp'),iS=b==DFish.GET_VALUE,iV=b==DFish.SET_VALUE,iR=b==DFish.GET_TEXT,iT=b==DFish.RESET,iU=b==DFish.RESIZE,_rd=b==DFish.READONLY;if(b==DFish.XML)return e;if(c!=null&&e){switch(b){case DFish.HIDDEN:var k=VM(g,1).aW,h=this.f(a),g=h&&(typeof h.$=='function'?h.$():h),f=this.x(pt+'//i[@n="'+a+'" and parent::ipts/parent::i/@tp="horizontalgroup"]');Q(g).closest(f?'td':'tr.tr').toggle(!c);if(k)k.uncheck(a,h);return;case DFish.ADD_VALID:var f=$.x(e,'vlds');if(!f)f=$.x_add(e,'vlds');if(!js.isArray(c))c=[c];for(var i=0;i<c.length;i++)$.x_add(f,'v','','',c[i]);return;case DFish.MODIFY_VALID:var f=$.x(e,'vlds');if(!f)f=$.x_add(e,'vlds');if(!js.isArray(c))c=[c];for(var i=0,j,g;i<c.length;i++){g=$.xs(f,'v[@vld="'+c[i].vld+'"]');for(j=0;j<g.length;j++)$.attr(g[j],c[i]);}return;case DFish.REMOVE_VALID:var f=$.x(e,'vlds');if(!f)f=$.x_add(e,'vlds');if(!js.isArray(c))c=[c];for(var i=0,j,g;i<c.length;i++){g=$.xs(f,'v[@vld="'+c[i].vld+'"]');for(j=g.length-1;j>-1;j--)$.xrm(g[j]);}return;case DFish.NOTNULL:var h=this.id+'-'+a+'-title',m=$(h),k=$.xs(e,'vlds/v[@vld="default"]');if(m)m.innerHTML=m.innerHTML.replace(/:[^:]+$/,':'+(c?'<span class=mx-star>*</span>':'&nbsp;'));if(k.length){for(var i=0;i<k.length;i++)arguments.callee.call(this,a,DFish.MODIFY_VALID,{vld:'default',ntn:c?1:''});}else{k=$.xt(e,'vlds/v/@vld');arguments.callee.call(this,a,DFish[k?'MODIFY_VALID':'ADD_VALID'],{vld:k||'default',ntn:c?1:''});}return;}}if(!(this.vis)&&b){if(e){var v=e&&$.xt(e,'@v');if(tp==='button'||(tp==='textarea'&&!v)){if(iS)v=e.text;if(iV)e.text=c;}else if(tp==='plugin'){if(iS)v=$.xt(e,'value');if(iV)$.x(e,'value').text=c;}else if(tp==='dateperiod'&&$.xt(e,'@n1')===a){if(iS)v=$.xt(e,'v1');if(iV)e.setAttribute('v1',c);}if(iS)return v;}}if(iS&&!d&&e&&e.parentNode.tagName==='hidden'){return e.getAttribute('v');}if(!tp){e=this.x('static//i[@n1="'+a+'"]');if(e)tp=e.getAttribute('tp');else{if(this.vis){f=$.ns(a,this.$());if(f&&f.length){d=f[0];tp=d.type;}}else{return;}}}if(b==DFish.DISABLE){if(f&&f.length){for(var i=0;i<f.length;i++)VM.MX.ds_x(this.id,f[i],c==null?true:c);}else if(e)VM.MX.ds_x(this.id,e,c==null?true:c);return;}switch(tp){case 'radio':case 'checkbox':case 'radiogroup':case 'checkboxgroup':if(iS||iR)return $.f_vals(this.$(),a);if(!f)f=$.ns(a,this.$());if(iV||iT){for(var i=0;i<f.length;i++){f[i].checked=iT?f[i].defaultChecked:js.ids_inc(c,f[i].value);if(tp.indexOf('group')>-1){VM.MX.grpclk(this.id,f[i]);}else if(tp.indexOf('group')>0&&f[i].onclick)f[i].onclick();}}return b==DFish.FIRST?f[0]:f;break;case 'select':case 'select-one':case 'select-multiple':if(iS){return $.f_vals(this.$(),a)||d.value||'';}else if(iR){var f=this.f_els(this.$(),a)[0];if(f)return f.type=='select-one'?f.options[f.selectedIndex].text:js.map(f.options,'v.text').join(',');}else if(iV||iT){for(var i=0;i<d.length;i++)d[i].selected=iT?d[i].defaultSelected:js.ids_inc(c,d[i].value);}break;case 'xbox':return Fn.XBox.get(this.id,a,b,c);break;case 'imgbox':return Fn.ImgBox.get(this.id,a,b,c);break;case 'combobox':return Fn.Combox.get(this.id,a,b,c);break;case 'olbox':return Fn.OLbox.get(this.id,a,b,c);break;case 'pickbox':return Fn.Pickbox.get(this.id,a,b,c);break;case 'plainbox':return Fn.PlainBox.get(this.id,a,b,c);break;case 'file':return VM.MX.File.get(this.id,a,b,c);break;case 'label':if(!d)return;if(iS||iR)return e.text;if(iV)d.innerHTML=e.text=c;else if(iU)VM.MX.gk(d,c);break;case 'button':if(!d)return null;if(iS||iR)return d.children[1].innerHTML;if(iV)d.children[1].innerHTML=c;break;case 'plugin':for(var i=0,g;i<this.length;i++)if(this[i].fy&&(g=this[i].fy[a]))break;return b?g.callSettings(b===true?DFish.GET_VALUE:b,c):g;break;default:if(!d)return;var g=b&&('getAttribute' in d)&&d.getAttribute('df_gray')==1;if(iS||iR){return g?'':d.value;}else if(iV){if(g)VM.MX.grayfocus(d);d.value=c;}else if(iT){d.value=e?e.getAttribute('v'):d.defaultValue;if(e&&e.getAttribute('graytip'))VM.MX.grayblur(d);}else if(iU){VM.MX.gk(d,c);}break;}return d||false;},fv:function(a){if(a){var e=this.f(a,DFish.GET_VALUE);return e==null?'':e;}},ft:function(a){return this.f(a,DFish.GET_TEXT)||'';},fs:function(a,b){return this.f(a,DFish.SET_VALUE,b);},resetForm:function(a,b,c){var e=this.xs('static//'+(a?'fr[@id="'+a+'"]//':'')+'i');for(var i=0;i<e.length;i++){this.f(e[i].getAttribute('n'),b||DFish.RESET,c!=null?c:e[i].getAttribute('v'));}},fmul:function(a,b){return $.f_mul(this.id+'-form',a,null,b);},gf:function(a,b){var c=this.hS[a],d=this.xfr(a),e=null;if(c){e=c.vis?c.film.nodeIndex:$.xp(d);c.remove();}if(c=this.bM[a]){e=e==null?c.nodeIndex:e;this.reset(a);if(d){if(b){if(Br.chm)b=b.cloneNode(true);d.parentNode.replaceChild(b,d);VM.jser.en(b);}else d.parentNode.removeChild(d);}c.remove();}return e;},ps:function(a,b){var id=this.id;return a.replace(/<var [^>]+>[\s\S]+?<\/var>/gi,function($0){var x=$.x_doc($0),t='',p;if(x){p=VM._a[id].x('/view/parsers/*[@id="'+(b||x.getAttribute('data-parser'))+'"]');if(p){var u=p.getAttribute('type')==='js',q=p.text,r=$.xs(x,'d'),i=0,l=r.length;if(u)eval('q='+q);for(;i<l;i++)t+=u?q.call(VM._a[id],r[i]):VM.iH(q,r[i]);}}return t})},cmd:function(a){return this.exec(a,arguments.length>1?js.argu(1):null);},exec:function(a,d,x){if(this._disposed)return;var b=a,c=this.id;if(!this.vis){this.addEventOnce('render',function(){VM.prototype.exec.call(VM._a[c],a,d,x)});return;}if(typeof a!=='object'){if(String(a).charAt(0)==='<'){return arguments.callee.call(this,$.x_doc(a),x,d);}var tmp='commands//*[@id="'+b+'"]';b=this.x(tmp)||(this.mand&&this.mand.x(tmp));}if(!b){DFish.debug(4,this.path.slice(0,-1)||'/',a);return;}var e='v',l=d?d.length:0,x=VM.bj(b,x,d);switch(b.tagName){case 'cmd':var f=x.id;if(x.delay||x.repeat){if(!this.hA)this.hA={};if(!f)b.setAttribute('id',f=js.uid());if(this.hA[f]){clearInterval(this.hA[f]);clearTimeout(this.hA[f]);}x.delay=js.m(x.delay);x.repeat=js.m(x.repeat);this.hA[f]=setTimeout(function(){VM.bi(c,b,d);if(x.repeat&&VM._a[c]&&VM._a[c].hA)VM._a[c].hA[f]=setInterval(function(){VM.bi(c,b,d);},x.repeat);},x.delay);}else if(x.stop){if(this.hA){clearInterval(this.hA[f]);clearTimeout(this.hA[f]);}}else{if(x.record){if(Br.ie)VM.fT([c,b,d]);}if(x.path){var h=x.path;if(h.indexOf('javascript:')===0)h=eval(h);if(h)h=h.replace(/\/$/,'');var g=VM(h||'/');if(g){a=b.cloneNode(true);a.removeAttribute('path');g.cmd.apply(g,arguments);}}else VM.bi(c,b,d);}break;case 'break':throw DFish.BREAK;break;case 'js':var f='$0,$1,$2,$3,$4,$5,$6,$7,$8,$9';if(l>10){for(var i=11;i<l;i++)f+=',$'+i;}Function(f,b.text).apply(this,d||js.A);break;case 'ajax':if(x.once==1&&('getAttribute' in b)&&b.getAttribute('onced_')==1){DFish.alert(Loc.submiting,0,4);return;}if(x.loading)this.cmd({tagName:'loading',msg:x.loading==1?'':x.loading});this.jb(x,d,l);if(x.once==1&&('setAttribute' in b))b.setAttribute('onced_',1);break;case 'submit':if(x.once==1&&('getAttribute' in b)&&b.getAttribute('onced_')==1){DFish.alert(Loc.submiting,0,4);return;}if(this.show_red_error(a,d,x))return;if(x.loading)this.cmd({tagName:'loading',msg:x.loading==1?'':x.loading});var f=this.fmul(true),n=this.cS(x.frs);if(f){var h=js.find(f.firstChild.children,'v.value');if(h){if(x.frs){for(var i=0,o=[];i<n.length;i++)o.push.apply(o,js.map($.f_els(n[i])));}f.lastChild.innerHTML=js.map(x.frs?o:$.f_els(n),function(v,i){var t=v.type;if(v.type=='password'){return '<input name='+v.name+' value="'+js.s_quot(v.value)+'">';}else if(t=='radio'||t=='checkbox'||t=='select-one'){return '<input type='+t+' name='+v.name+' value="'+js.s_quot(v.value)+'"'+(v.checked?' checked':'')+'>';}else{return '<textarea name='+v.name+'>'+v.value+'</textarea>';}}).join('');var k=x.src;if(k.length>350){var m=js.s_fr(k,'?').split('&'),s=[];for(var i=0;i<m.length;i++){if(m[i].indexOf('=')>0)s.push('<textarea name='+js.s_to(m[i],'=')+'>'+js.s_fr(m[i],'=')+'</textarea>');}$.append(f.lastChild,s.join(''));k=js.s_to(k,'?');}f.action=k;f.submit();return;}}this.jb(x,d,l,this.getPostData(x.frs,n));if(x.once==1&&('setAttribute' in b))b.setAttribute('onced_',1);break;case 'menu':if(l&&x.appvar==1)b=VM.fH(b);Fn.Oper.mapToMenu(new Fn.Menu(x&&x.owner?x.owner:this,d),$.x_json(b).nodes).show();break;case 'dialog':var g=null;if(b.nodeType===1){if(l){b=VM.fH(b,d,!0);if(!x.args)x.args=l==1?d[0]:d;}}var t=x.tpl||Cfg.dg_dft_tpl;f=VM.da(t,b,this.id);if(f){if(!x.src&&b.nodeType===1)x.src=$.x(b,'*');if(typeof x.src==='string'){if(x.src.indexOf('javascript:')===0){x.src=eval(x.src);}}x.fromView=this;if((!x.pos||x.pos=='0')&&x.slide==null)x.slide=Cfg.dg_slide;return new Fn.Dialog(x,f).render();}else{DFish.debug(1,'',t);}break;case 'loading':if(Cfg.plus){this.showLoading(x.hide!=1);break;}var f=VM.da(x.tpl||Cfg.dg_dft_tpl,b,this.id),g='_loading_dialog',h=VM[g];if(x.hide==1||(h&&(h._disposed||!x.pc||!h.x.pc))){if(h){h.close();delete VM[g];}}if(x.hide==1)break;if(!x.poper)x.poper=this.$();if(!x.w||!x.h){x.w=f&&x.pc?300:180;x.h=f&&x.pc?100:70;}if(!x.top&&!x.left){var k=$.bcr(this.$());x.top=((k.top+k.bottom)/2)-(x.h/2);x.left=((k.left+k.right)/2)-(x.w/2);}if(f&&x.pc){var w=x.w-40,v=Math.floor(w*js.m(x.pc)/100);if(h){if($(g+'-pt')){$(g+'-pt').style.width=v+'px';$(g+'-msg').innerHTML=x.msg;$(g+'-bg').innerHTML=$(g+'-bt').innerHTML=x.pt;}else{delete VM[g];}}else{x.fromView=!x.pos||x.pos=='0'?this:VM();x.t=x.t||Loc.opertip;x.cn='<table width=100% height=100% class=bg-lower><tr><td><div class=dlg-progress style="width:'+w+'px"><div class=prg_msg id='+g+'-msg>'+x.msg+'</div><div class="prg_bar bd-mid bg-lower"><div class=prg_btm id='+g+'-bt>'+x.pt+'</div><div class=prg_pt id='+g+'-pt style="width:'+v+'px"><div class=prg_bg id='+g+'-bg style="width:'+w+'px">'+x.pt+'</div></div></div></div></table>';VM[g]=new Fn.Dialog(x,f).render();}}else{x.fromView=this;x.cn='<div>'+VM.ep('class="bd-low white"'+(Br._ie7?'':' style=height:70px'),x.msg||Loc.loading,'bd-none')+'</div>';VM[g]=new Fn.Dialog(x).render();}break;case 'alert':case 'confirm':var f=VM.da(x.tpl||Cfg.dg_alert_tpl||Cfg.dg_dft_tpl,b,this.id),g=b.tagName==='alert',h=$.eid('e'),o=DFish.oper({func:'office',face:'o-office'}),s='with(DFish.g_dialog(this)){';if(f){x.fromView=g?VM():this;x.t=x.t||Loc.opertip;if(!x.w||!x.h){var r=Fn.Dialog.s_rec(x.cn&&x.cn.replace(/\\n|<br[^>]*>/gi,'\n'),f);x.w=r[0];x.h=r[1];}x.src=function(v){var a=v.addset('rows=*,50','class=dlg-box','',0,5);a.add('','margin-top:5px;overflow:auto',0,5).data('<table cellspacing=0 cellpadding=0 style="table-layout:fixed;margin:6px 20px 0 10px;"><tr><td width=85 style="background:url('+(x.ic||(Cfg.imgp+'alert-'+(g?'warn':'ask')+'.gif'))+') no-repeat center 3px"><td valign=top height='+(x.h-110)+'><div style="padding:0 2px 0 0" class=wdbr>'+(x.cn?x.cn.replace(/\n|\\n/g,'<br>'):'')+'</div></table>');o.add({t:'   '+Loc.confirm+'   ',clk:s+(g?'':'args().yes();')+'close()}',main:true});if(!g)o.add({t:'   '+Loc.cancel+'   ',clk:s+(g?'':'args().no();')+'close()}'});a.add('','padding-top:3px;',0,3).data('<div style="text-align:center">'+o.html()+'</div>');};x.relay=true;x.transit=!g;x.independent=x.pos&&x.pos!='0';x.poper=this.$();var r=new Fn.Dialog(x,f);r.render();if(g){if(x.tm){setTimeout(function(){r.close()},x.tm*1000);}}else{if(x.args){x.args={yes:js.bind(x.args,this),no:js.K};}else{x.args={yes:function(){if(x.fnYes)x.fnYes();else if(!x.fnType)for(var i=0,f=$.xs(b,'yes/*'),l=f.length;i<l;i++)VM.prototype.cmd.apply(VM(c),[f[i]].concat(d));},no:function(){var f=!x.fnType&&$.xs(b,'no/*');if(x.fnNo||f.length){if(x.fnNo)x.fnNo();else if(!x.fnType)for(var i=0,l=f.length;i<l;i++)VM.prototype.cmd.apply(VM(c),[f[i]].concat(d));}}}}}}else{if(g){alert(x.cn);}else{if(confirm(x.cn)){if(x.fnType){if(x.fnYes)x.fnYes();}else{for(var i=0,f=$.xs(b,'yes/*'),l=f.length;i<l;i++){VM.prototype.cmd.apply(VM(c),[f[i]].concat(d));}}}else{if(x.fnType){if(x.fnNo)x.fnNo();}else{for(var i=0,f=$.xs(b,'no/*'),l=f.length;i<l;i++){VM.prototype.cmd.apply(VM(c),[f[i]].concat(d));}}}}}break;case 'insert':if(!b.childNodes.length)return;b=b.cloneNode(!0);if(Br.w3c&&b.ownerDocument&&b.ownerDocument!=this.xml.ownerDocument)b=Fn.Dom.importNode(this.xml,b);if(l&&x.appvar==1)b=VM.fH(b,d);var f=b.getAttribute('target'),g=b.getAttribute('where'),h,k;switch(b.getAttribute('type')){case 'commands':case 'parsers':VM.x_mrg(this.xml,b,b.getAttribute('type'));break;case 'oper':var m=$.x(b,'b'),n,o=null,p=m.getAttribute('id'),q=g=='afterbegin'||g=='beforebegin';if(h=this.find(f)){n=this.xfr(f);if(q)o=n.firstChild;}else{k=this.x('static//fr[@type="oper"]//b[@id="'+f+'"]');if(q)o=k;if(k){n=$.x(k,'ancestor::fr[@type="oper"]');h=this.find(n.getAttribute('id'));}else{if(k=this.button(f)){k.add($.x_obj(m));}}}if(h){if(p&&n&&(p=$.x(n,'.//b[@id="'+p+'"]')))$.xrm(p);n.insertBefore(m,o);h.x_ins(m,g,k&&f);}break;case 'panel':var h=this.bM[f],k=this.xfr(f),m=$.x(b,'fr'),n=m.getAttribute('id'),i;if(!k){return;}if(n){if(n==f){b.tagName='update';return this.cmd(b);}if(this.bM[n])this.gf(n,m);}if(k.getAttribute('type')=='film'&&!m.getAttribute('load')){m.setAttribute('load',0);}var s=b.getAttribute('animate');if(s){var t=m.getAttribute('style'),u=';display:none';m.setAttribute('style',t?t+';'+u:u);}if(g=='beforeend'){k.appendChild(m);if(h)i=this.frame2div(h,m);}else if(g=='afterbegin'){k.insertBefore(m,k.firstChild);if(h)i=this.frame2div(h,m,0);}else if(g=='beforebegin'){k.parentNode.insertBefore(m,k);if(h&&h.parentNode)i=this.frame2div(h.parentNode,m,h.nodeIndex);}else if(g=='afterend'){k.parentNode.insertBefore(m,k.nextSibling);if(h&&h.parentNode)i=this.frame2div(h.parentNode,m,h.nodeIndex+1);}if(h&&h.parentNode)this.show(i,m);if(s){Q(i.$())[s==='slide'?'slideDown':'fadeIn']('fast');}break;case 'form':var b1=(h=VM.MX.cT(this,f)),b2=!b1&&(h=this.find(f))&&h.type=='mx',b3=!b1&&!b2&&this.f(f),k=$.xs(b,'i'),m=b1?VM(h,!0):(b2?h:null),p=g.indexOf('end')>0;if(b1||b2){var o=b2?this.x('.//fr[@type="mx" and @id="'+f+'"]/form'):this.x('.//fr[@type="mx"]/form//i[@n="'+f+'"]'),n=b1?$.pel(h,'TABLE'):h.$('cont'+($.x(o,'tab')?'0':'')),r=js.map($.xs(b,'.//i[@on="1"]')),q=b2?null:$.pel(this.f(f),'TABLE'),s=m.hp(b,js.m(n.minus),q&&q.getAttribute('ikcols')),t=b2&&$.x(o,'tab')?$.x(o,'tab'):o.parentNode;while(k.length){t.insertBefore(k[(b1&&p)||(b2&&!p)?k.length-1:0],b1?(p?o.nextSibling:o):(p?null:t.firstChild));k=$.xs(b,'i');}o=$.div(s);q=o.firstChild.tBodies[0].rows;if(b2){t=n.children[p?n.children.length-1:0];if(!t||t.tagName!='TABLE')n.insertBefore(o.firstChild,p?null:t);else n=t;}if(b1||n==t){while(q.length)n.tBodies[0].insertBefore(q[(b1&&p)||(b2&&!p)?q.length-1:0],b1?(p?h.nextSibling:h):(p?null:(n.tBodies[0].rows[0]||null)));}$.rm(o.firstChild);if(q=o.innerHTML){$.after(n,q);}$.rm(o);js.remove(m.hq,k);m.fireEvent('render');m.atchev(r);}else{}break;case 'row':var h=this.find(f),m=js.map($.xs(b,'d'));if(!h)return;g=g?(isNaN(g)?js.parseJSON(g):js.m(g)):null;h.insertRow(m,g);break;}this.fireEvent('modify');break;case 'update':if(!b.childNodes.length)return;b=b.cloneNode(!0);if(Br.w3c&&b.ownerDocument&&b.ownerDocument!=this.xml.ownerDocument)b=Fn.Dom.importNode(this.xml,b);if(l&&x.appvar==1)b=VM.fH(b,d);var f=b.getAttribute('target');switch(b.getAttribute('type')){case 'commands':case 'parsers':VM.x_mrg(this.xml,b,b.getAttribute('type'));break;case 'oper':var m=$.x(b,'b'),k=m.getAttribute('id');n;if(f&&(h=this.find(f))){n=this.xfr(f);if(k)k=$.x(n,'b[@id="'+o+'"]');}else{if(k=this.x('static//fr[@type="oper"]//b[@id="'+(f||k)+'"]')){n=$.x(k,'ancestor::fr[@type="oper"]');h=this.find($.xt(n,'@id'));}}if(h){if(k)n.replaceChild(m,k);h.x_upd(m,g,k&&f);}break;case 'panel':var g=$.x(b,'fr'),h=f||g.getAttribute('id'),m=this.bM[h];if(m){var dv=this.frame2div(m.parentNode,g,this.gf(h,g));this.show(dv,g);}break;case 'form':if(!f)f=$.xt(b,'i/@n');var b1=(h=VM.MX.cT(this,f)),b3=!b1&&this.f(f);if(!b1&&!b3)break;var g=b.getAttribute('where'),m=VM(h||b3.parentNode,!0),n=b1?$.pel(h,'TABLE'):null,p=g&&g.indexOf('end')>0;var hs=$.xs(b,'i[@tp="hidden"]'),hl=hs.length;if(hl){hs=js.map(hs);var q=this.x('static//i[@n="'+f+'"]/parent::*');for(var i=0,s=[],o,r=m.parentNode;i<hl;i++){o=$.x_obj(hs[i]);s.push('<input type=hidden name='+o.n+' id='+r.id+'-'+o.n+' value="'+js.s_quot(o.v)+'">');this.cmd({tagName:'delete',type:'form',target:o.n});q.appendChild(hs[i].cloneNode(true));}$.after($(m.id+'-tbl-0'),s.join(''));}var k=$.xs(b,'i');if(b1){if(m.type=='lb'){var o=this.x('static//d/c/i[@n="'+f+'"]'),p=o.parentNode;$.replaceWith(o,k[0]);var r=m.eK(p.parentNode,0);m.virmx.removeEventByName(f);m.virmx.aW.rm(f);var q=this.f(f);Q(q).closest('.txwrp').replaceWith(m.cf(r,js.m(js.s_to(p.getAttribute('crd'),','))));if(typeof q.dispose=='function')q.dispose();m.virmx.atchev([k[0]]);m.virmx.fireEvent('render');}else{m.removeEventByName(f);m.aW.rm(f);var o=this.x('static//i[@n="'+f+'"]'),r=js.map($.xs(b,'.//i[@on="1"]')),q=this.f(f),t=$.xs(o,'.//i'),s=$.pel(q,'TABLE').getAttribute('ikcols');if(typeof q.dispose==='function')q.dispose();if(t.length){for(var i=t.length-1;i>-1;i--)this.cmd({tagName:'delete',type:'form',target:t[i].getAttribute('n'),bL:1});}s=m.hp(b,js.m(n.minus),s);while(k.length){o.parentNode.insertBefore(k[p?k.length-1:0],p?o.nextSibling:o);k=$.xs(b,'i');}$.xrm(o);o=$.div(s);q=o.firstChild.tBodies[0].rows;s=h.nextSibling;js.remove(m.hq,k);$.rm(o);$.xrm(h);while(q.length)n.tBodies[0].insertBefore(q[p?q.length-1:0],p?(s&&s.nextSibling):s);m.fireEvent('render');m.atchev(r);}}else if(k.length){var o=this.x('static//i[@n="'+f+'"]'),p=o&&o.parentNode;if(m&&o){var q=this.f(f);$.replaceWith(o,k[0]);m.removeEventByName(f);m.aW.rm(f);if(q.tagName.toLowerCase()==='table')Q(q).replaceWith(m.iHtml(k[0],null,f));else Q(q).closest('SPAN.txwrp').replaceWith(m.iHtml(k[0],null,f));if(typeof q.dispose=='function')q.dispose();var t=p.parentNode.getAttribute('tp');if(t==='radiogroup'||t==='checkboxgroup'){var td=Q(this.f(k[0].getAttribute('n'))).closest('tr').first();td.find('label').html(k[0].getAttribute('t'));VM.MX.ds_x(m.id,k[0],!td.find('input')[0].checked);}}}break;case 'row':var g=b.getAttribute('where'),h=this.find(f),m=js.map($.xs(b,'d'));if(!h)return;g=g?(isNaN(g)?js.parseJSON(g):js.m(g)):null;h.updateRow(m,g);break;}this.fireEvent('modify');break;case 'delete':if(l&&x.appvar==1){b=b.cloneNode(!0);if(Br.w3c&&b.ownerDocument&&b.ownerDocument!=this.xml.ownerDocument)b=Fn.Dom.importNode(this.xml,b);b=VM.fH(b,d);}b=$.x_obj(b);var f=b.target,h,k;switch(b.type){case 'oper':h=this.x('static//b[@id="'+f+'"]');k=h&&h.parentNode;if(k&&k.getAttribute('type')=='oper'){k=this.find(k.getAttribute('id'));if(k&&(k=k.get(f))){$.xrm(h);k.remove();}}break;case 'panel':this.gf(f);$.xrm(this.xfr(f));break;case 'form':var o=this.f(f,DFish.FIRST),h=VM.MX.cT(this,f),k=this.x('.//fr[@type="mx"]//i[@n="'+f+'"]'),m=VM(o,!0),n;if(k&&(n=$.xs(k,'.//i'))&&n.length){for(var i=n.length-1,j;i>-1;i--){if(j=n[i].getAttribute('n'))this.cmd({tagName:'delete',type:'form',target:j,bL:1});}}if(m){if(m.aW)m.aW.rm(f);if(m.removeEventByName)m.removeEventByName(f);}if(o&&typeof o.dispose==='function'){n=o.$();o.dispose();o=n;}if(!b.bL){if(h&&(!k||!$.x(k,'parent::i[@tp="horizontalgroup"]'))){var q=h.offsetParent,p=q.style.height;if(p&&js.m(p))q.style.pixelHeight-=h.offsetHeight;$.rm(h);h=q=null;}else if(o){if(o.parentNode.tagName==='SPAN')o=o.parentNode;$.rm(o);}}if(k)$.xrm(k);m=o=n=k=null;break;case 'row':var g=b.where,h=this.find(f);if(h){g=g==''?null:(isNaN(g)?js.parseJSON(g):js.m(g));h.deleteRow(g);}break;}this.fireEvent('modify');break;case 'x':break;}return;},cS:function(a){for(var i=0;i<this.length;i++)this[i].fireEvent('submit');var n=a?[]:this.$();if(a){for(var i=0,k=a.split(','),m;i<k.length;i++){m=this.bM[k[i]];if(m)n.push(m.$());}}return n;},getPostData:function(a,n){if(!n){for(var i=0;i<this.length;i++)this[i].fireEvent('beforecheck');n=this.cS(a);}if(a){for(var i=0,o=[];i<n.length;i++)o.push($.f_vals(n[i]));}return a?o.join('&'):$.f_vals(n);},jb:function(x,d,l,t){if(x.beforeSend){if(js.call(x.beforeSend,this)===false)return}if(t&&x.data){if(typeof x.data==='object'){for(var i in x.data)t+='&'+i+'='+js.url_esc(x.data[i]);}else t+='&'+x.data;}this.ajax(x.src.replace('vm:|',''),function(v){if(this._disposed)return;if(x.hdl){x.hdl(v,x);}else{if(v!==false)this.exec(v,d,x.args);}if(x.loading)try{this.cmd({tagName:'loading',hide:1})}catch(e){};if(x.complete)js.apply(x.complete,this,d);},t||x.data,x.sync==1,x.error&&js.bind(x.error,this),x.method);var f=x.event||window.event;if(f&&f.type)Fn.Event.setev(f.clientX,f.clientY);},show_red_error:function(a,d,x){var g=$.query('span.txwrpwarn',this.$());for(var i=0;i<g.length;i++)$.class_del(g[i],'txwrpwarn');g=this.g_form_error(x);if(this.gG)this.gG.enable(g.length===0);if(g.length){DFish.alert(g,0,4,null,this);for(var i=0,f,h,p,q;i<g.length;i++){h=g[i];if(h&&h.n&&(f=this.f(h.n))){if(typeof f.$==='function')f=f.$();p=f.parentNode;if(!p)p=f[0]&&f[0].parentNode;if(p){if(h.tp==='radio'||h.tp==='checkbox'){p=p.parentNode;if(!Br.ie8)p=p.parentNode;}else if(h.tp=='select'&&Br.ie&&Br.ieVer<8){p=p.parentNode;}$.class_add(p,'txwrpwarn');if(!q){var r=VM(p,true),s,t=this.xs('static//fr[@id="'+r.frid+'"]/ancestor-or-self::fr[../@type="film"]');for(var j=0;j<t.length;j++){var u=t[j].parentNode.getAttribute('id');v=this.find(u).id2index(t[j].getAttribute('id'));w=this.xt('static//fr[@type="oper" and @film="'+u+'"]/@id'),y=js.find(this.find(w),'v.nodeIndex=='+v,true);if(y)y.clk();}q=true;}}}}return true;}if(this.gG){this.gG.args(arguments);if(this.gG.show_error())return true;}},g_form_error:function(x){for(var i=0;i<this.length;i++)this[i].fireEvent('beforecheck');if(!x)x=false;var a=x.vld||'default',b=x.frs,c,d=[];if(x.uncheck==1)return d;if(b)c=b.split(',');for(var i=0,f,g;i<this.length;i++){f=this[i];if(f.g_form_error){if(c){for(var j=0;j<c.length;j++){if(c[j]==f.frid||this.x('.//fr[@id="'+c[j]+'"]//fr[@id="'+f.frid+'"]'))break;}if(j==c.length)continue;}if(g=f.g_form_error(a))d.push.apply(d,g);}if(g=arguments.callee.call(f,x))d.push.apply(d,g);}return d;},reset:function(a){var b=this.fmul(true);if(b)b.firstChild.innerHTML=b.lastChild.innerHTML='';var c=a&&[],d=a&&this.xfr(a);if(a){for(var i=0;i<this.length;i++)if(!!this.xfr(this[i].frid,d))c.push(this[i]);}for(var i=(c||this).length-1;i>-1;i--){(c||this)[i].dispose();}for(var i in this.hS){if((!a||!!this.xfr(i,d))&&!this.hS[i].isGlobal&&!this.hS[i].independent){this.hS[i].dispose();delete this.hS[i];}}if(a){if(d){c=$.xs(d,'.|.//fr[@id]');for(var i=0;i<c.length;i++){d=c[i].getAttribute('id');if(d&&(d in this.bM))delete this.bM[d];}}else delete this.bM[a];}else{if(this.hA){for(var i in this.hA){clearInterval(this.hA[i]);clearTimeout(this.hA[i]);delete this.hA[i];}this.hA=null;delete this.hA;}if(this.opcs)for(var i in this.opcs){this.opcs[i].dispose();delete this.opcs[i];}for(var i in this.bM)delete this.bM[i];if(this.ca){this.ca=null;}Fn.Event.removeAllEvents(this);this.vis=false;}},remove:function(){if(this._disposed)return;if(this.contdiv)this.contdiv.remove();this.dispose();},dispose:function(){if(this._disposed)return;this.fireEvent('remove');for(var i in this.hS){if(VM.jp[i])delete this.hS[i];else this.hS[i].dispose();}if(this.parent&&this.parent.hS)delete this.parent.hS[this.pkid];if(this.al){this.al.abort();delete this.al;}if(this.jq){for(i in this.jq)delete this.jq[i];delete this.jq;}this.reset();$.rm(this.id+'-form');delete VM._a[this.id];for(var i in VM.jc){if(VM.jc[i]==this){delete VM.jc[i];break;}}this.film=this.contdiv=this.div=this.xml=this.bM=this.parent=this.hS=this.opcs=null;delete this.film;delete this.contdiv;delete this.div;delete this.bM;delete this.xml;delete this.parent;delete this.hS;delete this.opcs;this.removeNode();}}});Fn.fW('VM.Base',{Const:function(a,b){this.frid=a.getAttribute('id');if(!this.frid)this.xml=a;this.id=VM.g_id();return VM._a[this.id]=this;},Extend:[Fn.EventNode],Prototype:{vis:false,vm:function(){var a=this;while(a=a.parentNode)if(a.type=='vm')return a;},aos:function(a){if(a){var b=this.x('ancestor::fr[@type="'+a+'"]').getAttribute('id'),c=this.aos();for(var i=0;i<c.length;i++)if(c[i].frid==b)return c[i];}return this.parentNode||this;},ajax:function(a,b,c,d,e,f,g){if(a.indexOf('javascript:')===0)a=eval(a);Ajax.gB(a,b,c,d,true,e,true,this,this,null,f,g);},x:function(a){var x=this.xml;if(!x){var p=this;while(p&&p.type!=='vm')p=p.parentNode;if(p&&p.xml)x=p.xml.selectSingleNode('(static|vir)//fr[@id="'+this.frid+'"]');}return a?(x&&x.selectSingleNode(a)):x;},xs:function(a){return this.x().selectNodes(a);},xt:function(a){return $.xt(this.x(),a);},xi:function(a){return $.xi(this.x(),a);},xfr:function(a,b){return b?$.x(b,'descendant-or-self::fr[@id="'+a+'"]'):this.x('(static|vir)//fr[@id="'+a+'"]');},ext:function(a){if(!this.ca)this.ca={};if(arguments.length>1)this.ca[a]=arguments[1];return this.ca[a]},resize:function(w,h){if(!this._disposed&&this.contdiv)Fn.Div.resizeTo(this.contdiv,w,h);},isBottom:function(){var a=this.dataDiv();if(a&&a.$()){var h=a.$().scrollHeight;return h&&a.$().scrollTop+a.$().clientHeight===a.$().scrollHeight;}},on:function(a,b){var e=this.dataDiv();if(!e||!e.$())return;b=js.bind(typeof b==='string'?Function(b):b,this);if(a==='bottom'){b=DFish.delay(b,100,true);var s,u=function(t){if(!e._disposed){s=e.scrollTop();var h=$(e.id+':cont').scrollHeight;if(h>0){if(Br.mobile){if(e.ht+s===h)b();}else if(s+$(e.id+':cont').clientHeight===h)b();}}};this.addEvent(a,u);$.e_add($(e.id+':cont'),'scroll',u);u.gd=function(){t=null;setTimeout(u)};e.addEvent('resize',u.gd);this.vm().addEvent('modify',u.gd);this.vm().addEventOnce('render',u);e.addEvent('remove',function(){$.e_remove($(e.id+':cont'),'scroll',u);this.vm().removeEvent('modify',u.gd);this.vm().removeEvent('render',u);},this);}else if(a==='drag'){e.addEvent(a,b);}else if(a==='pull'){if(!Br.mobile)return;(function(){var x,y,c=$(e.id+':cont'),d;$.e_touch(c,function(){var t=event.touches[0];x=t.pageX,y=t.pageY;},function(){var h=event.touches[0].pageY-y;if(h>0){if(d){if(h<50){d.style.height=h+'px';}else{Q('img',d)[0].style.webkitTransform='rotate(180deg)';}}else d=$.prepend(c,'<div class="bg-form txcenter" style="height:0;"><i class=va-i></i><img style="transition-duration:3s" src=img/p/arr_down.gif align=absmiddle> '+Loc.pulldown_refresh+'</div>');}},function(){if(d)$.rm(d),d=null;});})();}else{$.e_add((a==='scroll'&&$(e.id+':cont'))||$(e.id),a,b);}},trigger:function(a){if(!this._disposed)this.fireEvent(a);},off:function(a,b){var e=this.dataDiv();if(e&&e.$()){if(a==='bottom'){var d=this.df_listeners&&this.df_listeners[a];if(d){for(var k in d){var u=d[k].dz;$.e_remove(e.$(),'scroll',u);e.removeEvent('resize',u.gd);this.vm().removeEvent('modify',u.gd);this.vm().removeEvent('render',u);}}}else $.e_remove(e.$(),a,b);}this.removeEvent(a,b);},scrollIntoView:function(a){this.dataDiv().scrollIntoView(a)}}});window.VM=Fn.VM;js.extend(VM,VM.Base);window.VP=function(a){return VM(a,true)};js.implement(VM.Base,{ff:25,dQ:22,$:VM.prototype.$,cmd:function(){this.parentNode.cmd.apply(this.parentNode,arguments);},dv:function(){return this.div;},dataDiv:function(){return this.dv()},gK:function(a,b){if(a<0||isNaN(a)){var c=this.$();return c?c[b]:null;}return a;},wd:function(){return this.gK(this.dv().wd,'offsetWidth');},iwd:function(){return this.gK(this.dv().i_wd,'offsetWidth');},ht:function(){return this.gK(this.dv().ht,'offsetHeight');},iht:function(){return this.gK(this.dv().i_ht,'offsetWidth');},prev:function(){var e=this.xt('preceding-sibling::*[1]/@id');if(e)return this.vm().find(e);},next:function(){var e=this.xt('following-sibling::*[1]/@id');if(e)return this.vm().find(e);},reset:function(){this.vis=false;},dispose:function(){if(this._disposed)return;this.fireEvent('remove');Ajax.bb(this);this.reset();for(var i=this.length-1;i>-1;i--)this[i].dispose();this.xml=this.div=null;delete VM._a[this.id];delete this.xml;delete this.div;this.removeNode();}});Fn.fW('VM.PLUGIN',{Const:function(a){VM.Base.call(this,a);this.settings=false;},Extend:[VM.Base],Prototype:{type:'plugin',bA:'',ready:0,_disposed:false,design:function(a,b){var e=a.add(),n=this.dR(b);Fn.Div.addOnRender(e,n);e.addEvent('resize',this.bV,this,['resize']);this.addEventOnce('remove',this.bV,this,['unload']);this.div=e;},dR:function(x){var sbefore=$.xt(x,'beforeload'),sload=$.xt(x,'load'),sstyle=$.xt(x,'style'),shtml=$.xt(x,'html'),arcss=$.xs(x,'css/src'),arjs=js.map($.xs(x,'js/src'),'v.text'),m=$.xi(x,'js/@sync'),n=js.bind('this.ready++;if(this.am()){'+sload+';this.fireEvent("render")}',this),t;if(arcss.length){this.css=[];var h=$.tags('head')[0];for(var i=0;i<arcss.length;i++){t=arcss[i].text;$.css_import_link(t);this.css.push(t);}}if(arjs.length){Ajax.loadjs(arjs,n,m);}else{this.ready++;}if(sstyle){$.css_import_style(sstyle);}if(sbefore){t=Function(sbefore).call(this);if(typeof t=='string')this.bA=t;}if(shtml)this.bA=shtml;return n;},data:function(){this.div.data(this.bA);},vm:function(){return this.parentNode;},wd:function(){return this.div.i_wd;},ht:function(){return this.div?this.div.i_ht:(this.$()&&this.$().offsetHeight);},win:function(){return this.div.ww||window;},addcheck:function(){if(!this.aW)this.aW=new Fn.FormCheck();this.aW.add.apply(this.aW,arguments);},addpl:function(a,b){if(!this.fy)this.fy={};this.fy[a]=b;},bind:function(a){this.handler=a.handler;this.settings=a||{};if(!('ownerPlugin' in a.handler))a.handler.ownerPlugin=this;},am:function(){return this.ready==2&&!this._disposed;},bV:function(a,b){if(this.am()){var b=b||(a==='resize'?[this.wd(),this.ht()]:null);c=this.xt(a);if(c)return Function(c).call(this,b);if(this.settings[a])return this.settings[a].call(this.handler,b);}},attachEvent:function(a,b){},getDefaultValue:function(){return this.xt('value');},setDefaultValue:function(a){if(!this.x('value'))$.x_add(this.x(),'value');$.xcdata(this.x('value'),a);},getValue:function(){return this.callSettings(DFish.GET_VALUE);},setValue:function(a){return this.callSettings(DFish.SET_VALUE,a);},callSettings:function(a,b){if(this._disposed)return;if(a==DFish.GET_VALUE){return this.settings.getValue?this.settings.getValue.call(this.handler):this.xt('value');}else if(a==DFish.SET_VALUE){if(this.settings.setValue)return this.settings.setValue.call(this.handler,b);}else if(a==DFish.RESET){if(this.settings.resetValue)return this.settings.resetValue.call(this.handler,b);}if(this.ready<2){this.addEventOnce('render',this.callSettings,this,js.argu());}else{if(a==DFish.RESIZE){this.width=b[0];this.bV('resize',b);}else if(a==DFish.HIDDEN){if(this.settings.hide)this.settings.hide.call(this.handler,b);}else if(a==DFish.DISABLE){if(this.settings.disable){this.settings.disable.call(this.handler,b);}}}return this;},cleanCss:function(){if(this.css)js.each(this.css,'$.rm(v);');},html:function(a,b){if(a==null&&b==null)return this.$().innerHTML;if(typeof a==='object'){a.render(this.$());}else{$.html(this.$(),a,b);}},reset:function(){VM.Base.prototype.reset.call(this);this.fireEvent('beforeupdate');if(this.aW){this.aW.dispose();this.aW=null;}if(this.fy){for(var i in this.fy){if(this.fy[i].dispose)this.fy[i].dispose();delete this.fy[i];}}},dispose:function(){if(this._disposed)return;this.fireEvent('remove');if(this.handler){if(this.handler.ownerPlugin)delete this.handler.ownerPlugin;}this.handler=this.settings=this.xml=null;VM.Base.prototype.dispose.call(this);}}});Fn.fW('VM.Base.SrcPanel',{Const:function(a,b){var c=VM._a[a].xfr(b);if(!c)return null;this.vmid=a;this.pkid=b;this.src=c.getAttribute('src');this.load=c.getAttribute('load');var d=c.getAttribute('scroll');if(d)this.scroll=d;if(d=c.getAttribute('onload'))this.onload=d;this.hstry=[this.src];this.hstry.point=0;if(this.src.indexOf('vm:|')===0){this.baseSrc=this.src.slice(4);if(this.baseSrc.indexOf('|')>0)this.baseSrc=js.s_to(this.baseSrc,'|');}},Prototype:{type:'src',x:function(a){return a?$.x(this.x(),a):VM._a[this.vmid].xfr(this.pkid);},$:function(){var a=VM._a[this.vmid].bM[this.pkid];if(!a)a=VM._a[this.vmid].hS[this.pkid];return a&&a.$();},vm:function(){return VM._a[this.vmid];},attr:function(a,b){var c=this.vm().xfr(this.pkid);return b==null?c.getAttribute(a):(c.setAttribute(a,b),b);},reload:VM.prototype.reload,fX:function(a,b){var v=VM._a[this.vmid],c=v.xfr(this.pkid);v.go(this.pkid,a||$.xt(c,'@src'),b);},win:function(){var a=$(this.vm().hS[this.pkid].id+'-fr');return a?a.contentWindow:null;},find:function(){},f:function(){},view:function(){var p=VM._a[this.vmid];if(p){for(var i in p.hS){if(i==this.pkid)return p.hS[i];}}}}});Fn.fW('VM.Base.PagePanel',{Const:function(a,b){this.vmid=a;this.pkid=b;this.frid=b;},Helper:{_a:{},inst:function(a,b){var c=a+'-'+b;if(!this._a[c])this._a[c]=new this(a,b);return this._a[c];}},Extend:[VM.Base],Prototype:{type:'page',$:function(){var a=this.dv();return a&&a.$();},dv:function(){return this.vm().bM[this.pkid];},vm:function(){return VM._a[this.vmid];},x:function(a){var x=this.vm().xfr(this.pkid);return x&&a?$.x(x,a):x;},xs:function(a){var x=this.x();return x&&a?$.xs(x,a):x;},xt:function(a){var x=this.x();return x&&a?$.xt(x,a):x;},attr:function(a){return this.xt(/^\w+$/.test(a)?'@'+a:a);},reload:function(a){Function(js.s_printf(this.xt('@clk'),a||this.xt('@currentPage'))).call(this)},show:function(){$.toggle(this.$(),true)},hide:function(){$.toggle(this.$(),false)}}});Fn.fW('VM.Base.SetPanel',{Const:function(a,b){VM.Base.PagePanel.call(this,a,b);},Helper:{_a:{},inst:VM.Base.PagePanel.inst},Extend:[VM.Base.PagePanel],Prototype:{type:'set',g_type:function(){var a=VM._a[this.vmid].bM[this.pkid];return a&&a.type;},g_sep:function(a){var b=this.dv(),c=b&&b.ssca,d=c&&(a==null?c:c.split(',')[a]);return isNaN(d)?d:js.m(d);},toggle:function(a,b,c){var d=this.dv();if(!this.fg)this.fg=d.ssca;if(b)this.fg=a;this.hy=a;Fn.DivSet.resep(d,b?a:(d.ssca==a?this.fg:a));if(c)c(d.ssca==a);},resize:function(w,h){Fn.Div.resizeTo(VM._a[this.vmid].bM[this.pkid],w,h);},reset:function(a,b){if(a){var c=this.dv();if(c)Fn.DivSet.resep(c,a,b);}}}});Fn.fW('VM.Base.HtmlPanel',{Const:function(a,b){VM.Base.PagePanel.call(this,a,b);},Helper:{_a:{},inst:VM.Base.SetPanel.inst},Extend:[VM.Base.PagePanel],Prototype:{type:'html',html:function(a,b){var c=$(this.dv().id+':cont')||$(this.dv().id+':frhtml')||this.$();if(a!=null)$.html(c,a,b);else return c.innerHTML;},scrollTop:function(a){return this.dv().scrollTop(a);},scrollLeft:function(a){return this.dv().scrollLeft(a);}}});Fn.fW('VM.Base.FilmPanel',{Const:function(a,b){VM.Base.PagePanel.call(this,a,b);},Helper:{_a:{},inst:VM.Base.HtmlPanel.inst},Extend:[VM.Base.PagePanel],Prototype:{type:'film',length:function(){return this.dv().length;},get:function(a){return this.vm().find(this.index2id(a))},getFocusPanel:function(){var a=this.dv();if(a.gz!=null){var b=a.gz,k;for(k in a.fw){if(a.fw[k].nodeIndex===b)break;}return k&&this.vm().find(k)}},index2id:function(a){return typeof a==='number'?this.xt('fr'+(this.dv().hZ?'[@id!=../@wel]':'')+'['+(a+1)+']/@id'):a;},id2index:function(a){return $.xs(this.x('fr[@id="'+a+'"]'),'preceding-sibling::fr'+(this.dv().hZ?'[@id!=../@wel]':'')).length;},view:function(a){if(a==null){var b=this.dv(),c=b.hZ&&this.vm().xfr(b.hZ)?b.hZ:(b.bF&&this.vm().xfr(b.bF)?b.bF:0);b.view(c);}else{this.vm().go(this.index2id(a));}}}});Fn.fW('VM.Base.FlowPanel',{Const:function(a,b){VM.Base.PagePanel.call(this,a,b);},Helper:{_a:{},inst:VM.Base.HtmlPanel.inst},Extend:[VM.Base.PagePanel],Prototype:{type:'flow',length:function(){return this.dv().length},scrollTop:function(a){return this.dv().scrollTop(a)},scrollLeft:function(a){return this.dv().scrollLeft(a)}}});})();﻿Fn.fW('VM.LB',{Const:function(a){VM.Base.call(this,a);this.hH=[];this.gw=[];this.D=[];this.bZ=[];this.jD=[];},Extend:[VM.Base],Helper:{colspan:function(x){var a=$.xs(x,'li'),b=c=a.length;for(var i=0;i<b;i++)c+=arguments.callee(a[i]);return c;},rowspan:function(a,b){if($.x(a,'li'))return 0;else{var c=b;while(a.parentNode.tagName=='li'){c--;a=a.parentNode;}return c;}},clk:function(a){var b=event.srcElement,c=VM._a[a.id.replace('-tb','')],d=this.bd(a,b);if(c&&d){if(b.name==c.aJ){var e=c.cD.clk;if(e&&Function(js.s_printx(e,c.tr2x(d),true)).call(b)!==false){if(c.cD.syncfocus==1){if(b.checked)c.doHigh(d);else c.unHigh(d);}}}else{var e=this.doClk(c,d);if(e!==false&&c.fx){var f=this.bc(a,b);if(f&&!c.eu&&c.fx)c.edit_tr(f);}}}},doClk:function(a,b){var c=a.xt('pub/attach/@clk');if(c&&Function(js.s_printx(c,a.tr2x(b),true)).call(b)===false)return false;a.doHigh(b);},bxclk:function(a,b){var a=VM._a[a],c=a.de(b);if(a.cD.syncfocus==1){b.checked?a.doHigh(c):a.unHigh(c);}if(a.cD.clk)Function(js.s_printx(a.cD.clk,a.tr2x(c),true)).call(b);if($(a.id+'-abx')&&!$(a.id+'-abx').disabled){$(a.id+'-abx').checked=Q('input:checked[name='+a.aJ+']',a.$()).length===Q('input[name='+a.aJ+']',a.$()).length;}$.e_cancel(event);},menu:function(a){var b=event.srcElement,c=VM._a[a.id.replace('-tb','')],d=this.bd(a,b);if(d){var e=b.name==c.aJ?c.cD.menu:c.xt('pub/attach/@menu');if(e){Function(js.s_printx(e,c.tr2x(d),true)).call(b);return false;}}},dbl:function(a){var b=event.srcElement,c=VM._a[a.id.replace('-tb','')],d=this.bd(a,b);if(d){var e=b.name==c.aJ?c.cD.dbl:c.xt('pub/attach/@dbl');if(e){c.doHigh(d);Function(js.s_printx(e,c.tr2x(d),true)).call(b);return false;}}},bc:function(a,b){var c=a.tBodies[0];if(!(c.contains(b)&&c!=b))return;c=$.pel(b,'TD',a);return c&&c.tagName=='TR'?null:c;},bd:function(a,b){var c=this.bc(a,b);return c&&c.parentNode;},move:function(o){o.style.cursor=this.dragable(o,this.mv_x(o,event))?'col-resize':(o.className=='hand'?'pointer':'');},down:function(o,b){var a=VM._a[b],ix=this.mv_x(o,event),cl=$.canvas().clientLeft;if(this.dragable(o,ix)){var iMin=5,iStart=event.clientX,rc=$.bcr(a.$(a.id+'-sort')),e=$.db('<div style="position:absolute;top:'+rc.top+'px;left:'+iStart+';width:1px;height:'+a.div.i_ht+'px;" class=bg-low></div>');e.setCapture();e.onmousemove=function(){e.style.posLeft=event.clientX-cl;};e.onmouseup=function(){e.onmousemove=e.onmouseup=null;e.releaseCapture();e.removeNode(true);var iOff=event.clientX-iStart,tbl=o.offsetParent,hi=js.m(o.getAttribute('hi'))+(ix<=0?0:1),ar=tbl.getAttribute('ikcols').split(',');ar[hi-1]=Math.max(tbl.firstChild.children[hi-1].style.posWidth+iMin+iOff,24);var iw=tbl.offsetWidth+iOff,cw=a.data_wd();if(iw<cw){iw=cw;if(ar.toString().indexOf('*')==-1)ar[ar.length-1]='*';}tbl.setAttribute('ikcols',ar.join());a.$(a.id+'-tb').setAttribute('ikcols',ar.join());a.resize(iw);}}},mv_off:function(td,o){if(!td||td==o)return 0;return o.offsetLeft+this.mv_off(td,o.parentNode);},mv_x:function(o,e){return e.offsetX+this.mv_off(o,e.srcElement);},msover:function(a){if(a.offsetParent){var b=a.offsetParent.id,c=VM._a[b.replace('-tb','')];if(c&&b.indexOf('sorttb')<0&&a.className.indexOf('row-grv')<0){if(c.ii)$.class_add(a,c.iW);$.class_add(a,'z-hv');if(c.jj)Function(c.jj).call(a);if(!Br.cmp&&!Br.mobile){Q('.f-over-vis',a).css({visibility:'visible',position:'static'});if(Q(a).closest('.f-hover-wrap').length){Q('.f-hover',a).css({visibility:'visible',position:'static'});}}}}},msout:function(a,b){var c=a.offsetParent&&a.offsetParent.id;if(c&&c.indexOf('sorttb')<0&&(b||!a.contains(event.toElement))){var d=VM._a[c.replace('-tb','')];if(d){if(d.ii)$.class_del(a,d.iW);$.class_del(a,'z-hv');if(d.ji)Function(d.ji).call(a);if(!Br.cmp&&!Br.mobile){Q('.f-over-vis',a).css('visibility','hidden');}}}},keyup:function(a){var b=a.offsetParent.id,c=event.keyCode;if(b.indexOf('sorttb')<0&&(c===38||c===40)){b=VM._a[b.replace('-tb','')];if(b.hO&&b.$(b.id+'-tb').contains(document.activeElement)){c=c==38?b.hO.previousSibling:(c==40?b.hO.nextSibling:null);if(c){b.doHigh(c);b.scrollIntoView(c.rowIndex);}}}},dragable:function(o,ix){return((ix<=0&&parseInt(o.getAttribute('hi'))>0)||ix>o.clientWidth-2);},bK:function(a){var b=event.srcElement,c=VM._a[a.replace('-tb','')],d=this.bd($(a),b);if(d&&!b.name){var e=$.bcr($(a)),f=$.bcr(d),x=event.clientX,y=event.clientY,g=f.left-x,h=f.top-y,r=$(a).tBodies[0],w=d.rowIndex,k,m,u;$.e_moveup($(a),function(){var n=event.clientX,o=event.clientY;if(k){k.style.posLeft=n+g;k.style.posTop=o+h;}if(!m){if(Math.abs(n-x)>1||Math.abs(o-y)>1){VM.LB.msout(d,true);m=[];k=$.db('<div class="lb alpha" style=position:absolute;background:#ccc;left:'+(n+g)+'px;top:'+(o+h)+'px;><table cellspacing=0 cellpadding=0 class=tbl>'+$(a).firstChild.outerHTML+'<tbody class=tby></tbody></table></div>');for(var i=0,p,q,l=r.rows.length;i<l;i++){p=r.rows[i];m.push($.bcr(p));if(p==d){m.$=r.insertRow(i);m.$.height=d.offsetHeight;for(var j=0,t=$.tags('COL',$(a)).length;j<t;j++){var v=m.$.insertCell(m.$.cells.length);v.className='white bd-form';var s='border-style:dashed;';if(j==0)s+='border-right:none';else if(j<t-1)s+='border-left:none;border-right:none';else s+='border-left:none;';$.css(v,s);}k.firstChild.tBodies[0].appendChild(d);u=i;}}}}else{if(!c.bJ||n<e.left||n>e.right||o<e.top||o>e.bottom)return;for(var i=0;i<m.length;i++){var v=(m[i].top+m[i].bottom)/2;if(o>m[i].top&&o<=v){break;}else if(o>v&&o<=m[i].bottom){i++;break;}}if(!m[i]&&o<=m[0].top)i=0;if(m[i]){if(r.rows[i]!=m.$)r.insertBefore(m.$,r.rows[i]);}else{if(r.rows[m.length]!=m.$)r.appendChild(m.$);}u=i;}},function(){if(m){var x=event.clientX,y=event.clientY;if(u!=null){r.insertBefore(d,r.rows[u]);$.rm(m.$);if((u=d.rowIndex)!=w){var o=c.tr2x(w),s=js.s_printx(c.bJ.replace(/\$index\b/,u),o);$.x2p(o,c.tr2x(u));c.sortRowEnd=function(e){if(e==null||e==true)VM.LB.gc($(a));if(e==false){r.insertBefore(d,r.rows[w+(w>u?1:0)]);$.x2p(o,c.tr2x(w));VM.LB.gc($(a));}if(m.$){m.$=k=b=null;delete m.$;}};e=$.bcr(c.$());if(x>e.left&&x<e.right&&y>e.top&&y<e.bottom)c.cmd({tagName:'ajax',src:s,hdl:function(e){c.sortRowEnd();c.cmd(e);}});else c.sortRowEnd(!1);}}$.rm(k);}});c.fireEvent('dragstart',c.tr2x(d),$(a),2-h);}},gS:function(a,b,c){this[VM._a[b].hH[c].sort=='3'?'gV':'gT'](a,b,c);},gV:function(a,b,c){var d=VM._a[b];Function(d.hH[c].sortclk).call(d);},gT:function(a,b,c){var d=VM._a[b],e=b+'-sort-ic';if(d.gW!=a){$.rm(e);d.gW=a;d.gW.sortType='desc';$.append(d.gW,'<img id='+e+' src='+Cfg.imgp+'sortdesc.gif style=margin-left:3px>');}else with(d.gW){sortType=sortType=='asc'?'desc':'asc';$(e).src=Cfg.imgp+'sort'+sortType+'.gif';}var tb=d.$(b+'-tb'),rs=tb&&d.trows(),cs=[];if(!rs||!rs.length)return;for(var i=0;i<d.bZ.length;i++){try{VM.LB.contentToggle(d.bZ[i],null,null,null,false);d.bZ[i].removeAttribute('expid');}catch(e){}}d.bZ.length=0;for(var i=0,r,l=rs.length;i<l;i++){r=rs[i];if(r.ca)r.removeAttribute('ca');else r.setAttribute('_i',cs.push(r)-1);}var xth=d.hH[c],bAsc=d.gW.sortType=='desc',sSf=d.gW.sortfld,bNum=xth.sort=='2';if(xth.tp=='tx'){cs.sort(function(e,f){var c1=e.cells[c],c2=f.cells[c];if(!c1||!c2)return 0;var ta=sSf?c1.getAttribute('sort'):(c1.innerText),tb=sSf?c2.getAttribute('sort'):(c2.innerText);if(bNum){ta=parseFloat(ta);tb=parseFloat(tb);}return bAsc?(ta<tb?1:(ta==tb?0:-1)):(ta>tb?1:(ta==tb?0:-1));});}else{cs.sort(function(e,f){var c1=e.cells[c],c2=f.cells[c];if(!c1||!c2)return 0;var ta=sSf?c1.getAttribute('sort'):c1.innerText,tb=sSf?c2.getAttribute('sort'):c2.innerText;if(bNum){ta=parseFloat(ta);tb=parseFloat(tb);}return bAsc?(ta<tb?1:(ta==tb?0:-1)):(ta>tb?1:(ta==tb?0:-1));});}var x=d.x('tbody'),s=js.map(d.xs('tbody/d'));for(var i=0,j,k;i<cs.length;i++){k=cs[i];j=parseFloat(k.getAttribute('_i'));x.insertBefore(s[j+d.dF],$.x(x,'d['+(i+d.dF+1)+']'));k.className='tr'+(i%2);k.removeAttribute('_i');}s.length=0;var hi=d.hO&&js.index(cs,d.hO),o=document.createElement('div');o.innerHTML='<table><tbody class=bdy>'+js.map(cs,'v.outerHTML').join('')+'</tbody></table>';tb.replaceChild(o.firstChild.tBodies[0],tb.tBodies[0]);d.doHigh(hi);$.rm(o);o=s=cs=null;},gc:function(a){a=a.tBodies[0].rows;for(var i=0,b,l=a.length;i<l;i++){b=a[i];$.class_del(b,this.iW);b.className=b.className.replace(/\btr[01]\b/,'tr'+(i%2?0:1));}},go:function(a,b){VM._a[a].go(b);},boxall:function(a,b){var c=VM._a[b];c.checkAll(a.checked);if(c.cD.clk)Function(c.cD.clk).call(a);},groupToggle:function(a){var b=a.getAttribute('minus'),d=$.pcls(a,'g-c'),c=$.pel(d,'TABLE').rows,e=$.pel(d,'TR');for(var i=e.rowIndex+1,d;i<c.length;i++){d=c[i];if($.class_any(d,'exptr')){if(!d.getAttribute('bL'))d.setAttribute('bL',d.style.display||'block');d.style.display=b==1?'none':d.getAttribute('bL');if(Br.ie_7)$.class_add(d,'none',b!=1);}else{if($.query('.g-grv',d).length)break;d.style.display=b==1?'none':'';if(Br.ie_7)$.class_add(d,'none',b!=1);}}a.setAttribute('minus',b==1?0:1);a.firstChild.className='f-arw-'+(b==1?'r1':'b1');$.e_stop();},contentToggle:function(a,b,c,d,y,o,w,h,n){if(!a)return;var e;if(a.tagName==='IMG'&&/img\/p\/(?:plus|minus)\.gif/.test(a.src)){e=$.toggleAttr(a,'src','img/p/minus.gif',y!=null?y:null);}else{var f='df-lb-contentToggle';if(!a.getAttribute(f))a.setAttribute(f,0);e=$.toggleAttr(a,f,1,y!=null?y:null,true);}var f=o||$.pel(a,'TR'),v=VM(a,true);if(!o){f=$.pel(a,'TR',$(v.id+'-tb'));}if(!f)return;v.an=true;if(a.getAttribute('expid')){Q(f).next()[e?'show':'hide']();if(!Br.cmp){Q(f).next().find('.relative,.ps-rel')[e?'show':'hide']();}f.nextSibling.removeAttribute('bL');$.class_add(f,'exptrprv',!e);}else if(y==null||y){if(!b)b=a.getAttribute('tgsrc');if(!w)w=js.m(a.getAttribute('tgw'));if(!h)h=js.m(a.getAttribute('tgh'));$.attr(a,{tgsrc:b,tgw:w,tgh:h});var k=js.uid('exptd-'),g=o?$.html(o,'<div></div>','afterend'):f.parentNode.insertRow(f.rowIndex+1);g.className='exptr';$.class_add(g.previousSibling,'exptrprv');if(!o){g=g.insertCell(0);for(var i=0,j=0;i<f.cells.length;i++){j+=f.cells[i].colSpan;}g.colSpan=j;g.className='td';}if(v.bZ)v.bZ.push(a);if(c===true)c=50;var s='<div '+(c?' class="f-excd"':'')+'>'+(c?'<div class=d-prong-t'+' style="'+(isNaN(c)?'left:'+c:((c<0?'right:'+(-c):'left:'+c)+'px'))+'">'+$.htm.arw('t4')+$.htm.arw('t3')+'</div>':'')+'<div id='+k+(c?' class="bd-form bg-form"':'')+'></div></div>';g.innerHTML=s;if(b.indexOf('vm:')===0){a.setAttribute('expid',k);var m=new Fn.DivSet('rows=*',w?Math.min($(k).offsetWidth,w):$(k).offsetWidth,h||null,'name=expdv');v.jD.push(VM.go(VM.p_film(m.render($(k))),b,d||k,VM(v)));}else{$(k).innerHTML='Loading...';if(w)$(k).style.width=w+'px';if(h){$(k).style.height=d+'px';$(k).style.overflowY='auto';}a.setAttribute('expid',k);Ajax.send(b,VM.LB.bY,VM.LB,a,null,true);}}if(n)n.call(a,e);},bW:function(a){$.rm($.pel($(a.expid),'TR'));a.removeAttribute('expid');a.src='img/p/plus.gif';},bY:function(a,b){if(a===false)return this.bW(b);var v=VM(b,true),c=v.id,d=$(b.getAttribute('expid')),e=d.offsetWidth,f=[];if(d.style.width!='auto')d.style.posWidth=e;d.innerHTML=a.replace(/<iframe>([\s\S]*?)<\/iframe>/g,function($0,$1){f.push($1);return $.htm.iframe('100%',1,'',c+'-exp-'+b+'-'+(f.length-1));});var g,o,w;for(var i=0;i<f.length;i++){g=window.frames[c+'-exp-'+b+'-'+i].document;$.wr(g,[$.htm.vmltag(),'<body scroll=no bgcolor=#f9f8f7 onload=parent.VM.LB.bX("'+b+'",'+i+',"'+c+'")><div style=word-break:break-all>',f[i],'</div></body></html>'].join(''));o=v.$(this.id+'-exp-'+b+'-'+i);w=g.body.scrollWidth;$.css(o,'width',Math.max(w,o.parentNode.offsetWidth-26),'height',g.body.scrollHeight+4+(e<w?Br.scroll:0));}},bX:function(a,b,v){var c=v+'-exp-'+a+'-'+b,d=$(c).style.posHeight,e=window.frames[c].document.body,f=e.scrollHeight+4,g=e.scrollWidth,h=$(c).parentNode.offsetWidth,i=$(v+'-exp-'+a);if(f>4&&d!=f)$.css(c,'width',Math.max(g,$(c).parentNode.offsetWidth-26-32),'height',f+(h<g?Br.scroll:0));if(i.clientHeight+2<i.scrollHeight&&!i.style.paddingBottom)i.style.paddingBottom=(8+Br.scroll)+'px';},colgr:function(a,b,c,d){var e=[],f='<colgroup>',g;for(var i=0;i<c.length;i++){if(typeof e[i]==='undefined')e[i]=d;if(a.cols&&a.cols[i]){for(var j=i+1;j<i+a.cols[i];j++){e[j]=0;}}f+='<col ikmin='+e[i]+' style="width:'+(b[i]-e[i])+'px;">';}return f+'</colgroup>';},cM:function(x,ft,pg){var lmt=$.xi(x,'tmpl/@limit'),pg=pg==null?(lmt?1:pg):pg,hd=$.xi(x,'tmpl/@hd'),t;if(ft){t='tbody/d['+(hd?'position()<='+hd+' or ':'')+'('+ft+')]';if(lmt){var b=js.array(),c=$.xs(x,t);for(var i=0;i<hd;i++){b.push(c[i]);}for(i=(pg-1)*lmt+hd,l=Math.min(c.length,(pg*lmt+hd));i<l;i++){b.push(c[i]);}return b;}}else if(lmt){t='tbody/d[position()<='+hd+' or (position()>'+((pg-1)*lmt+hd)+' and position()<='+(pg*lmt+hd)+')]';}return $.xs(x,t||'tbody/'+(this.gn?'/d[not(ancestor::tree)]':'d'));},cR:function(a,b,pg){var lb=VM._a[a].find(b),x=VM._a[a].xfr(b),hd=$.xi(x,'tmpl/@hd'),ft=lb?lb.jd:$.xi(x,'pub/filter'),pg=pg||(lb&&lb.fk)||1,cs=this.cM(x,ft,pg),q='tbody/d[position()>'+hd,l;if(ft)q+=' and ('+ft+')';l=$.xs(x,q+']').length;return{currentPage:pg,currentRecords:cs.length-hd,sumPage:Math.ceil(l/($.xi(x,'tmpl/@limit')||1)),sumRecords:l};},ig:function(a,b,c){var c=c||a.bH.gp[0];for(var i=0,d;i<c.length;i++){if(c[i].length){if(d=this.ig(a,b,c[i]))return d;}else if(c[i].xml==b)return c[i];}}},Prototype:{type:'lb',gU:41,gW:null,aJ:'selectItem',hH:null,design:function(a,b,_0,_1,_2,_3){var d=this.xi('tmpl/@hd'),e=b.getAttribute('scroll');if(e==='scroll')e='miniscroll';var f=a.add(_0,_1,_2,_3,e);this.dF=d;this.ej=this.xi('tmpl/@limit');this.jd=this.xt('pub/filter');this.bJ=this.xt('pub/drag/@src');this.eu=this.xi('edit/@manual');this.eN=this.xi('pub/nobr');this.dH=this.xi('pub/face/@focustype');this.dK=this.xt('pub/face/@focusclass')||'row-on';this.ii=this.xi('pub/face/@hover');this.iW=this.xt('pub/face/@hoverclass')||'row-hv';this.cm=this.xt('pub/face/@v');this.aC=this.xt('pub/face/@bdclr');this.aJ=this.xt('tmpl/li[@tp="bx" or @tp="rx"]/@n')||'selectItem';this.aL=this.xi('tmpl/li[@tp="bx" or @tp="rx"]/@ntn');this.aI=this.xt('tmpl/li[@tp="bx" or @tp="rx"]/@fld');this.jj=this.xt('pub/attach/@mouseover');this.ji=this.xt('pub/attach/@mouseout');this.jn=this.xi('pub/face/@fixhead');this.cD=false;this.fj=js.m(this.xt('@cellpadding')||3);this.gx=e;this.ay=e&&e!='hidden';this.gn=this.x('tmpl/li[@tp="tree"]');this.T=this.xt('pub/face/@clz');this.jJ=this.xt('pub/face/@hdclz');this.gj=(this.xi('tmpl/@ht')||38)-(Br.cmp?0:this.fj*2);this.fx=!!this.x('edit')&&$.x_doc('<view><static><fr type="mx" class="mx" cellspacing="0" cellpadding="0" scroll="hidden" autoht="1"><form/></fr></statc></view>');f.addEvent('resize',this.resize,this);if(d){var self=this,s=self.id+'-sort';Fn.Div.bindScroll(f,function(){$(s).scrollLeft=this.$('cont').scrollLeft;if(self.jn){var m=$.bcr(this.$()),n=$.bcr($(self.id+'-pad'));$(s).style.position=n.top>m.top?'':'fixed';$(s).style.top=n.top>m.top?'':$.bcr(this.$('cont')).top+'px';$.class_add($(self.id+'-sort'),'g-sort-shadow',this.scrollTop()===0);}});}return this.div=f;},attr:function(a){switch(a){case 'hover':return this.ii;default:return VM.Base.prototype.attr.call(this,a)}},dataDiv:function(){return this.div},data:function(a){if(this.vis){this.reset();this.vis=true;}this._main_data(a);},fL:function(){if(this.vis)return;var a=this.xt('pub/high/@n');if(a){eval('a = '+a);var b=this.xi('pub/high/@click'),r=this.de(a);if(r){if(b)VM.LB.doClk(this,r);else this.doHigh(r);$.view(this.div.$(),r);}}if(this.cD.syncfocus==1){var b=$.query('input[name='+this.aJ+']');for(var i=0;i<b.length;i++){if(b[i].checked)this.doHigh(this.de(b[i]));}}this.atchev();this.fireEvent('render');},atchev:function(a){a=a||this.xs('tbody/d/c//i[@on="1"]');if(a.length)VM.MX.prototype.atchev.call(this,a);},page:function(a,b){if(typeof a=='object'){var c=this.dj(a);if(c!=null)a=Math.ceil((c+1)/this.ej);else return;}this.data(js.m(a));var c=$.x_doc('<update type="panel" target="'+b+'"/>'),d=this.parentNode.xfr(b).cloneNode(!0);if(Br.w3c)d=Fn.Dom.importNode(c,d);c.appendChild(d);this.cmd(c);this.parentNode.fireEvent('page');},filter:function(a){this.jd=a;var b=this.parentNode.xt('.//fr[@type="page"]/@id');if(b)this.page(1,b);else this.data();},_main_data:function(pg){var xlis=this.xs('tmpl/li'),xds=VM.LB.cM(this.x(),this.jd,pg),hd=this.dF,hs=this.hH,cols=this.D,ncol=30;if(hs.length)hs.length=0;if(cols.length)cols.length=0;this.bB=xds.length;this.fk=pg==null?(this.ej?1:pg):pg;for(var i=0,l=xlis.length;i<l;i++){var a=xlis[i],b=$.x_obj(a);if(b.ps){var c=VM(this).x('parsers/*[@id="'+b.ps+'"]');if(c){if(c.getAttribute('type')==='js'){eval('b.dE = '+js.s_trim(c.text));}else b.fJ=c.text;}else delete b.ps;}if(b.tp=='tree')this.hM=b;hs.push(b);cols.push(b.w);if(!isNaN(b.w)&&ncol>b.w)ncol=b.w;if(b.tp=='bx'||b.tp=='rx')this.cD=b;}var hL;if(this.gn){this.bH=new VM.LB.bw(this.id);hL=this.di(this.xs('tbody/d'),new VM.LB.fN(this.hM,null,this.bH));}var cw=this.data_wd(),sca=js.m_scalegrid(cw,cols.join(),ncol),ikmin=this.fj*2;this.gw=sca;var tblw=this.cZ();var mtr=this.cQ(xds,hL);if(this.dF&&mtr[0]){var sth=[],ht=js.m_rng(this.gj+(Br.cmp?0:ikmin),22,40);sth.push('<div class="g-sort'+(this.jJ?' '+this.jJ:'')+'" id='+this.id+'-sort style="width:'+cw+'px;"><table class="g-sort-tbl'+(this.cm?' g-face-'+this.cm:'')+'" id='+this.id+'-sorttb ikcols='+cols+' cellspacing=0 cellpadding=3 style=width:'+tblw+'px>',VM.LB.colgr(mtr[mtr.maxcolr]||mtr[0],sca,hs,Br.cmp?0:8),'<thead class="nobr">',this.r_data(mtr,0,hd,ht,true),'</thead></table></div><div id='+this.id+'-pad class=g-sort-pad style="width:'+tblw+'px;height:'+(this.dF*(ht+(Br.cmp?0:1)))+'px"></div>');this.div.data(sth.join(''));}this.cp(mtr,hd,mtr.length,tblw);},cp:function(a,b,c,d,e){var stb=[];if(a[b]){stb.push('<table id='+this.id+'-tb ikcols='+this.D+' cellspacing=0 cellpadding='+this.fj+' class="g-main-tbl'+(this.cm?' g-face-'+this.cm:'')+'" onclick=VM.LB.clk(this) ondblclick=VM.LB.dbl(this) oncontextmenu=return(VM.LB.menu(this))'+(this.bJ?' onmousedown=VM.LB.bK(this.id)':'')+' style="width:'+((d||this.cZ()))+'px">',VM.LB.colgr(a[a.maxcolr]||a[b],this.gw,this.hH,Br.cmp?0:(this.fj*2+(this.cm==='bd-cell'?1:0)))+'<tbody class=bdy>',this.r_data(a,b,c,this.gj)+'</tbody>');if(Br.ie&&Br.ieVer>8){stb.push('<tfoot><tr>');for(var i=0;i<this.hH.length;i++)stb.push('<td>');stb.push('</tfoot>');}stb.push('</table>');}for(var i=0,g=this.xs('hidden/i'),f;i<g.length;i++){f=g[i].getAttribute('n');stb.push('<input type=hidden name='+f+' id='+this.parentNode.id+'-'+f+' value="'+g[i].getAttribute('v')+'">');}if(stb.length){this.div.data(stb.join(''),b||e?'beforeend':null);}},eK:function(xx,a,mtr){var xcls=$.xs(xx,'c'),r=mtr?(mtr[a]||(mtr[a]=[])):[],l=xcls.length;for(var i=0;i<l;i++){var x=xcls[i],b=x.getAttribute('r'),c=x.getAttribute('crd').split(','),v=x.getAttribute('v'),f=x.getAttribute('dc'),s=x.getAttribute('style'),c0=a,c1=js.m(c[0]),c2=js.m(b),c3=js.m(c[1]),d=c3-c1,e=c2?c2-1:0,cn=0;if(v){if(!r.vs)r.vs={};r.vs[c1]=v;var g=x.getAttribute('grv');if(g){if(!r.grv)r.grv={};r.grv[c1]=g;r.grvface=x.getAttribute('grvface')||'plus';}}else if(f){if(!r.dc)r.dc={};r.dc[c1]=f;}else{var g=$.x(x,'*');if(g){if(g.tagName=='i'){if(!r.ips)r.ips={};r.ips[c1]=g;}else{if(!r.frs)r.frs={};r.frs[c1]=g;}}}if(s){if(!r.css)r.css={};r.css[c1]=s;}if(d>0){if(!r.cols)r.cols={};r.cols[c1]=d+1;if(!r.wd)r.wd={};r.wd[c1]=this.iL(c);if(mtr&&mtr.maxcolr==a)mtr.maxcolr++;}if(e>0){if(!r.rows)r.rows={};r.rows[c1]=e+1;if(mtr){for(var j=c0+1,k;j<c0+e+1;j++){k=mtr[j]||(mtr[j]=[]);if(!k.skip)k.skip={};k.skip[c1]=d+1;}}}}return r;},cQ:function(xds,hL,hd){var mtr=[],hs=this.hH,hd=hd!=null?hd:this.dF,af;mtr.maxcolr=0;for(var j=0,d,r,jl=xds.length;j<jl;j++){d=xds[j];r=this.eK(d,j,mtr);for(var i=0,il=hs.length;i<il;i++){var x=hs[i];if(j<hd){if(!r.attr)r.attr={};r.attr[i]=' hi='+i;if(x.sort&&x.sort!='0'){r.attr[i]+=' onclick=VM.LB.gS(this,"'+this.id+'",'+i+') class=hand';if(x.sortfld&&x.sortfld!=x.fld)r.attr[i]+=' sortfld='+x.sortfld;}}else{if(x.valign){if(!r.attr)r.attr={};r.attr[i]=(r.attr[i]?r.attr[i]:'')+' valign='+x.valign;}}if(x.style){if(!r.css)r.css={};r.css[i]=(r.css[i]?r.css[i]+';':'')+(x.style);}if(x.align){if(!r.attr)r.attr={};r.attr[i]=(r.attr[i]?r.attr[i]:'')+' align='+x.align;}switch(x.tp){case 'bx':case 'rx':if(j<hd){if(x.tp=='bx'){r.push('<div align=center><input type=checkbox id='+this.id+'-abx value="" onclick=VM.LB.boxall(this,"'+this.id+'")'+(x.chfld&&d.getAttribute(x.chfld)==1?' checked':'')+(x.dsfld&&d.getAttribute(x.dsfld)==1?' disabled':'')+'></div>');}else r.push('&nbsp;');}else{r.push('<div align=center><input onclick=VM.LB.bxclk("'+this.id+'",this) type='+(x.tp=='bx'?'checkbox':'radio')+' name='+this.aJ+' id='+this.id+'-'+this.aJ+'-'+d.getAttribute(x.fld)+' value="'+(d.getAttribute(x.fld)||'')+'"'+(x.chfld&&d.getAttribute(x.chfld)==1?' checked':'')+(x.dsfld&&d.getAttribute(x.dsfld)==1?' disabled':'')+'></div>');}break;case 'tree':if(j<hd||!hL){r.push(d.getAttribute(x.t)||'&nbsp;');}else{if(hL){var t=hL[j];r.push(t.html(!0));if(!t.open){r.hide=1;if(af==null||t.level<af)af=t.level;}if(j>0&&mtr[j-1].hide&&t.level>af){r.hide=2;}}}break;default:var t=d.getAttribute(x.fld)||'&nbsp;';if(j<hd){r.push('<div class=fix>'+t+(x.sortic?'<img id='+this.id+'-sort-ic'+' src='+Cfg.path+x.sortic+' style=margin-left:3px>':'')+'</div>');}else{if(r.ips&&r.ips[i]){if(!this.virmx){var xx=$.x_doc('<fr type="mx" id="'+this.frid+'" cellspacing="0" cellpadding="0"><form/></fr>');this.virmx=new VM.MX(xx,this);}r.push(this.cf(r,i));}else if(r.frs&&r.frs[i]){r.push('');}else{if(x.ps){t=x.fJ?VM.iH(x.fJ,d):x.dE.call(this.parentNode,d,j-hd,x);}r.push(this.eN?'<div class=fix>'+t+'</div>':t);}}break;}}}return mtr;},r_data:function(a,n,m,h,t){var s=[];for(var i=n,b,g;i<m;i++){b=a[i];s.push('\n<tr class="tr'+(i%2)+(this.T?' '+this.T:'')+(b.grv?' row-grv row-grv-'+b.grvface:'')+'"');g='';if(h)g+='height:'+h+'px;';if(b.hide>1)g+='display:none;';if(g)s.push(' style="'+g+'"');s.push(' onmouseover=VM.LB.msover(this) onmouseout=VM.LB.msout(this) onkeyup=VM.LB.keyup(this)>');for(var j=0,c,d,l=b.length;j<l;j++){if(b.skip&&b.skip[j]){j+=b.skip[j]-1;continue;}c=j;s.push('<td class="g-c '+(j===0?'z-start':j===l-1?' z-end':'')+'"');if(b.cols&&b.cols[j]){s.push(' colspan='+b.cols[j]);c+=b.cols[j]-1;}if(b.rows&&b.rows[j]){s.push(' rowspan='+b.rows[j]);}if((b.css&&b.css[j])||(this.aC&&!t)){d=(this.aC?'border-color:'+this.aC+';':'')+(b.css&&b.css[j]?b.css[j]:'');s.push(' style="'+d+'"');}if(b.attr&&b.attr[j]){s.push(b.attr[j]);}if(b.vs&&b.vs[j]){s.push('>',b.grv&&b.grv[j]?'<div class=g-grv style="padding-top:'+(Math.max(0,this.gj-24)+(Br.cmp?0:this.fj*2))+'px" onclick=VM.LB.groupToggle(this) ondblclick="$.e_stop()" face="'+b.grvface+'" minus=1>'+$.htm.arw('b1')+b.vs[j]+'</div>':b.vs[j]);}else if(b.frs&&b.frs[j]){var w=(b.wd&&b.wd[j])||this.gw[j],f=new Fn.DivFlow(null,w-(this.fj*2+(this.cm==='bd-cell'?1:0))),x=b.frs[j];if(x.tagName=='set'){x.setAttribute('style','padding:0 0 5px 3px;margin:0');var d=$.x_doc('<fr type="mx" id="'+this.frid+'-set'+js.uid()+'" vsp="3" hsp="12" rh="26" cellspacing="0" cellpadding="0" scroll="hidden"><form/></fr>');$.append($.x(d,'form'),x.cloneNode(true));$.replaceWith(b.frs[j],d);x=d;}f.parentNode=this;VM.prototype.frame2div.call(this,f,x);VM.prototype.show.call(this,f,x,null,null,true);s.push('>'+f.html());f.parentNode=null;}else if(b.dc&&b.dc[j]){s.push('>'+(b[b.dc[j]]||'&nbsp;'));}else s.push('>'+(b[j]||'&nbsp;'));j=c;}}return s.join('')+'</td>';},xfr:function(a){return $.x(this.x(),'.//fr[@id="'+a+'"]')},go:function(a){this.parentNode.go(a)},cf:function(r,i){if(!this.virmx){var xx=$.x_doc('<fr type="mx" id="'+this.frid+'" cellspacing="0" cellpadding="0"><form/></fr>');this.virmx=new VM.MX(xx,this);}var c=$.x_obj(r.ips[i]);c.vmid=this.parentNode.id;c.mxid=this.virmx.id;this.virmx.ck=((r.wd&&r.wd[i])||this.gw[i])-(this.fj*2+(this.cm==='bd-cell'?1:0));return VM.MX.f_html(this.virmx,c,r.ips[i]);},html_form:function(a,t){if(!this.virmx){var xx=$.x_doc('<fr type="mx" id="'+this.frid+'" cellspacing="0" cellpadding="0"><form/></fr>');this.virmx=new VM.MX(xx,this);}var x=a.nodeType?a:$.x_doc(a),c=$.x_obj(x),i=js.index(this.hH,t);c.vmid=this.parentNode.id;c.mxid=this.virmx.id;if(c.fu!=1){c.fu=1;x.setAttribute('fu','1');}this.virmx.ck=this.gw[i]-(this.fj*2+(this.cm==='bd-cell'?1:0));return VM.MX.f_html(this.virmx,c,x);},di:function(b,c,r){var a=this.hM,r=r||[];for(var i=0,l=b.length;i<l;i++){var d=b[i],e,f=$.xs(d,'d');e=d.getAttribute(a.src)?new VM.LB.fP(a,d,this.bH,f.length):new VM.LB.fO(a,d,this.bH);c.add(e,null,true);r.push(e);if(f.length)this.di(f,e,r);}return r;},cZ:function(){if(!this.gw)this.gw=js.m_scalegrid(this.data_wd(),cols.join(),10);return Math.max(js.sum(this.gw),this.data_wd());},edit_tr:function(a,z){if(!a)return;var r=a.parentNode;if(r._edit_fn){clearTimeout(r._edit_fn.timer);return r._edit_fn();}var b=this.id,c=[],d=[],x=this.tr2x(r);for(var i=0;i<r.cells.length;i++){var e=r.cells[i],f=this.td2li(e).fld,g=this.x('edit/i[@n="'+f+'"]');if(!g&&this.xt('edit/@col')==f){g=this.x('edit/i[@n="'+x.getAttribute(this.xt('edit/@prop'))+'"]');}if(g){e.innerHTML='';var h=this.fx.cloneNode(!0);g=g.cloneNode(!0);g.setAttribute('n',f);$.append($.x(h,'.//form'),g);c.push(VM.xgo(new Fn.DivFilm(e.offsetWidth-(this.fj*2+(this.cm==='bd-cell'?1:0)),null).render(e),h));h=d.push(f)-1;c[h].fs(f,js.s_t2h(x.getAttribute(f)));c[h].mand=this.parentNode;if(e==a){f=c[h].f(f);if(!('focus' in f)&&f.length)f=f[0];if(f&&('focus' in f)){if('setActive' in f)f.setActive();f.focus();}}(this.fx_list||(this.fx_list=[])).push(c[h].id);}}(r._edit_fn=function(bEnd){if(!VM._a[b]||VM._a[b]._disposed){clearTimeout(r._edit_fn.timer);return;}if(bEnd||(!VM._a[b].eu&&!r.contains(document.activeElement))){for(var i=0,l=c.length;i<l;i++){if(c[i]._disposed)return;if(c[i].f(d[i]).modal){c[i].f(d[i]).hide();}}clearTimeout(r._edit_fn.timer);if(l==0)return;for(var i=0,e=false;i<l;i++){if((j=c[i].g_form_error())&&j.length)return DFish.alert(j);if(!z&&!e&&c[i].fv(d[i])!=x.getAttribute(d[i]))e=true;}if(!z&&!e){VM._a[b].eg=r;VM._a[b].updateRow();return;}if(i==l){var e=x.attributes,v=[],y;for(i=0;i<e.length;i++){v.push(e[i].nodeName+'='+js.url_esc(e[i].nodeValue));}y=v.join('&');for(i=0;i<l;i++){y=y.replace(RegExp('\\b'+d[i]+'=[^&]*'),$.f_vals(c[i].$()));}var f=VM._a[b].xt('edit/@action');if(f){if(f.indexOf('javascript:')==0)f=eval(f);VM._a[b].ajax(f,function(x){if(x===false){return;}VM._a[b].eg=r;VM(b).cmd(x);if(z)z=null;},y);}else{if(f=VM._a[b].xt('edit/@hdl'))eval(f+'(VM._a[b],c,r,x)');for(var i=0,f=$.x_obj(x);i<l;i++)f[d[i]]=c[i].fv(d[i]).replace(RegExp('\\b'+d[i]+'='),'');VM._a[b].eg=r;VM._a[b].updateRow(f);}c.length=d.length=0;return;}}if(!VM._a[b].eu)r._edit_fn.timer=setTimeout(r._edit_fn,200);})();},editRow:function(a){if(a.tagName=='TR'&&a.offsetParent==this.$(this.id+'-tb'))a=a.cells[0];else a=$.pel(a,'TD',this.$(this.id+'-tb'));if(a){this.edit_tr(a);}},getEditRow:function(){var a=this.fx&&this.$(this.id+'-tb');if(a){a=a.tBodies[0].rows;for(var i=a.length-1;i>-1;i--){if(a[i]._edit_fn)return a[i];}}return null;},editEnd:function(o){var a=this.fx&&this.$(this.id+'-tb');if(a){if(o){if(o=$.pel(o,'TR',a)){if(o._edit_fn){clearTimeout(o._edit_fn.timer);o._edit_fn(true);}}return;}a=a.tBodies[0].rows;for(var i=a.length-1;i>-1;i--){var b=a[i];if(b._edit_fn){clearTimeout(b._edit_fn.timer);b._edit_fn(true);}}}},insertRow:function(a,z,y){var b=this.trows().length;if(z!=null&&z<0)z=b+z;var c=z==null?b:this.dj(z),f=[];if(!js.isArray(a))a=js.array(a);for(var i=a.length-1;i>-1;i--){if(js.type(a[i])==='xml'){$.append(this.x('tbody'),a[i],c+this.dF);f.push.apply(f,js.map($.xs(a[i],'c/i')));}else a[i]=$.x_add(this.x('tbody'),'d',c+this.dF,null,a[i]);}var d=this.cQ(a,null,0),r;if(this.$(this.id+'-tb')){e=$.div('<table>'+this.r_data(d,0,d.length,this.gj)+'</table>').firstChild;e=e.tBodies[0];r=this.trows(c);while(e.lastChild)r=r?$.before(r,e.lastChild):$.append(this.tby(),e.lastChild);$.rm(e);this.atchev(f);}else{this.cp(d,0,d.length,null,true);r=this.trows(d.length-1);}if(this.fx&&y)this.edit_tr(r.cells[js.find(this.hH,'v.fld=="'+this.xt('edit/i/@n')+'"',null,true)],true);return r;},updateRow:function(a,b){var c=b!=null?this.de(b):this.eg;if(!c)return;js.dps(this,'eg');c.removeAttribute('_edit_fn');var d=$.tags('table',c);for(var i=d.length-1,g;i>-1;i--){if((g=VM(d[i]))&&(g!=this.parentNode)){g.remove();delete g.mand;}}d=c.rowIndex;var e=this.tr2x(c).cloneNode(true),f=this.isRowChecked(d);a=a?(a.nodeType!=1?js.extend(a,$.x_obj(e)):a):e;this.bD(d);this.insertRow(a,d);if(f){this.checkRow(d);}if(this.cm=='bg-odd'){VM.LB.gc(this.$(this.id+'-tb'));}},deleteRow:function(a){if(a==null&&this.hO)a=this.hO.rowIndex;this.editEnd();this.bD(a);if(this.hO&&this.hO.rowIndex<0)this.hO=null;},bD:function(a){var b=this.de(a);if(b){$.xrm(this.tr2x(b));if(this.an&&b.nextSibling&&$.class_any(b.nextSibling.className,'exptr'))this.tby().deleteRow(b.nextSibling.rowIndex);this.tby().deleteRow(b.rowIndex);if(typeof a==='object'&&!a.nodeType&&this.de(a))this.bD(a);}},moveRow:function(a,b){if(typeof b==='boolean'){b=this.dj(a)+(b===true?-1:1);if(isNaN(b)||b<0)return;}var c=this.de(a),d=this.dk(a),e=this.de(b),f=this.dk(b);d.parentNode.insertBefore(d,c.rowIndex>e.rowIndex?f:f.nextSibling);c.parentNode.insertBefore(c,c.rowIndex>e.rowIndex?e:e.nextSibling);},checkRow:function(a,y){if(y==null&&event&&event.srcElement&&event.srcElement.name==this.aJ){return;}var b=this.getRowBox(a);if(b){if(!b.disabled)b.checked=y==null?!b.checked:y;if(this.cD.clk)Function(js.s_printx(this.cD.clk,this.getRowData(a),true)).call(b);}},isRowChecked:function(a){var b=this.getRowBox(a);return b&&b.checked},getBox:function(a){return $.query('input[name="'+this.aJ+'"]'+(a===true?':checked':a===false?':not(:checked)':''),this.$())},getRowBox:function(a){var b=this.de(a);if(b)return $.query('input[name='+this.aJ+']',b)[0];},checkAll:function(y){var a=$.query('input[name="'+this.aJ+'"]',$(this.id+'-tb')),i=a.length;while(i--){if(!a[i].disabled)a[i].checked=y==null?true:y;var r=this.de(a[i]);a[i].checked?this.doHigh(r):this.unHigh(r);}},checkReverse:function(){var a=$.query('input[name="'+this.aJ+'"]',$(this.id+'-tb')),i=a.length,b=true;while(i--){if(!a[i].disabled&&!(a[i].checked=!a[i].checked))b=false;}return b;},focus:function(a,b){var c=this.de(a);if(c){this.doHigh(c,null,b);$.view(this.div.$(),c);}},isFocus:function(a){return this.de(a)===this.hO},getFocus:function(){return this.hO},click:function(a){var c=this.de(a);if(c)VM.LB.doClk(this,c);},scrollIntoView:function(a){var b=this.de(a);if(b)this.div.scrollIntoView(b)},de:function(a){if(a.nodeType===1)return $.pel(a,'TR',$(this.id+'-tb'));var b=this.dj(a);return b!=null?this.trows(b):null;},dk:function(a,b){if(a.nodeType===1){return this.tr2x(this.de(a));}else if(typeof a==='object'){var e=['position()>'+this.dF];for(var i in a)e.push('@'+i+'="'+js.s_quot(String(a[i]))+'"');return e.length>1?this[b?'xs':'x']('tbody/d['+e.join(' and ')+']'):null;}else{if(a<0)a=this.trows().length+a;return this[b?'xs':'x']('tbody/d['+(a+this.dF+1)+']');}},dj:function(a){var b=a;if(typeof a==='object'){var d=this.dk(a);if(!d)return;b=$.xp(d)-this.dF;}else if(b<0)b=this.trows().length+b;return b;},empty:function(){for(var i=this.trows().length-1;i>-1;i--){this.deleteRow(-1);}},getRowData:function(a,b){var c=a==null?(this.hO&&this.tr2x(this.hO)):this.dk(a);return c?$.x_obj(c):null},getRowElement:function(a){return this.de(a)},getAllData:function(){var c=VM.LB.cM(this.x(),this.jd,this.fk),d=[];for(var i=this.dF;i<c.length;i++)d.push($.x_obj(c[i]));return d},getSelectedData:function(){var b=VM(this).f(this.aJ),r=[];if(b){for(var i=0,c,d;i<b.length;i++)if(b[i].checked){c={};c[this.aI]=b[i].value;if(d=this.getRowData(c))r.push($.x_obj(d));}}return r},g_form_error:function(){if(this.aL){if(!$.f_vals(this.$(),this.aJ))return[{msg:Loc.choose_atleastone}];}},toJSONString:function(){var a=this.xs('tbody/d[position()>'+this.dF+']'),b=[];for(var i=0;i<a.length;i++){b.push($.x_obj(a[i]));}return js.toJSONString(b);},data_wd:function(){return this.div.i_wd;},trows:function(a){var b=this.tby(),c=b?(this.an?js.select(b.rows,'!/\\bexptr\\b/.test(v.className)'):b.rows):[];return a==null?c:c[a<0?c.length+a:a]},tby:function(){return this.$(this.id+'-tb')&&this.$(this.id+'-tb').tBodies[0];},iL:function(a){if(typeof a=='string')a=a.split(',');for(var k=a[0],w=0;k<=a[1];k++)w+=this.gw[k];return w;},resize:function(tbw){var a=this.$(this.id+'-tb'),b=this.$(this.id+'-sorttb');if(a||b){var cw=this.div.i_wd-(this.ay?Br.scroll:0),sca=js.m_scalegrid(cw,(a||b).getAttribute('ikcols'),10),tbw=tbw||this.data_wd(),pad=this.fj*2+(this.cm==='bd-cell'?1:0),osc=this.gw;this.gw=sca;if(a){$.coltb(a,tbw);}if(b){this.$(this.id+'-sort').style.posWidth=tbw;$.coltb(b,tbw);}for(var i=0,d=this.xs('tbody/d/c/i');i<d.length;i++){var f=this.iL(d[i].parentNode.getAttribute('crd')),g=d[i].getAttribute('n');this.parentNode.f(g,DFish.RESIZE,[f-pad]);}for(var i=0,d=this.xs('tbody/d/c/fr');i<d.length;i++){var f=this.iL(d[i].parentNode.getAttribute('crd')),g=d[i].getAttribute('id');Fn.Div.resizeTo(this.parentNode.bM[g],f-pad);}for(var i=0,d=$.query('[name=expdv]',this.$());i<d.length;i++){var f=this.iL('0,'+(this.hH.length-1)),g=d[i].getAttribute('id');Fn.Div.resizeTo(Fn.Div._a[g],f);}if(this.fx_list){for(var i=0,k;i<this.fx_list.length;i++){if(k=VM._a[this.fx_list[i]]){Fn.Div.resizeTo(k.film,sca[$.pel(k.film.$(),'TD').cellIndex]-pad);}}}if($(this.id+'-pad'))$(this.id+'-pad').style.posWidth=tbw;}},tr2x:function(a,b){var c=a;if(typeof c=='object'){var d=c.rowIndex;if(this.an){for(var i=0,e=c.parentNode.rows,f=d;i<=f;i++){if(/\bexptr\b/.test(e[i].className))d--;}}c=d;}if(c==null)return c;return b?this.tr2x(c).getAttribute(b):((this.ej||this.jd)?VM.LB.cM(this.x(),this.jd,this.fk)[c+this.dF]:this.xs('tbody/'+(this.gn?'/d[not(ancestor::tree)]':'d'))[c+this.dF]);},td2li:function(a){return this.hH[a.cellIndex];},doHigh:function(a,e,c){if(a!=null){if(typeof a==='number')a=this.trows(a);var b=this.hO,d=this.dK;if(!a)return;if(c!=null){c?this.doHigh(a,e):this.unHigh(a);return;}switch(this.dH){case 0:this.hO=a;break;case 1:if(e){a.style.backgroundColor=e;a.setAttribute('hibg',e);}else{$.class_add(a,d);$.class_add(a,'z-on');}if(b&&(b!=a)){this.unHigh(b);}this.hO=a;break;case 2:var g=js.ids_inc(a.className,d,' ');if(g){this.unHigh(a);}else{if(e){a.style.backgroundColor=e;a.setAttribute('hibg',e);}else{$.class_add(a,d);$.class_add(a,'z-on');}}if(b&&(b!=a)){this.unHigh(b);}this.hO=g?a:null;break;}}},unHigh:function(a){$.class_del(a,this.dK);$.class_del(a,'z-on');if(a.getAttribute('hibg')){a.style.backgroundColor='';a.removeAttribute('hibg');}if(this.hO==a)this.hO=null;},ec:function(a){if(a===40||a===38){var i=this.hO?this.hO.rowIndex+(a==40?1:-1):0;this.doHigh(i);}else if(a===13){if(this.hO){VM.LB.doClk(this,this.hO);}}},toggleAll:function(a){},show:function(){$.toggle(this.div.parentNode.$(),true)},hide:function(){$.toggle(this.div.parentNode.$(),false)},reset:function(){VM.Base.prototype.reset.call(this);if(this.hO){$.class_del(this.hO,this.dK);this.hO=null;}if(this.hH){this.hH.length=this.gw.length=this.D.length=this.bZ.length=0;this.cD=false;}if(this.hM){this.hM=null;}},dispose:function(){if(this._disposed)return;if(this.fx){this.fx=null;delete this.fx;if(this.fx_list){for(var i=0,k;i<this.fx_list.length;i++){if(k=VM._a[this.fx_list[i]])k.remove();}this.fx_list.length=0;this.fx_list=null;delete this.fx_list;}}if(this.virmx){this.virmx.dispose();this.virmx=null;}for(var i=0;i<this.jD.length;i++){this.jD[i].dispose();}this.hH=this.gw=this.D=this.bZ=null;delete this.hH;delete this.gw;delete this.D;delete this.bZ;this.onclick=this.ondblclick=null;delete this.onclick;delete this.ondblclick;VM.Base.prototype.dispose.call(this);}}});Fn.fW('VM.LB.fO',{Const:function(x,a,b){this.x=x;Fn.TreeItem.call(this,a,b);this.pk=this.attr('pk')||this.id;this.open=true;},Extend:[Fn.TreeItem],Prototype:{hx:function(){return $.pel($(this.id),'TD',$(this.tree.vmid+'-tb'));},hI:function(){return $.pel($(this.id),'TR',$(this.tree.vmid+'-tb'));},attr:function(a){return a in this.x?this.xml.getAttribute(this.x[a]):Fn.TreeItem.prototype.attr.call(this,a);},toggle:function(a){Fn.TreeItem.prototype.toggle.call(this,a);VM.LB.fN.hD(this);}}});Fn.fW('VM.LB.fN',{Const:function(x,a,b){this.x=x;this.id=Fn.Tree.getId();this.pk=this.id;this.tree=b;b.add(this);},Extend:[Fn.Tree],Prototype:{},Helper:{hD:function(a){for(var i=0;i<a.length;i++){var c=a[i];c.hI().style.display=this.cN(c);if(c.length)this.hD(c);}},cN:function(a){while(a=a.parentNode){if(!a.open)return 'none';}return '';}}});Fn.fW('VM.LB.fP',{Const:function(x,a,b,c){this.x=x;VM.LB.fO.apply(this,arguments);this.src=a.getAttribute('src');this.loaded=c;this.loading=false;this.open=js.m(this.attr('op'));if(!c){if(this.open){var d=this.src,e=this.id,f=VM._a[b.vmid];if(f.$())this.tree.hb(this.src,this);else Fn.Div.addOnRender(f.div,Function('Fn.Tree._a["'+e+'"].tree.hb("'+d+'",Fn.Tree._a["'+e+'"])'));}}},Extend:[Fn.TreeItem],Xpro:[VM.LB.fO],Prototype:{toggle:function(a){if(a==null)a=!this.open;if(this.loading)return;if(!this.loaded){var c=this.hx(),d=c.cellIndex,e=c.parentNode,f=e.cells,g=e.parentNode.parentNode.insertRow(e.rowIndex+1);g.height=20;for(var i=0,l=f.length;i<l;i++){var h=g.insertCell(0);h.className='td';if(i==d){var m=new VM.LB.fQ(this.tree);this.add(m,null,true);this.eo=m;h.innerHTML=m.html();}else{h.innerHTML='&nbsp;';}}}if(a){if(!this.loaded)this.tree.hb(this.src,this);}VM.LB.fO.prototype.toggle.call(this,a);}}});Fn.fW('VM.LB.fQ',{Const:function(a){Fn.TreeTmpItem.call(this,a);},Extend:[Fn.TreeTmpItem],Xpro:[VM.LB.fO]});Fn.fW('VM.LB.bw',{Const:function(a){Fn.Tree.DivTree.call(this,a);},Extend:[Fn.Tree.DivTree],Prototype:{fR:function(a,b){if(a===false)return this.ip(b);var x=a.tagName=='view'?$.x(a,'static/fr/tree'):a;if(!x)return this.ip(a);var c=$.xs(x,'d');if(b.eo){var d=b.eo.hI();d.parentNode.deleteRow(d.rowIndex);}if(!c.length&&this.emptyreload){b.reset();b.fireEvent('load',[a]);return;}var lb=VM._a[b.tree.vmid],hL=lb.di(c,b);mtr=lb.cQ($.xs(x,'./'+(this.gn?'/d[not(ancestor::tree)]':'d')),hL,0);s=this.r_data(mtr,0,mtr.length,lb.gj),o=document.createElement('DIV'),tr=b.hI(),tx=lb.tr2x(tr),tp=tr.rowIndex+1,tb=tr.parentNode;o.innerHTML='<table>'+s+'</table>';for(var t=o.firstChild.rows,i=t.length-1;i>-1;i--){tb.insertBefore(t[i],tb.rows[tp]);}for(i=c.length-1;i>-1;i--){tx.insertBefore(c[i],tx.firstChild);}$.rm(o);o=t=tr=tx=tb=null;if(b.eo){b.eo.remove();delete b.eo;}if(!b.folder){b.folder=true;b.toggle(false);}else{}b.vis=true;if(b.src){b.loaded=true;b.loading=false;}}}}); ﻿Fn.fW('VM.MX',{Const:function(a,b){VM.Base.call(this,a);this.hq=[];this.bZ=[];this.aW=new Fn.FormCheck();var d;this.ek=(d=a.getAttribute('lineflds'))&&d.replace(/;/g,',');this.gx=a.getAttribute('scroll')||'miniscroll';this.ay=this.gx=='scroll';this.fj=(d=$.xt(a,'@cellpadding'))?js.m(d):6;this.gX=(d=$.xt(a,'@cellspacing'))?js.m(d):1;this.ba=$.xi(a,'form/@checkmodify');this.gj=$.xi(a,'@rh');this.iD=$.xi(a,'@hsp');this.iC=$.xi(a,'@vsp');this.jt={};if(this.ba)this.parentNode.ba=true;if(b){this.xml=a;this.ac=b;b.parentNode.addNode(this);}},Extend:[VM.Base],Helper:{},Prototype:{type:'mx',ff:26,dQ:18,ek:null,au:false,fj:null,D:null,gx:null,ay:false,aW:null,fd:false,design:function(a,b,_0,_1,_2,_3){var c=a.add(_0,_1,_2,_3,this.gx);c.addEvent('resize',this.gd,this);this.contdiv=a;return this.div=c;},data:function(){if(this.div)this._main_data();},gd:function(){if(this.div.last_wd===this.div.wd)return;for(var i=0;i<this.hq.length;i++){var o=$(this.id+'-tbl-'+i);if(!o)continue;var iMinus=0,oRoot=o.parentNode;while(this.div.$().contains(oRoot.parentNode)){if(oRoot.tagName=='FIELDSET')iMinus+=12;oRoot=oRoot.parentNode;}this.dm(this.hq[i],null,iMinus);o.setAttribute('ikcols',this.D);$.coltb(o,this.cY(iMinus));this.gl($.query('input,textarea,select,div.mxlbl',o));this.gl($.tags('div',o),'box');this.gl($.query('table.mxhzgrtbl',o),'hzgr');this.gm(this.hq[i]);}this.fireEvent('resize');},jg:function(tb,sca){var c=tb.tBodies[0].rows[0].cells;for(var i=0;i<c.length;i++){this.gl($.query('input,textarea,select,div.mxlbl',c[i]),null,sca[i]);this.gl($.tags('div',c[i]),'box',sca[i]);}},gl:function(ar,tp,wd){for(var i=0;i<ar.length;i++){var o=ar[i],ly=o.getAttribute('layout');if(ly&&!o.getAttribute('df_fix')){var r=ly.slice(0,-1),c=ly.slice(-1),w=wd||(c=='2'||c=='4'?this.ck:this.fd[r+c]),m=js.m(o.getAttribute('minus'));if(tp=='hzgr'){var x=this.x('.//i[@n="'+o.getAttribute('name')+'"]'),s=x.getAttribute('cols');if(s){var u=js.m_scale(w-m,s);this.jg(o,u);for(var j=0,m,t=$.xs(x,'ipts/i');j<t.length;j++){if((m=t[j].getAttribute('n'))&&(m=this.jt[m]))m.w=u[j];}}}else{o.style.width=Math.max(0,w-m)+'px';if(tp==='box'&&(o=Fn.XBox.getById(o.id))){o.x.w=w;if(o.eQ)o.hide();if(o.div)o.div.resize(w);}}}}},gm:function(a){if(a.length&&a[0].parentNode){var b=$.xs(a[0].parentNode,a.expr.replace(']',' and @tp="plugin"]'));for(var i=0,c;i<b.length;i++){c=this.fy[b[i].getAttribute('n')];if(c){var d=c.layout.slice(-1);c.width=d=='2'||d=='4'?this.ck:this.fd[c.layout];}}}},cJ:function(a,b){var c=a||this.xs('form//i[@fu!="1" and tp!="hidden" and @t!=""]'),d=false,e=0,f=0,l=c.length;for(var i=0,g,h,n;i<l;i++){g=c[i];h=g.getAttribute('t');e=Math.max(h?js.s_px(h,null,Cfg.fontSize):$.xi(g,'tt/@w'),e);if(g.getAttribute('tp')==='plugin')e=Math.max(e,Math.max.apply(Math,js.map($.xs(g,'.//form/i'),'js.s_px(v.getAttribute("t"),null,Cfg.fontSize)')));n=g.getAttribute('n');if(n&&js.ids_inc(this.ek,n))d=true;}b=Math.abs(b);f=js.m_rng(e+31,(d?72:78)+Math.floor(this.div.i_wd*0.015),(d?0.22:0.45)*b);if(this.fj>6)f+=this.fj-6;this.au=d;var t,u;if(l&&(t=a?a[0]:this.x('form/i'))){while(t&&t.tagName!=='fr'){t=t.parentNode;if(t&&t.nodeType==1&&(u=t.getAttribute('cols')))break;}}u=u||this.xt('@cols');if(u){u=u.split(',');if(d&&u.length<3)u=u[0]+','+u[1]+','+u[0]+','+u[1];else if(!d&&u.length>3)u=u[0]+','+u[1];else u=u.join();}return u||(d?(f+',*,'+f+',*'):(f+',*'));},dm:function(a,b,c){var m=this.div.i_wd;m=Math.abs(m);this.D=b||this.cJ(a,m);var w=m;if(c)w-=c;w=Math.abs(w);var d=js.m_scale(w,this.D),e=this.fj+this.gX,f=e+Math.floor(e/2),l1=Math.max(d[1]-e-f-(this.au?this.gX:0),13),l2=Math.max(m-d[0]-(e+f),13);var g={w:w,ei:d[0],text1:l1-7,text3:l2-7,xbox1:l1-7,xbox3:l2-7,plainbox1:l1-7,plainbox3:l2-7,pickbox1:l1-7,pickbox3:l2-7,combobox1:l1-7,combobox3:l2-7,olbox1:l1-7,olbox3:l2-7,textarea1:l1-5,textarea3:l2-7,password1:l1-9,password3:l2-9,label1:l1-4,label3:l2-4,plugin1:l1,plugin3:l2,spinner1:l1-10,spinner3:l2-10,horizontalgroup1:l1-4,horizontalgroup3:l2-4};this.ck=Math.abs(w-e-f-1+(e?2:0));this.fd=g;this.eC=c;this.cP();},cY:function(a){return Math.abs(this.div.i_wd-(a||0));},g_i_wd:function(a,b){var m=a==='text'?2:(a==='textarea'?4:0),n=a?this.fd[a+(b||3)]:null;if(n)n-=m;return n;},_main_data:function(){this.div.data(this.cM(this.x('form')));},cM:function(a,b,t){if(b==null)b=0;var c=$.xs(a,'set|i'),l=c.length,d=[0],s=['<div id='+this.id+'-cont'+(t==null?'':t)+' class=mx_cont>'];for(var i=0;i<l;i++)if(c[i].tagName=='set')d.push(i+1);d.push(i+1);for(var i=0,e=0,f,g;i<l;i++){f=c[i];if(f.tagName=='set'){s.push(this.gF(f,b));e++;}else{var h=this.hp(a,b,null,'position()>'+d[e]+' and position()<'+d[e+1]);s.push(h);i=d[e+1]-2;}}return s.join('')+'</div>';},gF:function(a,b,c){if(b==null)b=0;var x=$.x_obj(a);c=c||x.t;if(x.op){var e='<img src='+Cfg.imgp+(x.op==1?'minus':'plus')+'.gif style=vertical-align:middle onclick=VM.MX.tg_fset(this)>';c=c.indexOf('><label')>0?c.replace('><label','>'+e+'<label'):e+c;}var _0=x['class'],_1=x.style;return '<fieldset class="mxset'+(Br.ie?'':' bd-mid')+(_0?' '+_0:'')+'"'+(_1?' style="'+_1+'"':'')+'><legend>'+(c||x.t)+'</legend><div style='+(x.op=='0'?'height:0':'')+'>'+this.cM(a,15+b)+'</div></fieldset>';},cP:function(w){var w=w||this.cY(this.eC),c=js.m_scale(w,this.D),p=this.fj,e=Math.floor(p/2),f=[],k=[];for(var i=0,d=Math.max(p,this.iD),v=this.iC;i<c.length;i++){var h=Math.abs(c[i]-(Br.cmp?0:p)-(this.gX*1)),g=(i%2?'padding:'+(v||e)+'px 0 '+(v||e)+'px '+p+'px;':'padding:'+e+'px '+d+'px '+e+'px 0;text-align:right');f[i]=g;k[i]=h;}k[0]-=this.gX;this.eH=f;this.eI=k;},hp:function(xx,b,c,d){var a=xx.selectNodes('(set|i)[@tp!="hidden"'+(d?' and ('+d+')':'')+']');this.dm(a,c,b);var w=this.cY(b),s=['<table id='+this.id+'-tbl-'+(this.hq.push(a)-1)+' ikcols='+this.D+' minus='+b+' class=mxtbl style=width:'+w+'px cellspacing='+this.gX+' cellpadding=0><colgroup>'];for(var i=0;i<this.eI.length;i++)s.push('<col style="width:'+(this.eI[i]+'px')+'"'+(' minus='+((Br.cmp?0:this.fj)+this.gX*(i===0?2:1)))+'>');s.push('</colgroup><tbody>');this.bm=0;var vmid=VM.aN(this.id).id;for(var i=0,l=a.length;i<l;i++){var _x=a[i],x=$.x_obj(_x);x.vmid=vmid;x.mxid=this.id;x.rdn=x.rdn==1;x.ds=x.ds==1;x.fu=x.fu==1;if(this.bm==0){var st='';if(x.hdn==1)st+='display:none;';if(this.gj)st+='height:'+this.gj+'px;';s.push('<tr class=tr'+(st?' style="'+st+'"':'')+'>');}var bcols=this.au&&(!x.n||!js.ids_inc(this.ek,x.n)),va=x.valign||'middle';x.hX=x.bp=bcols?3:1;if(x.fu||x.tp==='hr')x.bp=bcols?4:2;else{s.push('<td class="td-label va-'+va+'" style="'+this.eH[0]+';');if(x.rh)s.push('height:'+x.rh+'px;');s.push('"><label class=mx-label id='+x.vmid+'-'+x.n+'-title>'+(x.star==1?'<span class=mx-star>*</span>':'')+(x.t?x.t+':':'')+'&nbsp;</label>');}if(this.au&&x.bp==1){this.bm++;if(this.bm==2)this.bm=0;}var wd=this.eI[1];s.push('<td class="td-input'+(x.bp>1?' z-colspan':'')+'" valign='+va+' style="'+this.eH[1]+'"');if(x.bp>1)s.push(' colspan='+x.bp);if(x.fu)s.push(' align=left');s.push('>'+this.cF(x,_x));}s.push('</tbody>');if(Br.ie&&Br.ieVer>8){s.push('<tfoot class=none><tr>');for(var i=0;i<this.eI.length;i++)s.push('<td>');s.push('</tfoot>');}s.push('</table>');a=xx.selectNodes('(set|i)[@tp="hidden"'+(d?' and ('+d+')':'')+']');if(a.length){for(var j=0,l=a.length;j<l;j++){f=$.x_obj(a[j]);s.push('<input type=hidden name='+f.n+' id='+vmid+'-'+f.n+(f.ds?' disabled':'')+' value="'+js.s_quot(f.v)+'">');}}return s.join('');},cF:function(x,xx,y){if(!x.n){x.n=$.eid('_MX_');if(xx)xx.setAttribute('n',x.n);}var a=[],b=x.vmid,d=b+'-'+x.n,c='<input type='+x.tp+' name='+x.n+' id='+d+(x.rdn?' readonly':'')+(x.ds?' disabled':''),r=x.rdn||x.ds,w=x.fu==1?this.ck:this.fd[x.tp+x.hX];if(!w){w=VM.MX.iK(x);if(!('cA' in x))x.cA=1;}if(x.w){if(isNaN(x.w)&&x.w.indexOf('%')>0){if(!x.hX)x.hX=1;w=Math.ceil(js.m(x.w)*((x.fu==1?this.ck:this.fd[x.tp+x.hX])||w)/100);}else{w=js.m(x.w);if(!('cA' in x))x.cA=1;}w=Math.min(w,x.hX?w:js.m(x.w));}if(x.mkw)x.eF=js.m(x.mkw)+1+(x.eF||0);if(x.eF)w-=x.eF;if(!x.bO&&x.fu==1){w-=Math.floor(this.fj/2)+2*this.gX;}w=Math.abs(w);var ly=x.hX?' layout="'+(x.ef||x.tp+x.bp)+'"':'',sp='<span class="txwrp'+(x.trans==1?' f-trans':'')+(x.clz?' '+x.clz:'')+'">';switch(x.tp){case 'hidden':a.push('<input type=hidden name='+x.n+' id='+d+(x.ds?' disabled':'')+' value="'+js.s_quot(x.v)+'">');break;case 'text':var sc=Cfg.shortcut&&x.noshct!=1,mn=sc?21:3;x.eF=mn+(x.eF||0);if(x.fu&&!x.w)w-=3;a.push(sp);if(x.graytip)a.push(VM.MX.jk(d,x.graytip,!!x.v));a.push(c+' value="'+x.v+'" onfocus=VM.MX.f_focus(this) onblur=VM.MX.f_blur(this) onkeydown=VM.keysubmit("'+b+'",event)',y||(' class="mx_text bd-input'+(r?' rdn':'')+(x.bg?' cstbg':'')+(sc?' z-trg':'')+'" style="width:'+Math.abs(w-mn)+'px;'+(x.bg?'background-color:'+x.bg+';':'')+'"'+(x.eF?' minus='+x.eF:'')+ly));if(x.graytip)a.push(' data-graytip="'+x.graytip+'"');if(x.tbi)a.push(' tabIndex='+x.tbi);if(x.cA)a.push(" df_fix=1");var ml=xx&&$.xt(xx,'vlds/v[@vld="default"]/@mxl');if(ml){a.push(' maxlength='+ml);}a.push('>');if(sc)a.push('<a class="trg_shortcut bd-input'+(r?' z-ds':'')+(x.bg?' cstbg':'')+'"'+(x.bg?' style="background-color:'+x.bg+'";':'')+' href=javascript:; df_trg=1 onclick=VM.MX.shortcut("'+b+'","'+x.n+'") hidefocus></a>');if(x.mk)a.push('<span id='+d+'-mk class=mktx style="width:'+(x.mkw-3)+'px;">'+x.mk+'</span>');a.push('</span>');this.addcheck(x);break;case 'password':if(x.fu&&!x.w)w-=2;a.push(sp+c+' value="'+x.v+'" onfocus=VM.MX.f_focus(this) onblur=VM.MX.f_blur(this) onkeydown=VM.keysubmit("'+b+'",event)',(y||(' style="width:'+w+'px;'+(x.bg?'background-color:'+x.bg+';':'')+'"'+(x.eF?' minus='+x.eF:'')+ly+(x.tbi?' tabIndex='+x.tbi:'')+(x.cA?' df_fix=1':'')+' class="left mx_text bd-input'+(r?' rdn':'')+(x.bg?' cstbg':'')+'"')));var ml=xx&&$.xt(xx,'vlds/v[@vld="default"]/@mxl');if(ml){a.push(' maxlength='+ml);}a.push('>');if(x.mk)a.push('<div id='+d+'-mk class=mktx style="width:'+(x.mkw-3)+'px;">'+x.mk+'</div>');a.push('</span>');this.addcheck(x);break;case 'textarea':if(!x.v)x.v=(xx&&xx.text)||'';var mn=10,ht=x.ht||80;x.eF=mn+(x.eF||0);a.push(sp);if(x.graytip)a.push(VM.MX.jk(d,x.graytip,!!x.v));a.push('<div class="clearfix ps-rel ln-bl" id='+d+'-wrap><textarea name='+x.n+' id='+d+' onfocus=VM.MX.f_focus(this) onblur=VM.MX.f_blur(this) onmousewheel=VM.MX.txr_wheel(this,event)'+(x.rdn?' readonly':'')+(x.ds?' disabled':''),(y?y:(' class="mx_textarea bd-input'+(r?' rdn':'')+(x.bg?' cstbg':'')+'" style="width:'+(w-mn)+'px;min-height:'+ht+'px;padding-right:6px;'+(x.tbi?' tabIndex='+x.tbi:'')+(x.bg?'background-color:'+x.bg+';':'')+'"'+(x.eF?' minus='+x.eF:'')+ly)));if(x.graytip){a.push(' data-graytip="'+x.graytip+'"');}if(x.cA)a.push(' df_fix=1');var ml=xx&&$.xt(xx,'vlds/v[@vld="default"]/@mxl');if(ml){a.push(' maxlength='+ml);}a.push('>'+x.v+'</textarea>');if(x.mk)a.push('<span id='+d+'-mk class=mktx style="width:'+(x.mkw-3)+'px;">'+x.mk+'</span>');a.push('</div></span>');this.addcheck(x);break;case 'select':var s=sp+(Br.ie&&Br.ieVer<8?'<div class="left rdowrp">':'')+'<select name='+x.n+' id='+d+(x.mul==1?' multiple':' class="left mx_select bd-input"')+(x.eF?' minus='+x.eF:'')+ly;if(x.size)s+=' size='+x.size;if(x.mul==1)s+=' multiple';if(x.ds)s+=' disabled';if(x.w&&!x._aw)s+=' style=width:'+x.w+'px;';if(x.tbi)s+=' tabIndex='+x.tbi;if(x.cA)s+=' df_fix=1';s+=y;a.push(s+' onfocus=VM.MX.f_focus(this)>');for(var j=0,e=xx?$.xs(xx,'opts/o'):x.childNodes,f,l=e.length;j<l;j++){f=e[j];g=f.getAttribute('v');a.push('<option value="'+(g||'')+'"'+(f.getAttribute('checked')==1||(x.mul==1?js.ids_inc(x.v,g):x.v==g)?' selected':'')+(x.bg?' style="background:'+x.bg+'"':'')+'>'+(f.text||''));}a.push('</select>'+(Br.ie&&Br.ieVer<8?'</div>':''));if(x.mk)a.push('<em class="mknm"'+(x.mkw?' style="width:'+(x.mkw)+'px;"':'')+'>'+x.mk+'</em>');a.push('</span>');this.addcheck(x);break;case 'radio':case 'checkbox':var xs=xx?$.xs(xx,'opts/o'):x.childNodes,l=xs.length;a.push(sp+'<div class=rdowrp'+(x.w&&!x._aw&&x.w>18?' style=width:'+x.w+'px;':'')+'>');for(var j=0,e,f;j<l;j++){e=xs[j];f=e.getAttribute('v');a.push(VM.MX.rdohtml(x,js.uid(),f,e.getAttribute('checked')==1||js.ids_inc(x.v,f),e.text));}a.push('</div></span>');if(x.mk)a.push(x.mk);this.addcheck(x);break;case 'triplebox':a.push(sp+'<span class=tree onselectstart=return(false)><input class=b'+(js.m(x.c)+(x.rdn||x.ds?3:0))+' id='+d+' name='+x.n+' value='+x.c+' readonly onclick=VM.MX.trpclk(this,'+(x.a==1)+') clk="'+js.s_quot(x.clk)+'"><label style=padding-left:2px onclick=VM.MX.trpclk(this.previousSibling,'+(x.a==1)+')>'+(x.lb||'')+'</label></span></span>');x.hdl=function(){if(x.ntn&&$(d).value=='0')return Loc.ps(Loc.form.notnull,x.t);};this.addcheck(x);break;case 'radiogroup':case 'checkboxgroup':var xs=xx?$.xs(xx,'ipts/*[not(@tp) or @tp!="hidden"]'):x.childNodes,l=xs.length,tp=x.tp.replace('group',''),lw=this.fd.ei,cw=this.fd.text3-6,sw=!!(xx&&$.x(xx,'ipts/set'))?16:0,md=this.eC,arTx=[],rV=x.v.split(','),r=this.jt,rw=0;for(var i=0,e;i<l;i++){e=xs[i];arTx.push(e.getAttribute('t'));if(e.tagName=='i')rw=Math.max(rw,26+js.s_px(arTx[i],null,Cfg.fontSize));}a.push('<table width=100% cellspacing=0 cellpadding=0'+(x.rh?' height='+x.rh:'')+'><colgroup><col style=width:'+(rw+sw+(x.fu?11:5))+'px><col></colgroup><tbody><tr style=display:none><td><td>');for(var j=0;j<l;j++){var xo=xs[j],s=VM.MX.rdohtml(x,js.uid(),rV[j],js.ids_inc(x.cv,rV[j]),arTx[j],'VM.MX.grpclk("'+x.mxid+'",this,'+x.rdn+')',true);if(xo.tagName=='set'){a.push('<tr><td colspan=2>',this.gF(xo,(x.fu?0:lw+5)+sw,s));this.eC=md;this.dm(null,null,this.eC);}else{var o=$.x_obj(xo,{fu:x.fu,bp:x.bp,vmid:x.vmid,mxid:x.mxid,hX:x.hX,eF:rw+sw+(x.fu?14:7),rdn:x.rdn,ds:x.ds},true);r[o.n]={fu:x.fu,bp:x.bp,hX:x.hX,eF:rw+sw+(x.fu?14:7)};a.push('<tr style="height:'+(o.rh||30)+'px;"><td class="nobr va-top" style="padding-left:'+sw+'px;"><div style="margin:2px 0">'+s+'</div><td class=va-top tp="'+o.tp+'" onclick=VM.MX.aR(this,"'+o.n+'")>'+this.cF(o,xo));this.addcheck(o);}}a.push('</tbody></table>');if(xx){xs=$.xs(xx,'ipts/*[not(@tp) or @tp="hidden"]');for(var j=0;j<xs.length;j++){var xo=xs[j],o=$.x_obj(xo,{vmid:x.vmid,mxid:x.mxid,rdn:x.rdn,ds:x.ds},true);a.push(this.cF(o,xo));}}this.addEventOnce('render',Function('try{VM.MX.grpclk("'+x.mxid+'",VM._a["'+x.vmid+'"].f("'+x.n+'")[0],'+x.rdn+')}catch(e){}'));this.addcheck(x);break;case 'horizontalgroup':var s='<table id='+d+' name='+x.n+' class="mxhzgrtbl txwrp" cellpadding=0 cellspacing=0 layout="'+(x.ef||x.tp+x.bp)+'"'+(x.eF?' minus='+x.eF:'')+'><tr>',xs=xx?$.xs(xx,'ipts/i'):x.childNodes,cs=x.cols&&js.m_scale(w,x.cols),sw=!!(xx&&$.x(xx,'ipts/set'))?16:0,r=this.jt,l=xs.length;for(var i=0,o,t;i<l;i++){o=$.x_obj(xs[i]);t={vmid:x.vmid,mxid:x.mxid,eF:4+sw,hX:x.hX,bp:x.bp,cA:true,bO:true};if(o.n)r[o.n]=t;js.clone(o,t);if(!o.w&&cs){o.w=cs[i];o.cA=false;t.w=o.w;t.cA=false;}if(!o.w){o.w='120';o._aw=true;t._aw=true;t.w='120';};var st='';if(Br.ie&&Br.ieVer<8)st+='padding-bottom:1px';if(o.hdn)st+=';display:none';s+='<td'+(st?' style="'+st+'"':'')+'>'+this.cF(o,xs[i])+'</td>';this.addcheck(o);}s+='</table>';a.push(Br.cmp?s:'<div style=width:100%>'+s+'</div>');break;case 'verticalgroup':var xs=xx?$.xs(xx,'ipts/i'):x.childNodes,l=xs.length;for(var i=0;i<l;i++){var xo=xs[i],o=$.x_obj(xo,{bp:x.bp,vmid:x.vmid,mxid:x.mxid,eF:rw+4+sw,hX:x.hX},true);a.push('<div '+(i?'style="padding-top:7px"':'')+' class=clear>'+this.cF(o,xo)+'</div>');this.addcheck(o);}break;case 'button':if(x.fu==1)w=x.w;var btn=DFish.btn({t:x.v,clk:x.on_click,w:!x._aw&&x.w,focus:x.focus==1},{func:'office',face:x.face||'o-office',cellspacing:x.cellspacing||8});a.push('<div align='+(x.align||'left')+'>'+btn.wrapHtml()+'</div>');break;case 'spinner':var xv=x.mxv||(xx&&$.xt(xx,'vlds/v/@mxv')),nv=x.mnv||(xx&&$.xt(xx,'vlds/v/@mnv')),iStep=js.m(x.step)||1,_b=x.showbtn==1,_p=_b?21:1;w=this.iQ(x,String(js.m(xv)+iStep).length*6+36,_p);a.push(sp+'<input type=text name='+x.n+' id='+d+' onfocus=VM.MX.f_focus(this) onblur=VM.MX.f_blur(this) value="'+x.v+'" maxlength='+Math.floor(w/6)+(x.rdn?' readonly':'')+(x.ds?' disabled':''),y||(' style="width:'+w+'px;'+(x.bg?'background-color:'+x.bg+';':'')+'"'+ly+' minus="'+_p+'" class="left mx_text bd-input'+(r?' rdn':'')+(x.bg?' cstbg':'')+(_b?' z-trg':'')+'"'),(x.tbi?' tabIndex='+x.tbi:'')+(x.cA?' df_fix=1':'')+'>');if(_b){a.push('<span class="trg_spin bd-input'+(r?' z-ds':'')+'"><a href=javascript:; class=trg_spin_up df_trg=1 onclick=VM.MX.gY(this,"'+d+'",'+iStep+',"'+nv+'","'+xv+'") onblur=VM.MX.f_blur(this,"'+x.tp+'") hidefocus></a><a href=javascript:; onclick=VM.MX.gY(this,"'+d+'",-'+iStep+',"'+nv+'","'+xv+'") class=trg_spin_dn df_trg=1 hidefocus></a></span>');}if(x.mk)a.push('<em class=mknm style=width:'+x.mkw+'px>'+x.mk+'</em>');a.push('</span>');this.addcheck(x);break;case 'date':x.ag=x.df;w=this.iQ(x,VM.MX.iK(x),21);a.push(VM.MX.datehtml(x,y,null,w));if(x.mk)a.push(x.mk);this.addcheck(x);break;case 'dateperiod':x.ag=x.df;w=this.iQ(x,VM.MX.iK(x),21);a.push(VM.MX.datehtml(x,y,null,w),'<span class="left txwrp" style="line-height:27px">&nbsp;'+Loc.to+'&nbsp;</span>',VM.MX.datehtml(x,y,1,w));if(x.mk)a.push(x.mk);this.addcheck(x);break;case 'xbox':case 'imgbox':case 'plainbox':if(x.fu&&!x.w)w-=3;x.w=w||140;x.layout=x.hX?(x.ef||x.tp+x.bp):'';var t=new Fn[x.tp==='xbox'?'XBox':x.tp==='plainbox'?'PlainBox':'ImgBox'](x,xx);a.push(t.html(y));this.addEvent('beforecheck',t.save,t,null,null,x.n);this.addEventOnce('remove',t.dispose,t,null,x.n);x.hdl=js.fp(t,'g_error');this.addcheck(x);break;case 'combobox':case 'olbox':if(x.fu&&!x.w)w-=3;x.w=w||140;x.layout=x.hX?(x.ef||x.tp+x.bp):'';var t=new Fn[Fn.XBox.tpname[x.tp]](x);a.push(t.html(y));this.addEvent('beforecheck',t.save,t,null,null,x.n);this.addEventOnce('remove',function(){this.removeEvent('beforecheck',t.save,t);t.dispose();},null,null,x.n);x.hdl=js.fp(t,'g_error');this.addcheck(x);if(x.tp=='olbox')this.addEventOnce('render',t.checkOnStart,t);break;case 'plainbox':if(x.fu&&!x.w)w-=3;x.w=w||140;x.layout=x.hX?(x.ef||x.tp+x.bp):'';var t=new Fn.Pickbox(x);a.push(t.html());this.addEventOnce('remove',t.dispose,t,null,x.n);x.hdl=js.fp(t,'g_error');this.addcheck(x);break;case 'label':x.w=w;if(x.fr==1){x.text=(xx&&xx.text)||'';x.frid=b+'-'+x.n+'-fr';this.addEventOnce('render',js.bind(VM.MX.fr_dsp,null,x));}var s=(xx&&xx.text)||'';if(s.indexOf('<fish:js>')>-1)s=s.replace(/<fish:js>([\s\S]+?)<\/fish:js>/gi,function($0,$1){return Function($1).call(this)||''});a.push(sp+'<div class="df-cn'+(x.fr==1?' lblfr':'')+'" ikmin=4 id="'+d+'"'+(x.w&&!x._aw?' style="width:'+x.w+'px"':'')+(x.cA?' df_fix=1':'')+(x.hX?' layout="'+(x.ef||x.tp+x.bp)+'"':'')+(x.eF?' minus='+x.eF:'')+'>'+(x.fr==1?$.htm.iframe(w-36,22,'',x.frid):s)+'</div></span>');break;case 'hr':var s='<div '+(x.tx?'':'id='+d)+' style=height:1px;background-color:#ccc;overflow:hidden;'+(x.tx?'':'margin-left:2px;')+'></div>';a.push('<span class=txwrp style=display:block>');if(x.tg){a.push('<div class=mx_hr_tg id='+d+' onclick=VM.MX.hr_tgl(this)>'+$.htm.fic('.i-ul-down','margin-right:3px','mx_hr_tgic')+x.tx+'</div>');}else if(x.tx){a.push('<table '+(x.tx?'id='+d:'')+' width=99% style=margin-left:2px;><tbody><tr><td style="padding:0 2px"><nobr class=hand id='+d+'-tg onclick=VM.MX.hr_tgl(this)>'+x.tx+'</nobr><td width=100%>'+s+'</tbody></table>');}else a.push(s+'</span>');if(x.tg=='collapse')this.addEventOnce('render',Function('VM.MX.hr_tgl($("'+d+'"))'));break;case 'file':x.w=w;var f=new VM.MX.File(x,xx);a.push(f.html());this.addEventOnce('remove',f.dispose,f);this.addcheck(x);break;case 'plugin':a.push(new VM.MX.PluginElement(this,x,w).init(xx));break;default:if(x.face&&!x.hG){x.hG=x.tp;x.tp=x.face;a.push(arguments.callee.apply(this,arguments));}else return '';break;}return a.join('');},iQ:function(x,w,mn){var mw=js.m(x.mkw),ww=x.fu==1?this.ck:this.fd[x.tp+x.hX];if(!('cA' in x))x.cA=1;if(x.w){if(isNaN(x.w)&&x.w.indexOf('%')>0){w=Math.floor(ww*js.m(x.w)/100);x.cA=0;}else w=js.m(x.w);}if(w+mn+mw>ww)w-=(w+mn+mw)-ww;return w;},iHtml:function(x,y,n){var xx;if(typeof x=='string'){xx=$.x_doc(x);x=$.x_obj(xx);}else if(x.nodeType==1){xx=x;x=$.x_obj(xx);}x.vmid=VM.aN(this.id).id;x.mxid=this.id;if(xx){if(n){if(this.jt[n]){js.extend(x,this.jt[n]);if(!x.w&&x.bO)x.w=120;}}else{var v=$.x_add(this.x(),'form');if(this.vis)xx.setAttribute('iHtml',1);$.append(v,xx);}return this.cF(x,xx,y);}},iInit:function(){var s=this.xs('form//i[@on="1" and @iHtml="1"]');if(s.length)this.atchev(js.each(s,'v.removeAttribute("iHtml")'));},fL:function(){if(this.vis)return;if(this.parentNode.type=='vm')this.bI();else{var lb=this.parentNode,vm=lb.parentNode;if(!vm.vis){vm.addEventOnce('render',this.bI,this);}else if(!lb.vis){lb.addEventOnce('render',this.bI,this);}else this.bI();}},bI:function(){var a=this.xt('pub/focus');if(a)this.parentNode.f(a).focus();this.atchev();this.fireEvent('render');},atchev:function(a){var s=a||this.xs('form//i[@on="1"]'),b=/on_([a-z]+)="[^"]+"/gi;for(var i=0;i<s.length;i++){var x=s[i],c=x.cloneNode(false).xml,n=x.getAttribute('n'),t=x.getAttribute('tp'),p=this.parentNode.type=='vm'?this.parentNode:this.parentNode.parentNode,d=p.f(n),f,g;if(!d){continue;}while(f=b.exec(c)){VM.MX.prototype.ab.call(this,x,d,f[1]);if(t=='dateperiod'){VM.MX.prototype.ab.call(this,x,p.f(x.getAttribute('n1')),f[1]);}}if(a)arguments.callee.call(this,$.xs(x,'.//i'));}},ab:function(x,d,v){var e=x.getAttribute('tp'),g=x.getAttribute('on_'+v);if(e.indexOf('radio')>-1||e.indexOf('checkbox')>-1){var r,f;if(v=='change'){v='click';r=x.getAttribute('v');f=function(){var a=VM(this).fv(this.name);if(r!=a){r=a;eval(g);}}}for(var j=0;j<d.length;j++)d[j].attachEvent('on'+v,js.bind(f||Function(g),d[j]));}else{var p=(d.type==='text'||d.type==='textarea')&&v=='change',h=d.value,k=p&&x.getAttribute('graytip'),t;$.e_add(d.$?d.$():d,(p?(Br.ie?'propertychange keyup':'input'):v),function(){if(p&&Br.ie){var o=this,u=o.value,c=function(){if(Br.cmp)Function(g).call(o);else{clearTimeout(t);t=setTimeout(js.bind(g,o),10);}};if(k&&u==k)u='';if(event.propertyName==='value'||event.type==='keyup'){if(h!==u)c();}h=u;}else Function('event',g).call(this,event);});}},g_form_error:function(a){var g=this.vis&&this.div?this.div.$():this.parentNode.$();;this.aW.rng=g;if(a&&g){var b=(this.ac||this).xs('.//vlds/v[@vld="'+a+'"]'),c=js.hashArray();for(var i=0,d,e;i<b.length;i++){if(d=this.aW.get($.xt(b[i],'../../@n')))c.add(d.n,$.x_obj(b[i]));}}return this.aW.g_error(c);},addcheck:function(){this.aW.add.apply(this.aW,arguments);},rmcheck:function(a){this.aW.rm(a);},addpl:function(a,b){if(!this.fy)this.fy={};this.fy[a]=b;},dB:function(){var a=$.f_els(this.$());for(var i=0,l=a.length;i<l;i++)if(VM.MX.co(a[i]))return true;return false;},show:function(){$.toggle(this.div.parentNode.$(),true)},hide:function(){$.toggle(this.div.parentNode.$(),false)},reset:function(){VM.PLUGIN.prototype.reset.call(this);delete this.hq;if(this.ac){delete this.ac;delete this.xml;}}},Helper:{rdohtml:function(x,j,v,a,b,c,g){var d=x.vmid+'-'+x.n+(j?'-'+j:''),e='';if(c)e+=c+';';else if(x.rdn)e+='VM.MX.rdonly(this);';if(x.onclick)e+=x.onclick;return(Br.ie8?'':'<nobr>')+'<input class=mx_radio hidefocus type='+x.tp.replace('group','')+' name='+x.n+' id='+d+'-'+j+' value="'+v+'"'+(a?' checked':'')+(x.ds?' disabled':'')+(e?' onclick="'+js.s_quot(e)+'"':'')+(g?' data-ingroup=1':'')+'><label for='+d+'-'+j+'>'+b+'</label>'+(Br.ie8?'':'</nobr>')+' '+(x.br==1?'<br>':'');},rdonly:function(a){js.each(VM(a).f(a.name),'v.checked = v.defaultChecked');},trpclk:function(a,b){var c=js.m(a.className.replace(/[a-z]/g,'')),d;if(c<3){d=c+1;if(d>(b?1:2))d=0;a.value=d;a.className=a.className.replace(/\d/,d);if(c=a.getAttribute('clk'))Function(c).call(a);}},grpclk:function(a,b,c){if(c){VM.MX.rdonly(b);}else{var vm=VM(a);xs=vm.xs('.//static//i[@n="'+b.name+'"]/ipts/*[not(@tp) or @tp!="hidden"]'),cs=vm.f(b.name);for(var i=0,c,d;i<xs.length;i++){c=xs[i];d=!cs[i].checked;if(c.tagName=='set'){var ar=$.xs(c,'.//i');for(var j=0;j<ar.length;j++)this.ds_x(a,ar[j],d);}else this.ds_x(a,c,d);}}},ds_x:function(a,b,c,r){var x=$.x_obj(b),d;if(x.tp=='file'){if(d=this.File.get(a,x.n))d.disable(c,r);return;}else if(x.tp.indexOf('group')>0){d=$.xs(b,'ipts/i');for(var i=0;i<d.length;i++){this.ds_x(a,d[i],c,r);}if(x.tp==='horizontalgroup')return;}else if(x.tp&&!x.n)return;d=x.n?VM(a).f(x.n):b;if(!d)return;if(x.tp.indexOf('radio')<0&&x.tp.indexOf('checkbox')<0)d=[d];for(var i=0,o,n;i<d.length;i++){o=d[i];if(js.ids_inc('INPUT,TEXTAREA,SELECT',o.tagName)){o[r?'readOnly':'disabled']=c;$.class_add(o,'rdn',!c);}switch(x.tp){case 'text':case 'textarea':if(o.nextSibling&&o.nextSibling.className.indexOf('trg_shortcut')>-1)$.class_toggle(o.nextSibling,'z-ds',c);break;case 'spinner':$.class_toggle(o.nextSibling,'z-ds',c);break;case 'xbox':case 'imgbox':case 'combobox':case 'olbox':case 'pickbox':o&&Fn[Fn.XBox.tpname[x.tp]].get(a,x.n,r?DFish.READONLY:DFish.DISABLE,c);break;case 'triplebox':var e=js.m(o.className.replace(/[a-z]/g,''));if(!x.rdn)o.className=o.className.replace(/\d/,c?e+(e>2?0:3):e-(e>2?3:0));break;case 'date':case 'dateperiod':$.class_toggle(o.nextSibling,'z-ds',c);if(x.tp==='dateperiod'){var n=VM(a).f(x.n1);n.disabled=c;$.class_add(n,'rdn',!c);$.class_toggle(n.nextSibling,'z-ds',c);}break;case 'label':break;case 'plugin':o.callSettings(DFish.DISABLE,c);break;}}},gk:function(a,b){if(a){var mn=js.m(a.getAttribute('minus'));if(a.getAttribute('df_fix')!=1){a.style.posWidth=b[0]-mn;}}},iK:function(x){u=0;if(x.tp){u=120;if(!x.tp.indexOf('date')){var l=x.df.length,u=134;if(l==10)u=96;else if(l>16)u=154;else if(l<10)u=82;else if(l<6)u=62;}else if(x.tp=='button')u=0;}return u;},datehtml:function(x,y,a,w){if(!a)a='';var df=x.df,n=x['n'+a],v=x['v'+a],rdn=x['rdn'+a]==1,ds=x['ds'+a]==1,st='';if(x.eF)w+=x.eF;if(x.bg)st+='background-color:'+x.bg+';position:relative;';st+='width:'+Math.abs(Math.min(x.w&&!isNaN(x.w)&&!x._aw?x.w:w,w))+'px;';return '<span class="left txwrp"><input type=text name='+n+' id='+x.vmid+'-'+n+' onfocus=VM.MX.f_focus(this) onblur=VM.MX.f_blur(this) maxlength='+(df.length+20)+' value="'+(v||'')+'"'+(rdn?' readonly':'')+(ds?' disabled':'')+' onkeydown=VM.keysubmit("'+x.vmid+'",event)'+(x.tbi?' tabIndex='+x.tbi:'')+(y||((st?' style="'+st+'"':'')+' class="mx_text bd-input z-trg'+(rdn||ds?' rdn':'')+(x.bg?' cstbg':'')+'"'))+' df_fix=1><a class="trg_date bd-input'+(rdn||ds?' z-ds':'')+'" df_trg=1 href=javascript:; onclick="VM.MX.popDatePicker(this,\''+n+'\',\''+df+'\')" hidefocus></a></span>';},popDatePicker:function(a,b,c,x){var d=a.previousSibling,e=d||a;if(!e.readOnly&&!e.disabled){var f=this.bE,g=f&&Fn.Calendar._a[f];if(f&&g&&!g._disposed){Fn.Calendar._a[f].remove();delete this.bE;}else{Ajax.require('js/fn/calendar.js');e.modal=true;var o=VM(a).x('static//i[@n="'+b+'"]')||VM(a).x('static//i[@n1="'+b+'"]');var t={field:d,format:c,poper:a,std:true,type:'input',onchange:o.getAttribute('on_change')};if(x)t=js.clone(t,x);var f=new Fn.Calendar(t).pop();this.bE=f.id;}}},shortcut:function(a,b){var c=VM(a).f(b),r;if(!c.readOnly&&!c.disabled){c.focus();var x=Cfg.shortcut,d={tagName:'dialog',w:Math.max(x.w,c.offsetWidth+(c.nextSibling&&c.nextSibling.getAttribute('df_trg')?18:0)),h:Math.min(x.h,Math.ceil($.canrec().height/2)),t:x.t||Loc.editor.shortcut,src:x.src,magnet:c,magtype:$.snaptype.v,tpl:'none',pophide:1,args:{ipt:c},onclose:function(){c.focus();c.modal=false;if(Br.ie)$.e_remove(c,'keyup click',d.args.lsn);}};c.modal=true;if(Br.ie){d.args.sel=$.r_r($.win(c));d.args.lsn=function(){d.args.sel=$.r_r($.win(c))};$.e_add(c,'keyup click',d.args.lsn);}VM(a).cmd(d);this.f_focus(c);}},aR:function(a,b){var c=event.srcElement;if(c==a)return;var e=$.tags('input',a.previousSibling)[0];if(e&&!e.checked){e.click();if(b)try{VM(a).f(b,DFish.FIRST).focus();if(!c.onclick){while(c!=a&&!c.onclick)c=c.parentNode;}if(c&&c.getAttribute('df_trg'))c.onclick();}catch(e){}}},txr_over:function(a,o){var b=a.firstChild,c=a.id,d=b.scrollHeight,ah=a.offsetHeight;d=ah/d;if(d<1){var h=Math.max(16,Math.floor(ah*d));if($(c+':y')){if(a.jf!=h){$(c+':y').style.height=h+'px';$(c+':ytr').style.height=(h-8)+'px';a.jf=h;o=false;}if(!o){clearTimeout(a.fb);$.opacity($(c+':ytr'),100);}}else{$.append(a,'<div id="'+c+':y" class=s-miniscroll style="height:'+ah+'px;" onselectstart=return(false)><div class=s-track id="'+c+':ytr" onmousedown=VM.MX.txr_scrY(this,"'+c+'") style="margin:3px 0;height:'+(h-8)+'px;"></div></div>');}}},txr_out:function(a,e){var h=a.offsetHeight,b=a.id;if(h!=null&&!(e&&a.contains(e.toElement))){if($(b+':y')){if(a.gx!=='scroll')a.fb=$.fadeOut($(b+':ytr'),false);}}},txr_keyup:function(a){var c=a.parentNode,b=a.scrollTop,d=a.scrollHeight,h=c.offsetHeight,e=h/d,f=h-Math.max(16,Math.floor(h*e)),g=js.m_rng(b,0,d-h);if(e<1&&$(c.id+':y')){$(c.id+':ytr').style.top=t=Math.max(0,Math.min(g*f/(d-h),f))+'px';}VM.MX.txr_over(c);},txr_wheel:function(a,e,w){if((e.wheelDelta>0&&a.scrollTop>0)||(e.wheelDelta<0&&a.scrollTop+a.offsetHeight<a.scrollHeight)){$.e_cancel(e)}},txr_scrY:function(a,b){var c=$(b),h=$(b).offsetHeight,d=c.firstChild.scrollHeight,e=h/d,f=h-Math.max(16,Math.floor(h*e)),t=js.m(a.style.top),g=d-h,y=event.clientY;$.class_add($(b+':y'),'z-hv');$.e_moveup(a,function(){h=Math.max(0,Math.min(t+event.clientY-y,f)),k=Math.max(0,Math.min(Math.ceil(h*g/f),g));a.style.top=h+'px';c.firstChild.scrollTop=k;},function(){if(!$(b).contains(event.srcElement))VM.MX.txr_scrout($(b),event);$.class_del($(b+':y'),'z-hv');});},txr_scrout:function(a,e){var b=a.id,h=a.offsetHeight;if(h!=null&&!(e&&a.contains(e.toElement))){if($(b+':y')){if(a.gx!=='scroll')a.fb=$.fadeOut($(b+':ytr'),false);}}},hr_tgl:function(a){var b=$.pel(a,'TR'),c=b.parentNode.rows,g=$.query('.i-c-g',a)[0],m=$.class_any(g,'i-ul-down');for(var i=b.rowIndex+1,d;i<c.length;i++){d=c[i];if($.class_any(d,'exptr')){if(!d.getAttribute('bL'))d.setAttribute('bL',d.style.display||'block');d.style.display=m?'none':d.getAttribute('bL');}else{if($.query('.mx_hr_tgic',d).length)break;d.style.display=m?'none':'';}}$.class_del(g,m?'i-ul-down':'i-ul-up');$.class_add(g,m?'i-ul-up':'i-ul-down');},fr_dsp:function(x){var a=$(x.frid),b=a.contentWindow.document;$.wr(b,[$.htm.vmltag(),'<body scroll=no style=background:transparent onload=parent.VM.MX.onfrdsp("'+x.frid+'")><div>',x.text,'</div></body></html>'].join(''));VM._a[x.mxid].addEventOnce('remove',function(){$.wr(b);});var divw=x.w-(x.fu?20:10),dbw=b.documentElement.scrollWidth,dbh=b.documentElement.scrollHeight;a.style.width=Math.max(dbw,divw)+'px';a.style.height=(dbh+4+(divw<dbw?Br.scroll:0))+'px';a.parentNode.style.width=divw+'px';},onfrdsp:function(a){setTimeout('VM.MX.eW("'+a+'")',10);},eW:function(a){var frh=$(a).style.posHeight,db=$(a).contentWindow.document.documentElement,bdh=Math.max(22,db.scrollHeight+4),dbw=db.scrollWidth,divw=$(a).parentNode.style.pixelWidth;$(a).style.pixelWidth=Math.max(dbw,divw);$(a).style.pixelHeight=bdh+(divw<dbw?Br.scroll:0);},shtipt:function(a,b){var c=DFish.g_dialog(a).args(),d=a.find(b).trows();if(d){var v=js.map(d,function(r){return r.cells[0].firstChild.firstChild.checked?r.cells[1].innerText:null;},true);DFish.completeInputBox(a,v.join(c.ipt.type==='text'?' ':'\n'));}DFish.g_dialog(a).close();},co:function(o){if(!o||o.style.display=='none'||o.disabled)return false;switch(o.type){case 'radio':case 'checkbox':if(o.checked!=o.defaultChecked)return true;break;case 'select-one':var a=o.options,b=-1;if(!a.length)break;for(var j=0;j<a.length;j++)if(a[j].defaultSelected){b=j;break;}if(o.selectedIndex!=(b<0?0:b))return true;break;case 'select-multiple':var a=o.options;for(var j=0;j<a.length;j++)with(a[j]){if(selected!=defaultSelected)return true;}break;default:if(o.defaultValue!=o.value){return true;}break;}return false;},cT:function(a,b){var c=a.f(b);if(c){if(typeof c.$==='function')c=c.$();else if(c.length&&!c.type){c=c[0];if(c.getAttribute('data-ingroup')==1)c=$.pel(c,'TABLE');}else if(c.type==='hidden')return null;else if(a.x('static//i[@n="'+b+'"]/ancestor::i[contains(@tp,"group")]')){return null;}return $.pel(c,'TR');}},f_html:function(a,b,c,d){return this.prototype.cF.call(a,b,c,d);},gY:function(a,b,c,d,e){var f=$(b);if(!a.ondblclick){a.ondblclick=a.onclick;if(Br.ie_7)a.onmouseup=function(){this.blur()}}if(!Br.ie8)f.focus();if(f.disabled||f.readOnly||!c)return false;var v=parseFloat(f.value);if(isNaN(v))v=js.m(f.defaultValue);v=js.sum([v,c]);var g=parseFloat(d),h=parseFloat(e);if(d&&!isNaN(d)&&v<g)v=g;if(e&&!isNaN(e)&&v>h)v=h;f.value=v;if(!Br.ie)f.fireEvent('input');},f_focus:function(a){$.class_add(a.parentNode,'txwrpfocus');$.class_del(a.parentNode,'txwrpwarn');this.graytoggle(a,false);if(this._f_el&&this._f_el!=a&&this._f_el.parentNode){$.class_del(this._f_el.parentNode,'txwrpfocus');}this._f_el=a;},f_blur:function(a,b){c=a.parentNode;if(b==='spinner')c=c.parentNode;if(!c.contains(document.activeElement))$.class_del(c,'txwrpfocus');this.graytoggle(a,true);},jk:function(a,b,c){return '<span class="f-graytip'+(c?' none':'')+'"'+' id='+a+'-graytip onclick=VM.MX.grayclk(this)>'+b+'</span>'},graytoggle:function(a,b){if(a.getAttribute('data-graytip')&&$(a.id+'-graytip')&&!(a.tagName==='INPUT'||a.tagName==='TEXTAREA'?a.value:a.innerText)){$.class_add($(a.id+'-graytip'),'none',b);}},grayclk:function(a){var c=js.s_to(a.id,'-',true);$(c).focus();},tg_fset:function(a){var b={'true':'minus.gif','false':'plus.gif'},c=a.src.indexOf(b['true'])>0;$.pel(a,'LEGEND').nextSibling.style.display=c?'none':'block';a.src=a.src.replace(b[c],b[!c]);}}});Fn.fW('VM.MX.File',{Const:function(x,xx){this.x=x;this.xx=xx;this.id=VM.MX.File.g_id();VM.MX.File._a[this.id]=this;},Helper:{_a:{},idc:0,g_id:function(){return 'mxfile-'+(this.idc++);},get:function(a,b,c,d){a=VM(a).id;var e;for(var i in this._a){var f=this._a[i];if(f.x.n==b&&f.x.vmid==a){if(f.vis&&!f.$()){f.dispose();}else{e=f;break;}}}if(e&&c){if(c==DFish.GET_VALUE)return e.val();if(c==DFish.SET_VALUE){}else if(c==DFish.DISABLE){e.disable(d);}}return e;},add:function(a){var x=this._a[a].x;if(x.ds)return;var b=VM(x.vmid).fmul(null,Br.fox&&$(a)),c=x.n+'-'+js.uid();$.append(b.firstChild,'<input type=file name='+c+' mxid='+x.mxid+(Br.fox?'> [<a href=javascript: onclick=Fn.VM.MX.File.del(this,"'+a+'","'+c+'")>'+Loc.remove+'</a>]':' onchange=parent.VM.MX.File.cat(this,"'+a+'")>'));if(Br.fox){var d=$(b.name);d.style.width='300px';d.style.height=($.tags('input',b.firstChild).length*22+2)+'px';d.style.position='static';}else b[c].click();},mod:function(a,b){if(!this._a[a].x.ds)VM(this._a[a].x.vmid).fmul(b).click();},cat:function(a,b){var x=this._a[b].x;if(x.ds)return;var c=$(b+'-'+a.name+'-text'),d=js.s_fr(a.value,'\\',true)||a.value;if(c)c.innerText=d;else $.append($(b),'<div style="padding-left:6px;height:17px;line-height:17px;word-break:break-all"><b id='+b+'-'+a.name+'-text onclick=VM.MX.File.mod("'+b+'","'+a.name+'")>'+d+'</b> [<a href=javascript: onclick=VM.MX.File.del(this,"'+b+'","'+a.name+'")>'+Loc.remove+'</a>]</div>');if(x.one==1)$(b+'-add').style.display='none';},del:function(a,b,c){var x=this._a[b].x;if(x.ds)return;var d=VM(x.vmid).fmul();$.rm(d[c]);$.rm(a.parentNode);if(x.one==1)$(b+'-add').style.display='';},dl:function(a,b){DFish.download(js.s_printf(this._a[a].x.downurl,b));}},Prototype:{vis:false,$:function(){return $(this.id);},val:function(){var b=VM(this.x.vmid).fmul(),c=$.query('input[type=file]',b.firstChild),d=[];for(var i=0;i<c.length;i++){d.push(c[i].value);}return d.join();},html:function(){this.vis=true;var a=$.xs(this.xx,'opts/o'),b=!this.x.rdn&&!this.x.ds,c='',f=this.x.n+'-box';if(a.length){for(var i=0,l=a.length;i<l;i++){var d=a[i],e=b&&d.getAttribute('s')!='0',v=d.getAttribute('v');c+='<div style=height:17px;'+(Br._ie6?'overflow:hidden><input style=margin-top:-1px;':'><input ')+' type=checkbox name='+f+(e?' value='+v:'-ds')+' checked defaultDisabled='+(e?'0>':'1 disabled><input type=hidden name='+f+' value='+v+'>')+' <a href="'+js.s_printf(this.x.downurl,d.getAttribute('v'))+'"><u>'+d.text+' '+(d.getAttribute('k')||'')+'</u></a></div>';}c='<div id='+this.id+'-opts style=margin-bottom:'+(Br._ie6?6:3)+'px;>'+c+'</div>';}return '<div id='+this.id+' class=clr-deep>'+c+'</div><div id='+this.id+'-add style=height:19px;line-height:19px;><img src=img/p/ico-file.gif hspace=3>'+'<a id='+this.id+'-lnk href=javascript: onclick=VM.MX.File.add("'+this.id+'")'+(b?'':' style=color:gray')+(Br.fox?' onmouseover=DFish.emu.mx_file.over(this)':'')+'>'+Loc.form.add_file+'</a>'+'</div>';},disable:function(a){this.x.ds=a;$.css(this.id+'-lnk','color',$(this.id).style.color=a?'gray':'');var b=$.query('input[type=checkbox]',$(this.id));for(var i=0;i<b.length;i++)b[i].disabled=a||parseInt(b[i].getAttribute('defaultDisabled'));b=$(this.id).getElementsByTagName('A');for(var i=0;i<b.length;i++)b[i].style.color=a?'gray':'';},dispose:function(){if(this._disposed)return;var a=VM(this.x.vmid).fmul(true);if(a){for(var b=a.firstChild.children,c=this.x.mxid,i=b.length-1;i>=0;i--){if(b[i].mxid==c)b[i].removeNode(true);}}delete VM.MX.File._a[this.id];this.xx=this.x=this.id=null;this._disposed=true;}}});Fn.fW('VM.MX.PluginElement',{Const:function(a,x,w){this.width=w;this.name=x.n;this.title=x.t;this.vmid=x.vmid;this.mxid=x.mxid;this.opts=x;this.id=this.vmid+'-'+x.n;this.layout='plugin'+x.bp;this.parent=a;this.settings=false;},Extend:[VM.PLUGIN],Prototype:{init:function(xx){var n=this.dR(xx),mx=this.mx(),p=this.parent!=mx?this.parent:mx;p.addEventOnce('render',n);mx.addcheck({n:this.name,t:this.title,hdl:js.bind('return this.bV("check")',this)});mx.addEvent('resize',this.bV,this,['resize'],null,this.name);mx.addEvent('beforecheck',this.bV,this,['save'],null,this.name);mx.addEventOnce('remove',this.bV,this,['unload'],null,this.name);mx.addEventOnce('remove',this.dispose,this,null,null,this.name);if(mx.addpl)mx.addpl(this.name,this);return '<span class=txwrp id=mxp-'+this.id+'>'+this.bA+'</span>';},vm:function(){return VM._a[this.vmid];},mx:function(){return VM._a[this.mxid];},form:function(){return this.mx();},wd:function(){return this.width;},win:function(){var d=this.mx().div;return(d&&d.ww)||window;},$:function(a){if(a)return $.query('#'+a,this.$())[0];return this.win().document.getElementById('mxp-'+this.vmid+'-'+this.name);},x:function(a){return a?$.x(this.x(),a):VM._a[this.vmid].x('static//i[@n="'+this.name+'"]');},addcheck:function(){this.mx().addcheck.apply(this.mx(),arguments);},dispose:function(){if(!this._disposed){try{delete VM._a[this.mxid].fy[this.name];}catch(e){}VM.PLUGIN.prototype.dispose.call(this);}}}}); ﻿Fn.fW('VM.SH',{Const:function(a){VM.Base.call(this,a);},Extend:[VM.Base],Helper:{},Prototype:{type:'sh',design:function(a,b,_0,_1,_2,_3){var c=this.x('pub/drag'),d='VM._a["'+this.id+'"].',e='oncontextmenu=return('+d+'context(event)) ',f=this.xt('@scroll'),h=this.xt('pub/face/@v');if(c){var g=c.getAttribute('ic');this.s_drag(c.getAttribute('src'),c.getAttribute('sortSrc'),g);e+='onmousedown='+d+'drag_down(event)'+(g?' onmousemove='+d+'drag.move(event) onmouseout='+d+'drag.out(event)':'')+' ondragstart='+d+'drag.start(event) ';}this.div=a.add(e+_0,_1,_2,_3,f);Fn.Div.addOnRender(this.div,js.bind(function(){for(var i=0;i<this.tree.gp.length;i++)this.tree.gp[i].fireEvent('render');},this));return this.div;},drag_down:function(a){if(this.drag)this.drag.down(a);},s_drag:function(a,b,c){if(!this.drag)this.drag=new Fn.Tree.Drag(c,a,b,this.id,this.frid);},data:function(){this.filter();if(this.tree)this.addEventOnce('remove',this.bQ,this);},filter:function(a){this.div.data(Fn.Tree.html(this,a));this.bB=this.tree.bB;},fL:function(){if(this.vis)return;var a=this.xt('pub/focus');if(a)this.tree.sheetExpand(a);},update:function(a,b,c){var d=this.tree.pks(b);if(d){for(var j=0;j<d.length;j++){this.tree.reborn(d[j],a,c);}}return this;},modify:function(a,b){this.update('modify',a,b);},remove:function(a,b){return this.update('remove',a,b);},add:function(a,b){return this.update('add',a,b);},xadd:function(a,b,c){if(typeof a==='string')a=this.pk(a);if(typeof b==='string')b=$.x_doc(b);return Fn.Tree.xadd(a,b,c);},xmodify:function(a,b){if(typeof a==='string')a=this.pk(a);if(typeof b==='string')b=$.x_doc(b);return Fn.Tree.xmodify(a,b);},reload:function(a,b){return this.update('reload',a,b);},focus:function(a){if(a===false){var b=this.tree.iE();if(b)this.tree.aF(b);}else this.tree.sheetExpand(typeof a==='object'?a.pk:a);},click:function(a){this.focus(a);var b=this.tree.pk(a);if(b){Fn.Tree.clk(b);Fn.Tree.cz(b,'click');}},boxClick:function(a,b){if(typeof a==='object'){Fn.Tree.bxclk(a.id+'-bx',b);}else if(a=this.pks(a)){for(var i=0;i<a.length;i++)Fn.Tree.bxclk(a[i].id+'-bx',b);}},ec:function(a){},get:function(a,b){if(b)return this.get(a).attr(b);return this.pk(a);},getSelected:function(a){return this.tree.iE(a);},pk:function(a){return(a?(typeof a=='object'?Fn.Tree.get(a):this.tree.pk(a)):this.tree.sel)||false;},pks:function(a){return this.tree.pks(a);},roots:function(a){return a==null?this.tree.gp:this.tree.gp[a];},attr:function(a,b,c){var d;if(c!=null){if(d=this.tree.pks(a)){for(var i=0;i<d.length;i++)d[i].attr(b,c);}}else{if(d=this.tree.pk(a)){return d.attr(b);}}},defaultAttr:function(a,b){},scrollTop:function(a,b){return this.div.scrollTop(a,b)},scrollLeft:function(a,b){return this.div.scrollLeft(a,b)},insertBefore:function(a,b,c){var d=this.tree.pk(a),e=this.tree.pks(b);if(d&&e){var i=e.length-1;if((d instanceof Fn.TreeLoadItem||d instanceof Fn.TreeLoad)&&!(d.loaded||d.loading)){for(;i>-1;i--)e[i].remove();}else{try{for(;i>-1;i--)d.add(e[i],c);}catch(ex){}}}},toggle:function(a,b,c){var a=this.pk(a);if(a)a.toggle(b,c==null?true:c);},toggleAll:function(a,b,c){var a=this.tree.pk(a);if(a)a.toggleAll(b,c==null?true:c);},open:function(a,b,c){this.ajax(a,function(x){if(x!==false){x=x.tagName==='fr'?$.x(x,'tree'):x.tagName==='view'?$.x(x,'static//tree'):x;if(c)this.tree.gH(this.pk(c),x);else this.tree.sheetCompare(this.tree.gp,x);this.tree.gI(x);}if(typeof b==='function')b();},null,b===true);},context:function(a){var b=Fn.Tree.get(a.srcElement);if(b&&b.id!=a.srcElement.id){var c=b.attr('menu');if(c){a.returnValue=false;Fn.Event.setev(a.clientX,a.clientY);Function(js.s_printx(c,b.xml,true)).call(b);return false;}}return true;},bQ:function(){if(this.drag){if(this.drag.cI)this.drag.closed=1;else this.drag.remove();}if(this.tree)this.tree.dispose();},show:function(){$.toggle(this.div.parentNode.$(),true)},hide:function(){$.toggle(this.div.parentNode.$(),false)},reset:function(){VM.Base.prototype.reset.call(this);if(this.tree){this.tree.dispose();this.tree=null;delete this.tree;}this.div=null;delete this.div;if(this.N){this.N.removeNode(true);this.N=null;delete this.N;}}}});